(function(a){if(typeof define==="function"&&define.amd){define(["JSRootCore","d3"],a)}else{if(typeof exports==="object"&&typeof module!=="undefined"){var b=require("./JSRootCore.js");a(b,require("./d3.min.js"));if(b.nodejs){b.Painter.readStyleFromURL("?interactive=0&tooltip=0&nomenu&noprogress&notouch&toolbar=0&webgl=0")}}else{if(typeof JSROOT=="undefined"){throw new Error("JSROOT is not defined","JSRootPainter.js")}if(typeof d3!="object"){throw new Error("d3 is not defined","JSRootPainter.js")}if(typeof JSROOT.Painter=="object"){throw new Error("JSROOT.Painter already defined","JSRootPainter.js")}a(JSROOT,d3)}}}(function(b,o){b.sources.push("2d");if(typeof define==="function"&&define.amd){b.loadScript("$$$style/JSRootPainter.css")}b.DrawFuncs={lst:[],cache:{}};b.addDrawFunc=function(p,q,r){if((arguments.length==1)&&(typeof arguments[0]=="object")){b.DrawFuncs.lst.push(arguments[0]);return arguments[0]}var s={name:p,func:q,opt:r};b.DrawFuncs.lst.push(s);return s};b.ToolbarIcons={camera:{path:"M 152.00,304.00c0.00,57.438, 46.562,104.00, 104.00,104.00s 104.00-46.562, 104.00-104.00s-46.562-104.00-104.00-104.00S 152.00,246.562, 152.00,304.00z M 480.00,128.00L 368.00,128.00 c-8.00-32.00-16.00-64.00-48.00-64.00L 192.00,64.00 c-32.00,0.00-40.00,32.00-48.00,64.00L 32.00,128.00 c-17.60,0.00-32.00,14.40-32.00,32.00l0.00,288.00 c0.00,17.60, 14.40,32.00, 32.00,32.00l 448.00,0.00 c 17.60,0.00, 32.00-14.40, 32.00-32.00L 512.00,160.00 C 512.00,142.40, 497.60,128.00, 480.00,128.00z M 256.00,446.00c-78.425,0.00-142.00-63.574-142.00-142.00c0.00-78.425, 63.575-142.00, 142.00-142.00c 78.426,0.00, 142.00,63.575, 142.00,142.00 C 398.00,382.426, 334.427,446.00, 256.00,446.00z M 480.00,224.00l-64.00,0.00 l0.00-32.00 l 64.00,0.00 L 480.00,224.00 z"},disk:{path:"M384,0H128H32C14.336,0,0,14.336,0,32v448c0,17.656,14.336,32,32,32h448c17.656,0,32-14.344,32-32V96L416,0H384z M352,160   V32h32v128c0,17.664-14.344,32-32,32H160c-17.664,0-32-14.336-32-32V32h128v128H352z M96,288c0-17.656,14.336-32,32-32h256   c17.656,0,32,14.344,32,32v192H96V288z"},question:{path:"M256,512c141.375,0,256-114.625,256-256S397.375,0,256,0S0,114.625,0,256S114.625,512,256,512z M256,64   c63.719,0,128,36.484,128,118.016c0,47.453-23.531,84.516-69.891,110.016C300.672,299.422,288,314.047,288,320   c0,17.656-14.344,32-32,32c-17.664,0-32-14.344-32-32c0-40.609,37.25-71.938,59.266-84.031   C315.625,218.109,320,198.656,320,182.016C320,135.008,279.906,128,256,128c-30.812,0-64,20.227-64,64.672   c0,17.664-14.336,32-32,32s-32-14.336-32-32C128,109.086,193.953,64,256,64z M256,449.406c-18.211,0-32.961-14.75-32.961-32.969   c0-18.188,14.75-32.953,32.961-32.953c18.219,0,32.969,14.766,32.969,32.953C288.969,434.656,274.219,449.406,256,449.406z"},undo:{path:"M450.159,48.042c8.791,9.032,16.983,18.898,24.59,29.604c7.594,10.706,14.146,22.207,19.668,34.489  c5.509,12.296,9.82,25.269,12.92,38.938c3.113,13.669,4.663,27.834,4.663,42.499c0,14.256-1.511,28.863-4.532,43.822  c-3.009,14.952-7.997,30.217-14.953,45.795c-6.955,15.577-16.202,31.52-27.755,47.826s-25.88,32.9-42.942,49.807  c-5.51,5.444-11.787,11.67-18.834,18.651c-7.033,6.98-14.496,14.366-22.39,22.168c-7.88,7.802-15.955,15.825-24.187,24.069  c-8.258,8.231-16.333,16.203-24.252,23.888c-18.3,18.13-37.354,37.016-57.191,56.65l-56.84-57.445  c19.596-19.472,38.54-38.279,56.84-56.41c7.75-7.685,15.772-15.604,24.108-23.757s16.438-16.163,24.33-24.057  c7.894-7.893,15.356-15.33,22.402-22.312c7.034-6.98,13.312-13.193,18.821-18.651c22.351-22.402,39.165-44.648,50.471-66.738  c11.279-22.09,16.932-43.567,16.932-64.446c0-15.785-3.217-31.005-9.638-45.671c-6.422-14.665-16.229-28.504-29.437-41.529  c-3.282-3.282-7.358-6.395-12.217-9.325c-4.871-2.938-10.381-5.503-16.516-7.697c-6.121-2.201-12.815-3.992-20.058-5.373  c-7.242-1.374-14.9-2.064-23.002-2.064c-8.218,0-16.802,0.834-25.788,2.507c-8.961,1.674-18.053,4.429-27.222,8.271  c-9.189,3.842-18.456,8.869-27.808,15.089c-9.358,6.219-18.521,13.819-27.502,22.793l-59.92,60.271l93.797,94.058H0V40.91  l93.27,91.597l60.181-60.532c13.376-15.018,27.222-27.248,41.536-36.697c14.308-9.443,28.608-16.776,42.89-21.992  c14.288-5.223,28.505-8.74,42.623-10.557C294.645,0.905,308.189,0,321.162,0c13.429,0,26.389,1.185,38.84,3.562  c12.478,2.377,24.2,5.718,35.192,10.029c11.006,4.311,21.126,9.404,30.374,15.265C434.79,34.724,442.995,41.119,450.159,48.042z"},arrow_right:{path:"M30.796,226.318h377.533L294.938,339.682c-11.899,11.906-11.899,31.184,0,43.084c11.887,11.899,31.19,11.893,43.077,0  l165.393-165.386c5.725-5.712,8.924-13.453,8.924-21.539c0-8.092-3.213-15.84-8.924-21.551L338.016,8.925  C332.065,2.975,324.278,0,316.478,0c-7.802,0-15.603,2.968-21.539,8.918c-11.899,11.906-11.899,31.184,0,43.084l113.391,113.384  H30.796c-16.822,0-30.463,13.645-30.463,30.463C0.333,212.674,13.974,226.318,30.796,226.318z"},arrow_up:{path:"M295.505,629.446V135.957l148.193,148.206c15.555,15.559,40.753,15.559,56.308,0c15.555-15.538,15.546-40.767,0-56.304  L283.83,11.662C276.372,4.204,266.236,0,255.68,0c-10.568,0-20.705,4.204-28.172,11.662L11.333,227.859  c-7.777,7.777-11.666,17.965-11.666,28.158c0,10.192,3.88,20.385,11.657,28.158c15.563,15.555,40.762,15.555,56.317,0  l148.201-148.219v493.489c0,21.993,17.837,39.82,39.82,39.82C277.669,669.267,295.505,651.439,295.505,629.446z"},arrow_diag:{path:"M279.875,511.994c-1.292,0-2.607-0.102-3.924-0.312c-10.944-1.771-19.333-10.676-20.457-21.71L233.97,278.348  L22.345,256.823c-11.029-1.119-19.928-9.51-21.698-20.461c-1.776-10.944,4.031-21.716,14.145-26.262L477.792,2.149  c9.282-4.163,20.167-2.165,27.355,5.024c7.201,7.189,9.199,18.086,5.024,27.356L302.22,497.527  C298.224,506.426,289.397,511.994,279.875,511.994z M118.277,217.332l140.534,14.294c11.567,1.178,20.718,10.335,21.878,21.896  l14.294,140.519l144.09-320.792L118.277,217.332z"},auto_zoom:{path:"M505.441,242.47l-78.303-78.291c-9.18-9.177-24.048-9.171-33.216,0c-9.169,9.172-9.169,24.045,0.006,33.217l38.193,38.188  H280.088V80.194l38.188,38.199c4.587,4.584,10.596,6.881,16.605,6.881c6.003,0,12.018-2.297,16.605-6.875  c9.174-9.172,9.174-24.039,0.011-33.217L273.219,6.881C268.803,2.471,262.834,0,256.596,0c-6.229,0-12.202,2.471-16.605,6.881  l-78.296,78.302c-9.178,9.172-9.178,24.045,0,33.217c9.177,9.171,24.051,9.171,33.21,0l38.205-38.205v155.4H80.521l38.2-38.188  c9.177-9.171,9.177-24.039,0.005-33.216c-9.171-9.172-24.039-9.178-33.216,0L7.208,242.464c-4.404,4.403-6.881,10.381-6.881,16.611  c0,6.227,2.477,12.207,6.881,16.61l78.302,78.291c4.587,4.581,10.599,6.875,16.605,6.875c6.006,0,12.023-2.294,16.61-6.881  c9.172-9.174,9.172-24.036-0.005-33.211l-38.205-38.199h152.593v152.063l-38.199-38.211c-9.171-9.18-24.039-9.18-33.216-0.022  c-9.178,9.18-9.178,24.059-0.006,33.222l78.284,78.302c4.41,4.404,10.382,6.881,16.611,6.881c6.233,0,12.208-2.477,16.611-6.881  l78.302-78.296c9.181-9.18,9.181-24.048,0-33.205c-9.174-9.174-24.054-9.174-33.21,0l-38.199,38.188v-152.04h152.051l-38.205,38.199  c-9.18,9.175-9.18,24.037-0.005,33.211c4.587,4.587,10.596,6.881,16.604,6.881c6.01,0,12.024-2.294,16.605-6.875l78.303-78.285  c4.403-4.403,6.887-10.378,6.887-16.611C512.328,252.851,509.845,246.873,505.441,242.47z"},statbox:{path:"M28.782,56.902H483.88c15.707,0,28.451-12.74,28.451-28.451C512.331,12.741,499.599,0,483.885,0H28.782   C13.074,0,0.331,12.741,0.331,28.451C0.331,44.162,13.074,56.902,28.782,56.902zM483.885,136.845H28.782c-15.708,0-28.451,12.741-28.451,28.451c0,15.711,12.744,28.451,28.451,28.451H483.88   c15.707,0,28.451-12.74,28.451-28.451C512.331,149.586,499.599,136.845,483.885,136.845zM483.885,273.275H28.782c-15.708,0-28.451,12.731-28.451,28.452c0,15.707,12.744,28.451,28.451,28.451H483.88   c15.707,0,28.451-12.744,28.451-28.451C512.337,286.007,499.599,273.275,483.885,273.275zM256.065,409.704H30.492c-15.708,0-28.451,12.731-28.451,28.451c0,15.707,12.744,28.451,28.451,28.451h225.585   c15.707,0,28.451-12.744,28.451-28.451C284.516,422.436,271.785,409.704,256.065,409.704z"},circle:{path:"M256,256 m-150,0 a150,150 0 1,0 300,0 a150,150 0 1,0 -300,0"},three_circles:{path:"M256,85 m-70,0 a70,70 0 1,0 140,0 a70,70 0 1,0 -140,0  M256,255 m-70,0 a70,70 0 1,0 140,0 a70,70 0 1,0 -140,0  M256,425 m-70,0 a70,70 0 1,0 140,0 a70,70 0 1,0 -140,0 "},diamand:{path:"M256,0L384,256L256,511L128,256z"},rect:{path:"M80,80h352v352h-352z"},CreateSVG:function(s,r,q,u){var p=s.append("svg:svg").attr("class","svg_toolbar_btn").attr("width",q+"px").attr("height",q+"px").attr("viewBox","0 0 512 512").style("overflow","hidden");if("recs" in r){var t={};for(var v=0;v<r.recs.length;++v){b.extend(t,r.recs[v]);p.append("rect").attr("x",t.x).attr("y",t.y).attr("width",t.w).attr("height",t.h).attr("fill",t.f)}}else{p.append("svg:path").attr("d",r.path)}p.append("svg:rect").attr("x",0).attr("y",0).attr("width",512).attr("height",512).style("opacity",0).style("fill","none").style("pointer-events","visibleFill").append("svg:title").text(u);return p}};var a=function(p){this.opt=p&&(typeof p=="string")?p.toUpperCase().trim():"";this.part=""};a.prototype.empty=function(){return this.opt.length===0};a.prototype.remain=function(){return this.opt};a.prototype.check=function(q,p){var s=this.opt.indexOf(q);if(s<0){return false}this.opt=this.opt.substr(0,s)+this.opt.substr(s+q.length);this.part="";if(!p){return true}var r=s;while((r<this.opt.length)&&(this.opt[r]!==" ")&&(this.opt[r]!==",")&&(this.opt[r]!==";")){r++}if(r>s){this.part=this.opt.substr(s,r-s);this.opt=this.opt.substr(0,s)+this.opt.substr(r)}return true};a.prototype.partAsInt=function(r,p){var q=this.part.replace(/^\D+/g,"");q=q?parseInt(q,10):Number.NaN;return isNaN(q)?(p||0):q+(r||0)};var f={Coord:{kCARTESIAN:1,kPOLAR:2,kCYLINDRICAL:3,kSPHERICAL:4,kRAPIDITY:5},root_colors:[],root_line_styles:["","","3,3","1,2","3,4,1,4","5,3,1,3","5,3,1,3,1,3,1,3","5,5","5,3,1,3,1,3","20,5","20,10,1,10","1,3"],root_markers:[0,100,8,7,0,9,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,103,105,104,0,3,4,2,1,106,6,7,5,102,101],root_fonts:["Arial","Times New Roman","bTimes New Roman","biTimes New Roman","Arial","oArial","bArial","boArial","Courier New","oCourier New","bCourier New","boCourier New","Symbol","Times New Roman","Wingdings","Symbol","Verdana"],root_fonts_aver_width:[0.537,0.514,0.535,0.52,0.537,0.54,0.556,0.56,0.6,0.6,0.6,0.6,0.587,0.514,0.896,0.587,0.55],symbols_map:{"#alpha":"\u03B1","#beta":"\u03B2","#chi":"\u03C7","#delta":"\u03B4","#varepsilon":"\u03B5","#phi":"\u03C6","#gamma":"\u03B3","#eta":"\u03B7","#iota":"\u03B9","#varphi":"\u03C6","#kappa":"\u03BA","#lambda":"\u03BB","#mu":"\u03BC","#nu":"\u03BD","#omicron":"\u03BF","#pi":"\u03C0","#theta":"\u03B8","#rho":"\u03C1","#sigma":"\u03C3","#tau":"\u03C4","#upsilon":"\u03C5","#varomega":"\u03D6","#omega":"\u03C9","#xi":"\u03BE","#psi":"\u03C8","#zeta":"\u03B6","#Alpha":"\u0391","#Beta":"\u0392","#Chi":"\u03A7","#Delta":"\u0394","#Epsilon":"\u0395","#Phi":"\u03A6","#Gamma":"\u0393","#Eta":"\u0397","#Iota":"\u0399","#vartheta":"\u03D1","#Kappa":"\u039A","#Lambda":"\u039B","#Mu":"\u039C","#Nu":"\u039D","#Omicron":"\u039F","#Pi":"\u03A0","#Theta":"\u0398","#Rho":"\u03A1","#Sigma":"\u03A3","#Tau":"\u03A4","#Upsilon":"\u03A5","#varsigma":"\u03C2","#Omega":"\u03A9","#Xi":"\u039E","#Psi":"\u03A8","#Zeta":"\u0396","#varUpsilon":"\u03D2","#epsilon":"\u03B5","#sqrt":"\u221A","#bar":"","#leq":"\u2264","#/":"\u2044","#infty":"\u221E","#voidb":"\u0192","#club":"\u2663","#diamond":"\u2666","#heart":"\u2665","#spade":"\u2660","#leftrightarrow":"\u2194","#leftarrow":"\u2190","#uparrow":"\u2191","#rightarrow":"\u2192","#downarrow":"\u2193","#circ":"\u02C6","#pm":"\xB1","#doublequote":"\u2033","#geq":"\u2265","#times":"\xD7","#propto":"\u221D","#partial":"\u2202","#bullet":"\u2022","#divide":"\xF7","#neq":"\u2260","#equiv":"\u2261","#approx":"\u2248","#3dots":"\u2026","#cbar":"\u007C","#topbar":"\xAF","#downleftarrow":"\u21B5","#aleph":"\u2135","#Jgothic":"\u2111","#Rgothic":"\u211C","#voidn":"\u2118","#otimes":"\u2297","#oplus":"\u2295","#oslash":"\u2205","#cap":"\u2229","#cup":"\u222A","#supseteq":"\u2287","#supset":"\u2283","#notsubset":"\u2284","#subseteq":"\u2286","#subset":"\u2282","#int":"\u222B","#in":"\u2208","#notin":"\u2209","#angle":"\u2220","#nabla":"\u2207","#oright":"\xAE","#ocopyright":"\xA9","#trademark":"\u2122","#prod":"\u220F","#surd":"\u221A","#upoint":"\u22C5","#corner":"\xAC","#wedge":"\u2227","#vee":"\u2228","#Leftrightarrow":"\u21D4","#Leftarrow":"\u21D0","#Uparrow":"\u21D1","#Rightarrow":"\u21D2","#Downarrow":"\u21D3","#LT":"\x3C","#void1":"\xAE","#copyright":"\xA9","#void3":"\u2122","#sum":"\u2211","#arctop":"","#lbar":"","#arcbottom":"","#void8":"","#bottombar":"\u230A","#arcbar":"","#ltbar":"","#AA":"\u212B","#aa":"\u00E5","#void06":"","#GT":"\x3E","#forall":"\u2200","#exists":"\u2203","#vec":"","#dot":"\u22C5","#hat":"\xB7","#ddot":"","#acute":"acute","#grave":"","#check":"\u2713","#tilde":"\u02DC","#slash":"\u2044","#hbar":"\u0127","#box":"","#Box":"","#parallel":"","#perp":"\u22A5","#odot":"","#left":"","#right":""},math_symbols_map:{"#LT":"\\langle","#GT":"\\rangle","#club":"\\clubsuit","#spade":"\\spadesuit","#heart":"\\heartsuit","#diamond":"\\diamondsuit","#voidn":"\\wp","#voidb":"f","#copyright":"(c)","#ocopyright":"(c)","#trademark":"TM","#void3":"TM","#oright":"R","#void1":"R","#3dots":"\\ldots","#lbar":"\\mid","#void8":"\\mid","#divide":"\\div","#Jgothic":"\\Im","#Rgothic":"\\Re","#doublequote":'"',"#plus":"+","#minus":"-","#/":"/","#upoint":".","#aa":"\\mathring{a}","#AA":"\\mathring{A}","#omicron":"o","#Alpha":"A","#Beta":"B","#Epsilon":"E","#Zeta":"Z","#Eta":"H","#Iota":"I","#Kappa":"K","#Mu":"M","#Nu":"N","#Omicron":"O","#Rho":"P","#Tau":"T","#Chi":"X","#varomega":"\\varpi","#corner":"?","#ltbar":"?","#bottombar":"?","#notsubset":"?","#arcbottom":"?","#cbar":"?","#arctop":"?","#topbar":"?","#arcbar":"?","#downleftarrow":"?","#splitline":"\\genfrac{}{}{0pt}{}","#it":"\\textit","#bf":"\\textbf","#frac":"\\frac","#left{":"\\lbrace","#right}":"\\rbrace","#left\\[":"\\lbrack","#right\\]":"\\rbrack","#\\[\\]{":"\\lbrack"," } ":"\\rbrack","#\\[":"\\lbrack","#\\]":"\\rbrack","#{":"\\lbrace","#}":"\\rbrace"," ":"\\;"}};b.Painter=f;f.createMenu=function(p,q){document.body.style.cursor="wait";b.AssertPrerequisites("hierarchy;jq2d;",function(){document.body.style.cursor="auto";f.createMenu(p,q)})};f.closeMenu=function(q){var p=document.getElementById(q||"root_ctx_menu");if(p){p.parentNode.removeChild(p);return true}return false};f.readStyleFromURL=function(r){var y=b.GetUrlOption("optimize",r);if(y==""){b.gStyle.OptimizeDraw=2}else{if(y!==null){b.gStyle.OptimizeDraw=parseInt(y);if(isNaN(b.gStyle.OptimizeDraw)){b.gStyle.OptimizeDraw=2}}}var u=b.GetUrlOption("interactive",r);if((u=="")||(u=="1")){u="11111"}else{if(u=="0"){u="00000"}}if((u!==null)&&(u.length==5)){b.gStyle.Tooltip=parseInt(u[0]);b.gStyle.ContextMenu=(u[1]!="0");b.gStyle.Zooming=(u[2]!="0");b.gStyle.MoveResize=(u[3]!="0");b.gStyle.DragAndDrop=(u[4]!="0")}var x=b.GetUrlOption("tooltip",r);if(x!==null){b.gStyle.Tooltip=parseInt(x)}var A=b.GetUrlOption("mathjax",r),s=b.GetUrlOption("latex",r);if((A!==null)&&(A!="0")&&(s===null)){s="math"}if(s!==null){b.gStyle.Latex=s}if(b.GetUrlOption("nomenu",r)!=null){b.gStyle.ContextMenu=false}if(b.GetUrlOption("noprogress",r)!=null){b.gStyle.ProgressBox=false}if(b.GetUrlOption("notouch",r)!=null){b.touches=false}b.gStyle.fOptStat=b.GetUrlOption("optstat",r,b.gStyle.fOptStat);b.gStyle.fOptFit=b.GetUrlOption("optfit",r,b.gStyle.fOptFit);b.gStyle.fStatFormat=b.GetUrlOption("statfmt",r,b.gStyle.fStatFormat);b.gStyle.fFitFormat=b.GetUrlOption("fitfmt",r,b.gStyle.fFitFormat);var z=b.GetUrlOption("toolbar",r);if(z!==null){if(z==="popup"){b.gStyle.ToolBar="popup"}else{b.gStyle.ToolBar=(z!=="0")&&(z!=="false")}}var t=b.GetUrlOption("palette",r);if(t!==null){t=parseInt(t);if(!isNaN(t)&&(t>0)&&(t<113)){b.gStyle.Palette=t}}var q=b.GetUrlOption("embed3d",r);if(q!==null){b.gStyle.Embed3DinSVG=parseInt(q)}var p=b.GetUrlOption("webgl",r);if((p==="0")||(p==="false")){b.gStyle.NoWebGL=true}else{if(p==="ie"){b.gStyle.NoWebGL=!b.browser.isIE}}var v=b.GetUrlOption("geosegm",r);if(v!==null){b.gStyle.GeoGradPerSegm=Math.max(2,parseInt(v))}var w=b.GetUrlOption("geocomp",r);if(w!==null){b.gStyle.GeoCompressComp=(w!=="0")&&(w!=="false")}};f.createRootColors=function(){var q=["white","black","red","green","blue","yellow","magenta","cyan","rgb(89,212,84)","rgb(89,84,217)","white"];q[110]="white";var t=[{col:11,str:"c1b7ad4d4d4d6666668080809a9a9ab3b3b3cdcdcde6e6e6f3f3f3cdc8accdc8acc3c0a9bbb6a4b3a697b8a49cae9a8d9c8f83886657b1cfc885c3a48aa9a1839f8daebdc87b8f9a768a926983976e7b857d9ad280809caca6c0d4cf88dfbb88bd9f83c89a7dc08378cf5f61ac8f94a6787b946971d45a549300ff7b00ff6300ff4b00ff3300ff1b00ff0300ff0014ff002cff0044ff005cff0074ff008cff00a4ff00bcff00d4ff00ecff00fffd00ffe500ffcd00ffb500ff9d00ff8500ff6d00ff5500ff3d00ff2600ff0e0aff0022ff003aff0052ff006aff0082ff009aff00b1ff00c9ff00e1ff00f9ff00ffef00ffd700ffbf00ffa700ff8f00ff7700ff6000ff4800ff3000ff1800ff0000"},{col:201,str:"5c5c5c7b7b7bb8b8b8d7d7d78a0f0fb81414ec4848f176760f8a0f14b81448ec4876f1760f0f8a1414b84848ec7676f18a8a0fb8b814ecec48f1f1768a0f8ab814b8ec48ecf176f10f8a8a14b8b848ecec76f1f1"},{col:390,str:"ffffcdffff9acdcd9affff66cdcd669a9a66ffff33cdcd339a9a33666633ffff00cdcd009a9a00666600333300"},{col:406,str:"cdffcd9aff9a9acd9a66ff6666cd66669a6633ff3333cd33339a3333663300ff0000cd00009a00006600003300"},{col:422,str:"cdffff9affff9acdcd66ffff66cdcd669a9a33ffff33cdcd339a9a33666600ffff00cdcd009a9a006666003333"},{col:590,str:"cdcdff9a9aff9a9acd6666ff6666cd66669a3333ff3333cd33339a3333660000ff0000cd00009a000066000033"},{col:606,str:"ffcdffff9affcd9acdff66ffcd66cd9a669aff33ffcd33cd9a339a663366ff00ffcd00cd9a009a660066330033"},{col:622,str:"ffcdcdff9a9acd9a9aff6666cd66669a6666ff3333cd33339a3333663333ff0000cd00009a0000660000330000"},{col:791,str:"ffcd9acd9a669a66339a6600cd9a33ffcd66ff9a00ffcd33cd9a00ffcd00ff9a33cd66006633009a3300cd6633ff9a66ff6600ff6633cd3300ff33009aff3366cd00336600339a0066cd339aff6666ff0066ff3333cd0033ff00cdff9a9acd66669a33669a009acd33cdff669aff00cdff339acd00cdff009affcd66cd9a339a66009a6633cd9a66ffcd00ff6633ffcd00cd9a00ffcd33ff9a00cd66006633009a3333cd6666ff9a00ff9a33ff6600cd3300ff339acdff669acd33669a00339a3366cd669aff0066ff3366ff0033cd0033ff339aff0066cd00336600669a339acd66cdff009aff33cdff009acd00cdffcd9aff9a66cd66339a66009a9a33cdcd66ff9a00ffcd33ff9a00cdcd00ff9a33ff6600cd33006633009a6633cd9a66ff6600ff6633ff3300cd3300ffff339acd00666600339a0033cd3366ff669aff0066ff3366cd0033ff0033ff9acdcd669a9a33669a0066cd339aff66cdff009acd009aff33cdff009a"},{col:920,str:"cdcdcd9a9a9a666666333333"}];for(var s=0;s<t.length;++s){var r=t[s];for(var u=0;u<r.str.length;u+=6){var p=parseInt(r.col)+parseInt(u/6);q[p]="rgb("+parseInt("0x"+r.str.slice(u,u+2))+","+parseInt("0x"+r.str.slice(u+2,u+4))+","+parseInt("0x"+r.str.slice(u+4,u+6))+")"}}f.root_colors=q};f.MakeColorRGB=function(q){if((q==null)||(q._typename!="TColor")){return null}var p=Math.round(q.fRed*255)+","+Math.round(q.fGreen*255)+","+Math.round(q.fBlue*255);if((q.fAlpha===undefined)||(q.fAlpha==1)){p="rgb("+p+")"}else{p="rgba("+p+","+q.fAlpha.toFixed(3)+")"}switch(p){case"rgb(255,255,255)":p="white";break;case"rgb(0,0,0)":p="black";break;case"rgb(255,0,0)":p="red";break;case"rgb(0,255,0)":p="green";break;case"rgb(0,0,255)":p="blue";break;case"rgb(255,255,0)":p="yellow";break;case"rgb(255,0,255)":p="magenta";break;case"rgb(0,255,255)":p="cyan";break}return p};f.extendRootColors=function(s,t){if(!t||!t.arr){return}for(var u=0;u<t.arr.length;++u){var r=t.arr[u];if(!r||(r._typename!="TColor")){continue}var q=r.fNumber;if((q<0)||(q>10000)){continue}var p=f.MakeColorRGB(r);if(p&&(s[q]!=p)){s[q]=p}}};f.adoptRootColors=function(p){f.extendRootColors(f.root_colors,p)};function n(p){this.palette=p}n.prototype.calcColorIndex=function(q,p){var r=Math.floor((q+0.99)*this.palette.length/(p-1));if(r>this.palette.length-1){r=this.palette.length-1}return r};n.prototype.getColor=function(p){return this.palette[p]};n.prototype.getLength=function(){return this.palette.length};n.prototype.calcColor=function(q,p){var r=this.calcColorIndex(q,p);return this.getColor(r)};function g(r,p){var q=f.root_colors[r.fMarkerColor];if(!p||(p<0)){p=r.fMarkerStyle}this.x0=this.y0=0;this.color=q;this.style=p;this.size=8;this.scale=1;this.stroke=true;this.fill=true;this.marker="";this.ndig=0;this.used=true;this.changed=false;this.func=this.Apply.bind(this);this.Change(q,p,r.fMarkerSize);this.changed=false}g.prototype.reset_pos=function(){this.lastx=this.lasty=null};g.prototype.create=function(p,q){return"M"+(p+this.x0).toFixed(this.ndig)+","+(q+this.y0).toFixed(this.ndig)+this.marker};g.prototype.GetFullSize=function(){return this.scale*this.size};g.prototype.Change=function(q,t,s){this.changed=true;if(q!==undefined){this.color=q}if((t!==undefined)&&(t>=0)){this.style=t}if(s!==undefined){this.size=s}else{s=this.size}this.x0=this.y0=0;if((this.style===1)||(this.style===777)){this.fill=false;this.marker="h1";this.size=1;this.create=function(z,E){var C=Math.round(z),D=Math.round(E),B="M"+C+","+D+"h1";var A=(this.lastx===null)?B:("m"+(C-this.lastx)+","+(D-this.lasty)+"h1");this.lastx=C+1;this.lasty=D;return(A.length<B.length)?A:B};this.reset_pos();return true}var u=f.root_markers[this.style]||100,p=u%100;this.fill=(u>=100);switch(this.style){case 1:this.size=1;this.scale=1;break;case 6:this.size=2;this.scale=1;break;case 7:this.size=3;this.scale=1;break;default:this.size=s;this.scale=8}s=this.GetFullSize();this.ndig=(s>7)?0:((s>2)?1:2);if(p==6){this.ndig++}var v=(s/2).toFixed(this.ndig),r=s.toFixed(this.ndig);switch(p){case 0:this.x0=-s/2;this.marker="a"+v+","+v+",0,1,0,"+r+",0a"+v+","+v+",0,1,0,-"+r+",0z";break;case 1:var w=(s/3).toFixed(this.ndig);this.x0=this.y0=s/6;this.marker="h"+w+"v-"+w+"h-"+w+"v-"+w+"h-"+w+"v"+w+"h-"+w+"v"+w+"h"+w+"v"+w+"h"+w+"z";break;case 2:this.x0=-s/2;this.marker="l"+v+",-"+v+"l"+v+","+v+"l-"+v+","+v+"z";break;case 3:this.x0=this.y0=-s/2;this.marker="v"+r+"h"+r+"v-"+r+"z";break;case 4:this.y0=s/2;this.marker="l-"+v+",-"+r+"h"+r+"z";break;case 5:this.y0=-s/2;this.marker="l-"+v+","+r+"h"+r+"z";break;case 6:this.y0=-s/2;this.marker="l"+(s/3).toFixed(this.ndig)+","+r+"l-"+(5/6*s).toFixed(this.ndig)+",-"+(5/8*s).toFixed(this.ndig)+"h"+r+"l-"+(5/6*s).toFixed(this.ndig)+","+(5/8*s).toFixed(this.ndig)+"z";break;case 7:this.x0=this.y0=-s/2;this.marker="l"+r+","+r+"m0,-"+r+"l-"+r+","+r+"m0,-"+v+"h"+r+"m-"+v+",-"+v+"v"+r;break;case 8:this.y0=-s/2;this.marker="v"+r+"m-"+v+",-"+v+"h"+r;break;case 9:this.x0=this.y0=-s/2;this.marker="l"+r+","+r+"m0,-"+r+"l-"+r+","+r;break;default:this.x0=-s/2;this.marker="l"+v+",-"+v+"l"+v+","+v+"l-"+v+","+v+"z";break}return true};g.prototype.Apply=function(p){p.style("stroke",this.stroke?this.color:"none");p.style("fill",this.fill?this.color:"none")};function c(v,s,r,u){var q="black",p=0,t=0;if(typeof v=="string"){q=v;if(q!=="none"){p=1}}else{if(typeof v=="object"){if("fLineColor" in v){q=u||f.root_colors[v.fLineColor]}if("fLineWidth" in v){p=v.fLineWidth}if("fLineStyle" in v){t=v.fLineStyle}}else{if((v!==undefined)&&!isNaN(v)){q=f.root_colors[v];if(q){p=1;t=1}}}}if(s!==undefined){p=s}this.used=true;this.color=(p==0)?"none":q;this.width=p;this.style=t;if(r){this.excl_side=this.excl_width=0;if(Math.abs(this.width)>99){this.excl_side=(this.width<0)?-1:1;this.excl_width=Math.floor(this.width/100)*5;this.width=Math.abs(this.width%100)}}if((this.color===undefined)&&(this.width>0)){this.color="lightgrey"}this.func=this.Apply.bind(this)}c.prototype.ChangeExcl=function(p,q){if(q!==undefined){this.excl_width=q}if(p!==undefined){this.excl_side=p;if((this.excl_width===0)&&(this.excl_side!==0)){this.excl_width=20}}this.changed=true};c.prototype.Apply=function(p){this.used=true;if(this.color=="none"){p.style("stroke",null).style("stroke-width",null).style("stroke-dasharray",null)}else{p.style("stroke",this.color).style("stroke-width",this.width).style("stroke-dasharray",f.root_line_styles[this.style]||null)}};c.prototype.Change=function(p,r,q){if(p!==undefined){this.color=p}if(r!==undefined){this.width=r}if(q!==undefined){this.style=q}this.changed=true};function i(s,t,q,r,p){this.color="none";this.colorindx=0;this.pattern=0;this.used=true;this.kind=(r!==undefined)?r:2;this.changed=false;this.func=this.Apply.bind(this);if(s&&(typeof s=="object")){if((t===undefined)&&("fFillStyle" in s)){t=s.fFillStyle}if((q==undefined)&&("fFillColor" in s)){q=s.fFillColor}}this.Change(q,t,p);this.changed=false}i.prototype.Apply=function(p){this.used=true;p.style("fill",this.color);if("opacity" in this){p.style("opacity",this.opacity)}if("antialias" in this){p.style("antialias",this.antialias)}};i.prototype.empty=function(){return(this.color=="none")};i.prototype.verifyDirectChange=function(p){if((this.color!=="none")&&(this.pattern<1001)){this.color="none"}var q=this.colorindx;if(this.color!=="none"){q=b.Painter.root_colors.indexOf(this.color);if(q<0){q=b.Painter.root_colors.length;b.Painter.root_colors.push(this.color)}}this.Change(q,this.pattern,p?p.svg_canvas():null)};i.prototype.Change=function(r,u,q){this.changed=true;if((r!==undefined)&&!isNaN(r)){this.colorindx=r}if((u!==undefined)&&!isNaN(u)){this.pattern=u;delete this.opacity;delete this.antialias}if(this.pattern<1001){this.color="none";return true}if((this.pattern===1001)&&(this.colorindx===0)&&(this.kind===1)){this.color="none";return true}this.color=b.Painter.root_colors[this.colorindx];if(typeof this.color!="string"){this.color="none"}if(this.pattern===1001){return true}if((this.pattern>=4000)&&(this.pattern<=4100)){this.opacity=(this.pattern-4000)/100;return true}if(!q||q.empty()||(this.pattern<3000)||(this.pattern>3025)){return false}var v="pat_"+this.pattern+"_"+this.colorindx;var p=q.select(".canvas_defs");if(p.empty()){p=q.insert("svg:defs",":first-child").attr("class","canvas_defs")}var s=this.color;this.color="url(#"+v+")";this.antialias=false;if(!p.select("."+v).empty()){return true}var t=p.append("svg:pattern").attr("id",v).attr("class",v).attr("patternUnits","userSpaceOnUse");switch(this.pattern){case 3001:t.attr("width",2).attr("height",2);t.append("svg:rect").attr("x",0).attr("y",0).attr("width",1).attr("height",1);t.append("svg:rect").attr("x",1).attr("y",1).attr("width",1).attr("height",1);break;case 3002:t.attr("width",4).attr("height",2);t.append("svg:rect").attr("x",1).attr("y",0).attr("width",1).attr("height",1);t.append("svg:rect").attr("x",3).attr("y",1).attr("width",1).attr("height",1);break;case 3003:t.attr("width",4).attr("height",4);t.append("svg:rect").attr("x",2).attr("y",1).attr("width",1).attr("height",1);t.append("svg:rect").attr("x",0).attr("y",3).attr("width",1).attr("height",1);break;case 3005:t.attr("width",8).attr("height",8);t.append("svg:line").attr("x1",0).attr("y1",0).attr("x2",8).attr("y2",8);break;case 3006:t.attr("width",4).attr("height",4);t.append("svg:line").attr("x1",1).attr("y1",0).attr("x2",1).attr("y2",3);break;case 3007:t.attr("width",4).attr("height",4);t.append("svg:line").attr("x1",0).attr("y1",1).attr("x2",3).attr("y2",1);break;case 3010:t.attr("width",10).attr("height",10);t.append("svg:line").attr("x1",0).attr("y1",2).attr("x2",10).attr("y2",2);t.append("svg:line").attr("x1",0).attr("y1",7).attr("x2",10).attr("y2",7);t.append("svg:line").attr("x1",2).attr("y1",0).attr("x2",2).attr("y2",2);t.append("svg:line").attr("x1",7).attr("y1",2).attr("x2",7).attr("y2",7);t.append("svg:line").attr("x1",2).attr("y1",7).attr("x2",2).attr("y2",10);break;case 3021:case 3022:t.attr("width",10).attr("height",10);t.append("svg:line").attr("x1",0).attr("y1",5).attr("x2",5).attr("y2",5);t.append("svg:line").attr("x1",5).attr("y1",5).attr("x2",5).attr("y2",0);t.append("svg:line").attr("x1",5).attr("y1",10).attr("x2",10).attr("y2",10);t.append("svg:line").attr("x1",10).attr("y1",10).attr("x2",10).attr("y2",5);break;default:t.attr("width",8).attr("height",8);t.append("svg:line").attr("x1",8).attr("y1",0).attr("x2",0).attr("y2",8);break}t.selectAll("line").style("stroke",s).style("stroke-width",1);t.selectAll("rect").style("fill",s);return true};f.createAttMarker=function(q,p){return new g(q,p)};f.createAttLine=function(r,q,p){return new c(r,q,p)};f.clearCuts=function(p){var s=p.indexOf("["),r=p.indexOf("]");if((s>=0)&&(r>=0)&&(s<r)){for(var q=s;q<=r;++q){p[q]=" "}}return p};f.getFontDetails=function(t,q){var p={name:"Arial",size:Math.round(q||11),weight:null,style:null},s=Math.floor(t/10),r=f.root_fonts[s]||"";while(r.length>0){if(r[0]==="b"){p.weight="bold"}else{if(r[0]==="i"){p.style="italic"}else{if(r[0]==="o"){p.style="oblique"}else{break}}}r=r.substr(1)}if(r=="Symbol"){p.weight=p.style=null}p.name=r;p.aver_width=f.root_fonts_aver_width[s]||0.55;p.setFont=function(v,u){v.attr("font-family",this.name);if(u!="without-size"){v.attr("font-size",this.size).attr("xml:space","preserve")}if(this.weight){v.attr("font-weight",this.weight)}if(this.style){v.attr("font-style",this.style)}};p.func=p.setFont.bind(p);return p};f.chooseTimeFormat=function(q,p){if(q<0.5){return p?"%S.%L":"%M:%S.%L"}if(q<30){return p?"%Mm%S":"%H:%M:%S"}q/=60;if(q<30){return p?"%Hh%M":"%d/%m %H:%M"}q/=60;if(q<12){return p?"%d-%Hh":"%d/%m/%y %Hh"}q/=24;if(q<15.218425){return p?"%d/%m":"%d/%m/%y"}q/=30.43685;if(q<6){return"%d/%m/%y"}q/=12;if(q<2){return p?"%m/%y":"%d/%m/%y"}return"%Y"};f.getTimeFormat=function(p){var q=p.fTimeFormat.indexOf("%F");if(q>=0){return p.fTimeFormat.substr(0,q)}return p.fTimeFormat};f.getTimeOffset=function(u){var E=u.fTimeFormat.indexOf("%F");if(E<0){return b.gStyle.fTimeOffset*1000}var D=u.fTimeFormat.substr(E+2);if(D.indexOf("1995-01-01 00:00:00s0")==0){return 788918400000}if((D=="0")||(D=="")){return 0}function y(G,F,p){var I=D.indexOf(G);if(I<0){I="";return F}var H=parseInt(D.substr(0,I));D=D.substr(I+1);if(isNaN(H)||(H<F)||(H>p)){I="";return F}return H}var B=y("-",1970,2300),A=y("-",1,12)-1,C=y(" ",1,31),v=y(":",0,23),x=y(":",0,59),z=y("s",0,59),r=y(" ",0,999);var s=new Date(Date.UTC(B,A,C,v,x,z,r));var w=s.getTime();D=D.toUpperCase();if(D.indexOf("GMT")==0){w+=s.getTimezoneOffset()*60000;D=D.substr(4).trim();if(D.length>3){var q=0,t=1000;if(D[0]=="-"){q=1;t=-1000}w-=t*(parseInt(D.substr(q,2))*3600+parseInt(D.substr(q+2,2))*60)}}return w};f.translateLaTeX=function(q){while((q.length>2)&&(q[0]=="{")&&(q[q.length-1]=="}")){q=q.substr(1,q.length-2)}for(var p in this.symbols_map){q=q.replace(new RegExp(p,"g"),this.symbols_map[p])}return q};f.approxTextWidth=function(p,q){return q.length*p.size*p.aver_width};f.isAnyLatex=function(p){return(p.indexOf("#")>=0)||(p.indexOf("\\")>=0)||(p.indexOf("{")>=0)};f.translateMath=function(z,u,v,A){if(u!=2){for(var B in f.math_symbols_map){z=z.replace(new RegExp(B,"g"),f.math_symbols_map[B])}for(var B in f.symbols_map){z=z.replace(new RegExp(B,"g"),"\\"+B.substr(1))}var y="",w=true;while(z){var r=z.indexOf("#color[");if((r<0)&&w){y=z;break}w=false;if(r!=0){var q=(r<0)?z:z.substr(0,r);y+=q;if(r<0){break}}z=z.substr(r+7);r=z.indexOf("]{");if(r<=0){break}var C=parseInt(z.substr(0,r));if(isNaN(C)){break}var t=A.get_color(C);z=z.substr(r+2);r=z.indexOf("}");if(r<0){break}var s=z.substr(0,r);z=z.substr(r+1);if(s){y+="\\color{"+t+"}{"+s+"}"}}z=y}else{z=z.replace(/\\\^/g,"\\hat")}if(typeof v!="string"){return"\\("+z+"\\)"}return"\\(\\color{"+v+"}"+z+"\\)"};f.BuildSvgPath=function(v,F,B,q){var s=v.indexOf("bezier")>=0;if(q===undefined){q=s?2:0}if(B===undefined){B=0}function r(H,G){return(G.gry-H.gry)/(G.grx-H.grx)}function y(J){var I=0,H=J.length-1,G=[],M=J[0],L=J[1],K=G[0]=r(M,L);while(++I<H){G[I]=(K+(K=r(M=L,L=J[I+1])))/2}G[I]=K;return G}function p(M){var N,I,H,L,G=y(M),K=-1,J=M.length-1;while(++K<J){N=r(M[K],M[K+1]);if(Math.abs(N)<0.000001){G[K]=G[K+1]=0}else{I=G[K]/N;H=G[K+1]/N;L=I*I+H*H;if(L>9){L=N*3/Math.sqrt(L);G[K]=L*I;G[K+1]=L*H}}}K=-1;while(++K<=J){L=(M[Math.min(J,K+1)].grx-M[Math.max(0,K-1)].grx)/(6*(1+G[K]*G[K]));M[K].dgrx=L||0;M[K].dgry=G[K]*L||0}}var x={},E=F[0],u,w=Math.max(E.gry,B+5),A=Math.round(E.grx),z=Math.round(E.gry),D,C;x.path=((v[0]=="L")?"L":"M")+E.grx.toFixed(q)+","+E.gry.toFixed(q);if(s||v.indexOf("calc")>=0){p(F)}if(s){x.path+="c"+E.dgrx.toFixed(q)+","+E.dgry.toFixed(q)+","}for(var t=1;t<F.length;++t){u=E;E=F[t];if(s){if(t>1){x.path+="s"}x.path+=(E.grx-E.dgrx-u.grx).toFixed(q)+","+(E.gry-E.dgry-u.gry).toFixed(q)+","+(E.grx-u.grx).toFixed(q)+","+(E.gry-u.gry).toFixed(q);w=Math.max(w,u.gry)}else{D=Math.round(E.grx-A);C=Math.round(E.gry-z);x.path+="l"+D+","+C;A+=D;z+=C;w=Math.max(w,z)}}if(B>0){x.close="L"+E.grx.toFixed(q)+","+w.toFixed(q)+"L"+F[0].grx.toFixed(q)+","+w.toFixed(q)+"Z"}return x};function m(){this.divid=null}m.prototype.AccessTopPainter=function(q){var p=this.select_main().node(),r=p?p.firstChild:null;if(!r){return null}if(q===true){r.painter=this}else{if(q===false){delete r.painter}}return r.painter};m.prototype.Cleanup=function(q){var p=this.select_main("origin");if(!p.empty()&&!q){p.html("")}this.set_layout_kind("simple");this.AccessTopPainter(false);this.divid=null;if(this._hpainter&&typeof this._hpainter.ClearPainter==="function"){this._hpainter.ClearPainter(this)}delete this._hitemname;delete this._hdrawopt;delete this._hpainter};m.prototype.DrawingReady=function(q){this._ready_called_=true;if(this._ready_callback_!==undefined){var p=this._ready_callback_;if(!this._return_res_painter){q=this}delete this._return_res_painter;delete this._ready_callback_;while(p.length){b.CallBack(p.shift(),q)}}return this};m.prototype.WhenReady=function(p){if(typeof p!=="function"){return}if("_ready_called_" in this){return b.CallBack(p,this)}if(this._ready_callback_===undefined){this._ready_callback_=[]}this._ready_callback_.push(p)};m.prototype.GetObject=function(){return null};m.prototype.MatchObjectType=function(p){return false};m.prototype.UpdateObject=function(p){return false};m.prototype.RedrawPad=function(p){};m.prototype.RedrawObject=function(q){if(!this.UpdateObject(q)){return false}var p=document.body.style.cursor;document.body.style.cursor="wait";this.RedrawPad();document.body.style.cursor=p;return true};m.prototype.CheckResize=function(p){return false};m.prototype.select_main=function(s){if(!this.divid){return o.select(null)}var u=this.divid;if((typeof u=="string")&&(u[0]!="#")){u="#"+u}var q=o.select(u);if(q.empty()||(s==="origin")){return q}var t=q.property("use_enlarge"),r=q.property("layout")||"simple",p=(r=="simple")?"":q.property("layout_selector");if(p){q=q.select(p)}if(!s&&!q.empty()&&t){q=o.select("#jsroot_enlarge_div")}return q};m.prototype.get_layout_kind=function(){var p=this.select_main("origin"),q=p.empty()?"":p.property("layout");return q||"simple"};m.prototype.set_layout_kind=function(r,p){var q=this.select_main("origin");if(!q.empty()){if(!r){r="simple"}q.property("layout",r);q.property("layout_selector",(r!="simple")&&p?p:null)}};m.prototype.check_main_resize=function(B,p,v){var t=this.enlarge_main("state"),r=this.select_main("origin"),s=this.select_main(),u=5;if(t!=="on"){if(p&&p.width&&p.height){r.style("width",p.width+"px").style("height",p.height+"px")}}var z=this.get_visible_rect(r,true);var w=r.attr("can_resize"),A=false;if(w=="height"){if(v&&Math.abs(z.width*v-z.height)>0.1*z.width){A=true}}if(((z.height<=u)||(z.width<=u))&&w&&w!=="false"){A=true}if(A&&(t!=="on")){if(z.width>u){v=v||0.66;r.style("height",Math.round(z.width*v)+"px")}else{if(w!=="height"){r.style("width","200px").style("height","100px")}}}var y=this.get_visible_rect(s),q=s.property("draw_height"),x=s.property("draw_width");y.changed=false;if(q&&x&&(q>0)&&(x>0)){if((q!==y.height)||(x!==y.width)){if((B>1)||(y.width/x<0.66)||(y.width/x>1.5)||(y.height/q<0.66)&&(y.height/q>1.5)){y.changed=true}}}else{y.changed=true}return y};m.prototype.enlarge_main=function(v){var p=this.select_main(true),s=this.select_main("origin");if(p.empty()||!b.gStyle.CanEnlarge||(s.property("can_enlarge")===false)){return false}if(v===undefined){return true}if(v==="verify"){return true}var u=s.property("use_enlarge")?"on":"off";if(v==="state"){return u}if(v==="toggle"){v=(u==="off")}var t=o.select("#jsroot_enlarge_div");if((v===true)&&(u!=="on")){if(!t.empty()){return false}t=o.select(document.body).append("div").attr("id","jsroot_enlarge_div");var r=this.get_visible_rect(p),q=this.get_visible_rect(t);if((q.width<=r.width)||(q.height<=r.height)){if(q.width*q.height<r.width*r.height){console.log("Enlarged area "+q.width+"x"+q.height+" smaller then original drawing "+r.width+"x"+r.height);t.remove();return false}}while(p.node().childNodes.length>0){t.node().appendChild(p.node().firstChild)}s.property("use_enlarge",true);return true}if((v===false)&&(u!=="off")){while(t.node()&&t.node().childNodes.length>0){p.node().appendChild(t.node().firstChild)}t.remove();s.property("use_enlarge",false);return true}return false};m.prototype.GetStyleValue=function(q,p){if(!q||q.empty()){return 0}var r=q.style(p);if(!r||(typeof r!=="string")){return 0}r=parseFloat(r.replace("px",""));return isNaN(r)?0:Math.round(r)};m.prototype.get_visible_rect=function(s,p){if(b.nodejs){return{width:parseInt(s.attr("width")),height:parseInt(s.attr("height"))}}var r=s.node().getBoundingClientRect(),q={width:Math.round(r.width),height:Math.round(r.height)};if(!p){q.width-=this.GetStyleValue(s,"padding-left")+this.GetStyleValue(s,"padding-right");q.height-=this.GetStyleValue(s,"padding-top")-this.GetStyleValue(s,"padding-bottom")}return q};m.prototype.SetDivId=function(p){if(arguments.length>0){this.divid=p}this.AccessTopPainter(true)};m.prototype.SetItemName=function(p,q,r){if(typeof p==="string"){this._hitemname=p}else{delete this._hitemname}if(typeof q==="string"){this._hdrawopt=q}this._hpainter=r};m.prototype.GetItemName=function(){return("_hitemname" in this)?this._hitemname:null};m.prototype.GetItemDrawOpt=function(){return("_hdrawopt" in this)?this._hdrawopt:""};m.prototype.CanZoomIn=function(q,r,p){return false};function e(p){m.call(this);this.draw_g=null;this.pad_name="";this.main=null;this.draw_object=((p!==undefined)&&(typeof p=="object"))?p:null}e.prototype=Object.create(m.prototype);e.prototype.Cleanup=function(){this.RemoveDrawG();var q=true;if(this.is_main_painter()){var p=this.pad_painter(true);if(!p||p.normal_canvas===false){q=false}}this.pad_name="";this.main=null;this.draw_object=null;delete this.fillatt;delete this.lineatt;delete this.markeratt;delete this.bins;delete this._drawopt;delete this.root_colors;m.prototype.Cleanup.call(this,q)};e.prototype.GetObject=function(){return this.draw_object};e.prototype.GetClassName=function(){var p=this.draw_object?this.draw_object._typename:"";return p||""};e.prototype.MatchObjectType=function(p){if((p===undefined)||(p===null)||(this.draw_object===null)){return false}if(typeof p==="string"){return this.draw_object._typename===p}return(typeof p==="object")&&(this.draw_object._typename===p._typename)};e.prototype.SetItemName=function(p,q,s){m.prototype.SetItemName.call(this,p,q,s);if(this.no_default_title||(p=="")){return}var r=this.svg_canvas();if(!r.empty()){r.select("title").text(p)}else{this.select_main().attr("title",p)}};e.prototype.UpdateObject=function(p){if(!this.MatchObjectType(p)){return false}b.extend(this.GetObject(),p);return true};e.prototype.GetTipName=function(p){var q=this.GetItemName(),r=this.GetObject();if(q===null){q=""}if((q.length===0)&&r&&r.fName){q=this.GetObject().fName}if(q.lenght>20){q=q.substr(0,17)+"..."}if((q.length>0)&&(p!==undefined)){q+=p}return q};e.prototype.pad_painter=function(p){var q=p?this.svg_pad():this.svg_canvas();return q.empty()?null:q.property("pad_painter")};e.prototype.get_color=function(r){var q=this.root_colors;if(!q){var p=this.pad_painter();q=this.root_colors=(p&&p.root_colors)?p.root_colors:b.Painter.root_colors}return q[r]};e.prototype.add_color=function(q){var r=this.root_colors;if(!r){var p=this.pad_painter();r=this.root_colors=(p&&p.root_colors)?p.root_colors:b.Painter.root_colors}var s=r.indexOf(q);if(s>=0){return s}r.push(q);return r.length-1};e.prototype.CheckResize=function(p){var q=this.pad_painter();if(!q){return false}q.CheckCanvasResize(p);return true};e.prototype.RemoveDrawG=function(){if(this.draw_g!=null){this.draw_g.remove();this.draw_g=null}};e.prototype.RecreateDrawG=function(q,p){console.warn("Obsolete RecreateDrawG is used, will be removed soon. Change to CreateG");return this.CreateG(q?undefined:p)};e.prototype.CreateG=function(s){if(this.draw_g){this.draw_g.selectAll("*").remove()}else{if(s){var t=this.svg_frame();if(t.empty()){return t}if(typeof s!="string"){s="main_layer"}var r=t.select("."+s);if(r.empty()){r=t.select(".main_layer")}this.draw_g=r.append("svg:g")}else{var r=this.svg_layer("primitives_layer");this.draw_g=r.append("svg:g");var q=[],p=r.node().childNodes;for(var u=0;u<p.length;++u){if(o.select(p[u]).classed("most_upper_primitives")){q.push(p[u])}}q.forEach(function(v){o.select(v).raise()})}}if(this.draw_object){this.draw_g.attr("objname",encodeURI(this.draw_object.fName||"name"));this.draw_g.attr("objtype",encodeURI(this.draw_object._typename||"type"))}return this.draw_g};e.prototype.svg_canvas=function(){return this.select_main().select(".root_canvas")};e.prototype.svg_pad=function(p){var q=this.svg_canvas();if(p===undefined){p=this.pad_name}if(p&&!q.empty()){q=q.select(".primitives_layer").select("[pad="+p+"]")}return q};e.prototype.svg_layer=function(r,q){var p=this.svg_pad(q);if(p.empty()){return p}if(r.indexOf("prim#")==0){p=p.select(".primitives_layer");r=r.substr(5)}var t=p.node().firstChild;while(t!==null){var s=o.select(t);if(s.classed(r)){return s}t=t.nextSibling}return o.select(null)};e.prototype.CurrentPadName=function(q){var p=this.svg_canvas();if(p.empty()){return""}var r=p.property("current_pad");if(q!==undefined){p.property("current_pad",q)}return r};e.prototype.root_pad=function(){var p=this.pad_painter(true);return p?p.pad:null};e.prototype.ConvertToNDC=function(q,r,p){if(p){return r}var s=this.root_pad();if(!s){return r}if(q=="y"){if(s.fLogy){r=(r>0)?b.log10(r):s.fUymin}return(r-s.fY1)/(s.fY2-s.fY1)}if(s.fLogx){r=(r>0)?b.log10(r):s.fUxmin}return(r-s.fX1)/(s.fX2-s.fX1)};e.prototype.AxisToSvg=function(r,s,q){var p=this.main_painter();if(p&&!q){s=(r=="y")?p.gry(s)+p.frame_y():p.grx(s)+p.frame_x()}else{if(q!==true){s=this.ConvertToNDC(r,s)}s=(r=="y")?(1-s)*this.pad_height():s*this.pad_width()}return Math.round(s)};e.prototype.svg_frame=function(p){return this.svg_layer("primitives_layer",p).select(".root_frame")};e.prototype.frame_painter=function(){var q=this.svg_frame();var p=q.empty()?null:q.property("frame_painter");return p?p:null};e.prototype.pad_width=function(p){var q=this.svg_pad(p).property("draw_width");return isNaN(q)?0:q};e.prototype.pad_height=function(p){var q=this.svg_pad(p).property("draw_height");return isNaN(q)?0:q};e.prototype.frame_property=function(p){var q=this.svg_frame();if(q.empty()){return 0}q=q.property(p);return(q===undefined)||isNaN(q)?0:q};e.prototype.frame_x=function(){return this.frame_property("draw_x")};e.prototype.frame_y=function(){return this.frame_property("draw_y")};e.prototype.frame_width=function(){return this.frame_property("draw_width")};e.prototype.frame_height=function(){return this.frame_property("draw_height")};e.prototype.embed_3d=function(){if(b.BatchMode){return 3}if(b.gStyle.Embed3DinSVG<2){return b.gStyle.Embed3DinSVG}if(b.browser.isFirefox){return b.gStyle.Embed3DinSVG}return 1};e.prototype.access_3d_kind=function(q){var p=this.svg_pad(this.this_pad_name);if(p.empty()){return -1}var r=p.property("can3d");if(q!==undefined){p.property("can3d",q)}return((r===null)||(r===undefined))?-1:r};e.prototype.size_for_3d=function(x){if(x===undefined){x=this.embed_3d()}var r=this.svg_pad(this.this_pad_name),p="draw3d_"+(this.this_pad_name||this.pad_name||"canvas");if(r.empty()){var v=this.get_visible_rect(this.select_main());if((v.height<10)&&(v.width>10)){v.height=Math.round(0.66*v.width);this.select_main().style("height",v.height+"px")}v.x=0;v.y=0;v.clname=p;v.can3d=-1;return v}var s=r;if(x===0){s=this.svg_canvas()}var y={x:0,y:0,width:100,height:100,clname:p,can3d:x};if(this.frame_painter()!==null){s=this.svg_frame();y.x=s.property("draw_x");y.y=s.property("draw_y")}y.width=s.property("draw_width");y.height=s.property("draw_height");if((this.frame_painter()===null)&&(x>0)){y.x=Math.round(y.x+y.width*b.gStyle.fPadLeftMargin);y.y=Math.round(y.y+y.height*b.gStyle.fPadTopMargin);y.width=Math.round(y.width*(1-b.gStyle.fPadLeftMargin-b.gStyle.fPadRightMargin));y.height=Math.round(y.height*(1-b.gStyle.fPadTopMargin-b.gStyle.fPadBottomMargin))}var w=this.pad_width(this.this_pad_name),q=w-y.x-y.width,t=this.pad_height(this.this_pad_name),u=t-y.y-y.height;if((q>=0)&&(u>=0)){y.x=Math.round(y.x*0.3);y.y=Math.round(y.y*0.9);y.width=w-y.x-Math.round(q*0.3);y.height=t-y.y-Math.round(u*0.5)}if(x===1){this.CalcAbsolutePosition(this.svg_pad(this.this_pad_name),y)}return y};e.prototype.clear_3d_canvas=function(){var q=this.access_3d_kind(null);if(q<0){return}var p=this.size_for_3d(q);if(p.can3d===0){o.select(this.svg_canvas().node().nextSibling).remove();this.svg_canvas().style("display",null)}else{if(this.svg_pad(this.this_pad_name).empty()){return}this.apply_3d_size(p).remove();this.svg_frame().style("display",null)}};e.prototype.add_3d_canvas=function(q,s){if(!s||(q.can3d<-1)){return}if(q.can3d===-1){var p=this.select_main().node();if(p!==null){p.appendChild(s);s.painter=this}return}this.access_3d_kind(q.can3d);if(q.can3d===0){this.svg_canvas().style("display","none");this.svg_canvas().node().parentNode.appendChild(s)}else{if(this.svg_pad(this.this_pad_name).empty()){return}this.svg_frame().style("display","none");var r=this.apply_3d_size(q);r.attr("title","").node().appendChild(s)}};e.prototype.apply_3d_size=function(y,p){if(y.can3d<0){return o.select(null)}var q;if(y.can3d>1){q=this.svg_layer(y.clname);if(p){return q}var u=this.svg_pad();if(y.can3d===3){if(q.empty()){q=u.insert("g",".primitives_layer").attr("class",y.clname)}q.attr("transform","translate("+y.x+","+y.y+")")}else{if(q.empty()){q=u.insert("foreignObject",".primitives_layer").attr("class",y.clname)}q.attr("x",y.x).attr("y",y.y).attr("width",y.width).attr("height",y.height).attr("viewBox","0 0 "+y.width+" "+y.height).attr("preserveAspectRatio","xMidYMid")}}else{var r=this.svg_canvas().node().parentNode;q=o.select(r).select("."+y.clname);if(p){return q}this.svg_canvas().property("redraw_by_resize",true);if(q.empty()){q=o.select(r).append("div").attr("class",y.clname+" jsroot_noselect")}var x=r.getBoundingClientRect();while(r){if(r===document){r=null;break}try{if(getComputedStyle(r).position!=="static"){break}}catch(s){break}r=r.parentNode}var w=r?r.getBoundingClientRect():{top:0,left:0};var v=Math.round(x.left-w.left),t=Math.round(x.top-w.top);q.style("position","absolute").style("left",(y.x+v)+"px").style("top",(y.y+t)+"px").style("width",y.width+"px").style("height",y.height+"px")}return q};e.prototype.main_painter=function(s,q){var r=this.main;if(!r){var p=this.svg_pad(q);if(p.empty()){r=this.AccessTopPainter()}else{r=p.property("mainpainter")}if(!r){r=null}if(!s){this.main=r}}return r};e.prototype.is_main_painter=function(){return this===this.main_painter()};e.prototype.SetDivId=function(t,s,r){if(t!==undefined){this.divid=t}if(!s){s=0}this.create_canvas=false;var q=this.svg_canvas();if(q.empty()&&(s>0)&&(s!==5)){b.Painter.drawCanvas(t,null,((s==2)||(s==4))?"noframe":"");q=this.svg_canvas();this.create_canvas=true}if(q.empty()){if((s<0)||(s===5)||this.iscan){return}this.AccessTopPainter(true);return}this.pad_name=r;if(this.pad_name===undefined){this.pad_name=this.CurrentPadName()}if(s<0){return}if(this.svg_frame().select(".main_layer").empty()&&((s==1)||(s==3))){b.Painter.drawFrame(t,null);if(this.svg_frame().empty()){return alert("Fail to draw dummy TFrame")}}var p=this.svg_pad();if(p.empty()){return}if(p.property("pad_painter")!==this){p.property("pad_painter").painters.push(this)}if(((s===1)||(s===4)||(s===5))&&!p.property("mainpainter")){p.property("mainpainter",this)}};e.prototype.CalcAbsolutePosition=function(p,q){while(!p.empty()&&!p.classed("root_canvas")){if(p.classed("root_frame")||p.classed("root_pad")){q.x+=p.property("draw_x");q.y+=p.property("draw_y")}p=o.select(p.node().parentNode)}return q};e.prototype.createAttFill=function(r,s,p,q){return new i(r,s,p,q,this.svg_canvas())};m.prototype.AttributeChange=function(r,p,q){};e.prototype.ForEachPainter=function(q){var p=this.AccessTopPainter();if(p){return q(p)}var r=this.pad_painter(true);if(r){r.ForEachPainterInPad(q)}};e.prototype.RedrawPad=function(){var p=this.pad_painter(true);if(p){p.Redraw()}};e.prototype.SwitchTooltip=function(p){var q=this.frame_painter();if(q){q.ProcessTooltipEvent(null,p)}if(this.control&&(typeof this.control.SwitchTooltip=="function")){this.control.SwitchTooltip(p)}};e.prototype.AddDrag=function(y){if(!b.gStyle.MoveResize){return}var q=this,r=null;function w(A){if("buttons" in A){return A.buttons===2}else{if("which" in A){return A.which===3}else{if("button" in A){return A.button===2}}}return false}function p(){return Number(q.draw_g.attr("width"))}function z(){return Number(q.draw_g.attr("height"))}function u(E,D,A,C){function B(I,H){var F="js_"+I.replace("-","_"),G=E.select("."+F);if(G.empty()){G=E.append("path").classed(F,true)}G.style("opacity",0).style("cursor",I).attr("d",H);if(C){G.call(C)}}B("nw-resize","M2,2h15v-5h-20v20h5Z");B("ne-resize","M"+(D-2)+",2h-15v-5h20v20h-5 Z");B("sw-resize","M2,"+(A-2)+"h15v5h-20v-20h5Z");B("se-resize","M"+(D-2)+","+(A-2)+"h-15v5h20v-20h-5Z");B("w-resize","M-3,18h5v"+Math.max(0,A-2*18)+"h-5Z");B("e-resize","M"+(D+3)+",18h-5v"+Math.max(0,A-2*18)+"h5Z");B("n-resize","M18,-3v5h"+Math.max(0,D-2*18)+"v-5Z");B("s-resize","M18,"+(A+3)+"v-5h"+Math.max(0,D-2*18)+"v5Z")}function s(){r.style("cursor","auto");if(!q.draw_g){r.remove();r=null;return false}var E=Number(q.draw_g.attr("x")),D=Number(q.draw_g.attr("y")),H=Number(r.attr("x")),G=Number(r.attr("y")),A=Number(r.attr("width")),B=Number(r.attr("height"));if(y.minwidth&&A<y.minwidth){A=y.minwidth}if(y.minheight&&B<y.minheight){B=y.minheight}var C=(A!==p())||(B!==z()),F=(H!==E)||(G!==D);q.draw_g.attr("x",H).attr("y",G).attr("transform","translate("+H+","+G+")").attr("width",A).attr("height",B);r.remove();r=null;q.SwitchTooltip(true);u(q.draw_g,A,B);if(C||F){if(C&&("resize" in y)){y.resize(A,B)}if(F&&("move" in y)){y.move(H,G,H-oldxx,G-D)}if(C||F){if("obj" in y){y.obj.fX1NDC=H/q.pad_width();y.obj.fX2NDC=(H+A)/q.pad_width();y.obj.fY1NDC=1-(G+B)/q.pad_height();y.obj.fY2NDC=1-G/q.pad_height();y.obj.modified_NDC=true}if("redraw" in y){y.redraw()}}}return C||F}var t="",x,v;if(b._test_d3_===3){t="drag";x=o.behavior.drag().origin(Object);v=o.behavior.drag().origin(Object)}else{x=o.drag().subject(Object);v=o.drag().subject(Object)}x.on(t+"start",function(){if(w(o.event.sourceEvent)){return}b.Painter.closeMenu();q.SwitchTooltip(false);o.event.sourceEvent.preventDefault();o.event.sourceEvent.stopPropagation();var A={acc_x1:Number(q.draw_g.attr("x")),acc_y1:Number(q.draw_g.attr("y")),pad_w:q.pad_width()-p(),pad_h:q.pad_height()-z(),drag_tm:new Date()};r=o.select(q.draw_g.node().parentNode).append("rect").classed("zoom",true).attr("x",A.acc_x1).attr("y",A.acc_y1).attr("width",p()).attr("height",z()).style("cursor","move").style("pointer-events","none").property("drag_handle",A)}).on("drag",function(){if(!r){return}o.event.sourceEvent.preventDefault();o.event.sourceEvent.stopPropagation();var A=r.property("drag_handle");A.acc_x1+=o.event.dx;A.acc_y1+=o.event.dy;r.attr("x",Math.min(Math.max(A.acc_x1,0),A.pad_w)).attr("y",Math.min(Math.max(A.acc_y1,0),A.pad_h))}).on(t+"end",function(){if(!r){return}o.event.sourceEvent.preventDefault();var A=r.property("drag_handle");if(s()===false){var C=(new Date()).getTime()-A.drag_tm.getTime();if(y.ctxmenu&&(C>600)){var B=resize_se.node().getBoundingClientRect();q.ShowContextMenu("main",{clientX:B.left,clientY:B.top})}else{if(y.canselect&&(C<=600)){q.pad_painter().SelectObjectPainter(q)}}}});v.on(t+"start",function(){if(w(o.event.sourceEvent)){return}o.event.sourceEvent.stopPropagation();o.event.sourceEvent.preventDefault();q.SwitchTooltip(false);var A={acc_x1:Number(q.draw_g.attr("x")),acc_y1:Number(q.draw_g.attr("y")),pad_w:q.pad_width(),pad_h:q.pad_height()};A.acc_x2=A.acc_x1+p();A.acc_y2=A.acc_y1+z();r=o.select(q.draw_g.node().parentNode).append("rect").classed("zoom",true).style("cursor",o.select(this).style("cursor")).attr("x",A.acc_x1).attr("y",A.acc_y1).attr("width",A.acc_x2-A.acc_x1).attr("height",A.acc_y2-A.acc_y1).property("drag_handle",A)}).on("drag",function(){if(!r){return}o.event.sourceEvent.preventDefault();o.event.sourceEvent.stopPropagation();var H=r.property("drag_handle"),C=o.event.dx,A=o.event.dy,G=o.select(this);if(G.classed("js_nw_resize")){H.acc_x1+=C;H.acc_y1+=A}else{if(G.classed("js_ne_resize")){H.acc_x2+=C;H.acc_y1+=A}else{if(G.classed("js_sw_resize")){H.acc_x1+=C;H.acc_y2+=A}else{if(G.classed("js_se_resize")){H.acc_x2+=C;H.acc_y2+=A}else{if(G.classed("js_w_resize")){H.acc_x1+=C}else{if(G.classed("js_n_resize")){H.acc_y1+=A}else{if(G.classed("js_e_resize")){H.acc_x2+=C}else{if(G.classed("js_s_resize")){H.acc_y2+=A}}}}}}}}var D=Math.max(0,H.acc_x1),B=Math.min(H.acc_x2,H.pad_w),F=Math.max(0,H.acc_y1),E=Math.min(H.acc_y2,H.pad_h);r.attr("x",D).attr("y",F).attr("width",Math.max(0,B-D)).attr("height",Math.max(0,E-F))}).on(t+"end",function(){if(!r){return}o.event.sourceEvent.preventDefault();s()});if(!y.only_resize){this.draw_g.style("cursor","move").call(x)}u(this.draw_g,p(),z(),v)};e.prototype.startTouchMenu=function(r){var p=o.touches(this.svg_frame().node());if(p.length!=1){return}if(!r||(r=="")){r="main"}var q="touch_"+r;o.event.preventDefault();o.event.stopPropagation();this[q]={dt:new Date(),pos:p[0]};this.svg_frame().on("touchcancel",this.endTouchMenu.bind(this,r)).on("touchend",this.endTouchMenu.bind(this,r))};e.prototype.endTouchMenu=function(q){var p="touch_"+q;if(!(p in this)){return}o.event.preventDefault();o.event.stopPropagation();var s=new Date().getTime()-this[p].dt.getTime();this.svg_frame().on("touchcancel",null).on("touchend",null);if(s>500){var r=this.svg_frame().node().getBoundingClientRect();this.ShowContextMenu(q,{clientX:r.left+this[p].pos[0],clientY:r.top+this[p].pos[1]})}delete this[p]};e.prototype.AddColorMenuEntry=function(r,q,w,v,p){if(w===undefined){return}r.add("sub:"+q,function(){var z=(typeof w!=="string");var y=prompt("Enter color "+(z?"(only id number)":"(name or id)"),w);if(y==null){return}var A=parseInt(y);if(!isNaN(A)&&(b.Painter.root_colors[A]!==undefined)){y=b.Painter.root_colors[A]}else{if(z){return}}v.bind(this)(z?A:y)});var x=(typeof w!=="string");for(var s=-1;s<11;++s){if((s<0)&&x){continue}if((s==10)&&(p!==1)){continue}var t=(s<0)?"none":b.Painter.root_colors[s];if((s==0)&&(p==1)){t="none"}var u="<svg width='100' height='18' style='margin:0px;background-color:"+t+"'><text x='4' y='12' style='font-size:12px' fill='"+(s==1?"white":"black")+"'>"+t+"</text></svg>";r.addchk((w==(x?s:t)),u,(x?s:t),v)}r.add("endsub:")};e.prototype.AddSizeMenuEntry=function(q,p,t,v,s,x,u){if(x===undefined){return}q.add("sub:"+p,function(){var y=x.toFixed(4);if(s>=0.1){y=x.toFixed(2)}if(s>=1){y=x.toFixed(0)}var z=prompt("Enter value of "+p,y);if(z==null){return}var z=parseFloat(z);if(!isNaN(z)){u.bind(this)((s>=1)?Math.round(z):z)}});for(var r=t;r<=v;r+=s){var w=r.toFixed(2);if(s>=0.1){w=r.toFixed(1)}if(s>=1){w=r.toFixed(0)}q.addchk((Math.abs(x-r)<s/2),w,r,u)}q.add("endsub:")};var h=function(p){this.path=p;this.connid=null;this.req=null;this.nextrequest=function(w,t){var r=this.path,v="";if(t==="connect"){r+="?connect";this.connid="connect"}else{if(t==="close"){if((this.connid===null)||(this.connid==="close")){return}r+="?connection="+this.connid+"&close";this.connid="close";if(b.browser.qt5){v=";sync"}}else{if((this.connid===null)||(typeof this.connid!=="number")){return console.error("No connection")}else{r+="?connection="+this.connid;if(t==="dummy"){r+="&dummy"}}}}if(w){var s="&post=";for(var q=0;q<w.length;++q){s+=w.charCodeAt(q).toString(16)}r+=s}var u=b.NewHttpRequest(r,"text"+v,function(x){if(x===null){x=this.response}if(this.handle.req===this){this.handle.req=null;if(x=="<<nope>>"){x=""}}this.handle.processreq(x)});u.handle=this;if(t==="dummy"){this.req=u}u.send()};this.processreq=function(q){if(q===null){if(typeof this.onerror==="function"){this.onerror("receive data with connid "+(this.connid||"---"))}this.connid=null;return}if(this.connid==="connect"){this.connid=parseInt(q);console.log("Get new longpoll connection with id "+this.connid);if(typeof this.onopen=="function"){this.onopen()}}else{if(this.connid==="close"){if(typeof this.onclose=="function"){this.onclose()}return}else{if((typeof this.onmessage==="function")&&q){this.onmessage({data:q})}}}if(!this.req){this.nextrequest("","dummy")}};this.send=function(q){this.nextrequest(q)};this.close=function(){this.nextrequest("","close")};this.nextrequest("","connect");return this};var l=function(p){if(!window||!("cefQuery" in window)){return null}this.path=p;this.connid=null;this.nextrequest=function(s,q){var r={request:"",persistent:false};if(q==="connect"){r.request="connect";r.persistent=true;this.connid="connect"}else{if(q==="close"){if((this.connid===null)||(this.connid==="close")){return}r.request=this.connid+"::close";this.connid="close"}else{if((this.connid===null)||(typeof this.connid!=="number")){return console.error("No connection")}else{r.request=this.connid+"::post";if(s){r.request+="::"+s}}}}if(!r.request){return console.error("No CEF request")}r.request=this.path+"::"+r.request;r.onSuccess=this.onSuccess.bind(this);r.onFailure=this.onFailure.bind(this);this.cefid=window.cefQuery(r);return this};this.onFailure=function(q,r){console.log("CEF_ERR: "+q);if(typeof this.onerror==="function"){this.onerror("failure with connid "+(this.connid||"---"))}this.connid=null};this.onSuccess=function(q){if(!q){return}if(this.connid==="connect"){this.connid=parseInt(q);console.log("Get new CEF connection with id "+this.connid);if(typeof this.onopen=="function"){this.onopen()}}else{if(this.connid==="close"){if(typeof this.onclose=="function"){this.onclose()}}else{if((typeof this.onmessage==="function")&&q){this.onmessage({data:q})}}}};this.send=function(q){this.nextrequest(q)};this.close=function(){this.nextrequest("","close");if(this.cefid){window.cefQueryCancel(this.cefid)}delete this.cefid};this.nextrequest("","connect");return this};e.prototype.SendWebsocket=function(p){if(!this._websocket){return false}this._websocket.send(p);if(this._websocket_kind!=="websocket"){return true}if(this._websocket_timer){clearTimeout(this._websocket_timer)}this._websocket_timer=setTimeout(this.KeepAliveWebsocket.bind(this),10000);return true};e.prototype.KeepAliveWebsocket=function(){delete this._websocket_timer;this.SendWebsocket("KEEPALIVE")};e.prototype.CloseWebsocket=function(p){if(this._websocket&&this._websocket_state>0){this._websocket_state=p?-1:0;this._websocket.onclose=null;this._websocket.close();delete this._websocket}};e.prototype.OpenWebsocket=function(p){delete this._websocket;if(p=="cefquery"&&(!window||!("cefQuery" in window))){p="longpoll"}this._websocket_kind=p;this._websocket_state=0;var q=this;function r(u){if(q._websocket_state!=0){return}if(!u){console.log("try open websocket again")}if(q._websocket){q._websocket.close()}delete q._websocket;var t=window.location.href,s=null;if(q._websocket_kind=="cefquery"){var v=t.indexOf("draw.htm");if(v<0){return}t=t.substr(0,v);if(t.indexOf("rootscheme://rootserver")==0){t=t.substr(23)}console.log("configure cefquery "+t);s=new l(t)}else{if((q._websocket_kind!=="longpoll")&&u){t=t.replace("http://","ws://");t=t.replace("https://","wss://");var v=t.indexOf("draw.htm");if(v<0){return}t=t.substr(0,v)+"root.websocket";console.log("configure websocket "+t);s=new WebSocket(t)}else{var v=t.indexOf("draw.htm");if(v<0){return}t=t.substr(0,v)+"root.longpoll";console.log("configure longpoll "+t);s=new h(t)}}if(!s){return}q._websocket=s;s.onopen=function(){console.log("websocket initialized");q._websocket_state=1;if(typeof q.OnWebsocketOpened=="function"){q.OnWebsocketOpened(s)}};s.onmessage=function(w){var x=w.data;if(typeof x!="string"){return console.log("unsupported message kind: "+(typeof x))}if(typeof q.OnWebsocketMsg=="function"){q.OnWebsocketMsg(s,x)}};s.onclose=function(){delete q._websocket;if(q._websocket_state>0){console.log("websocket closed");q._websocket_state=0;if(typeof q.OnWebsocketClosed=="function"){q.OnWebsocketClosed()}}};s.onerror=function(w){console.log("err "+w)};setTimeout(r,3000)}r(true)};e.prototype.ExecuteMenuCommand=function(q){if(q.fName=="Inspect"){this.ShowInpsector();return true}var p=this.pad_painter();if(!p){return false}if((q.fName=="FitPanel")&&p.ActivateFitPanel){p.ActivateFitPanel(this);return true}if(p.ActivateGed&&((q.fName=="DrawPanel")||(q.fName=="SetLineAttributes")||(q.fName=="SetFillAttributes")||(q.fName=="SetMarkerAttributes"))){p.ActivateGed(this);return true}return false};e.prototype.FillObjectExecMenu=function(v,r,t){var u=this.pad_painter();if(!this.snapid||!u||!u._websocket||u._getmenu_callback){return b.CallBack(t)}function p(w){var y=this.pad_painter(),x=this.args_menu_items[parseInt(w)];if(!x||!x.fName){return}if(y.MethodsDialog&&(x.fArgs!==undefined)){return y.MethodsDialog(this,x,this.args_menu_id)}if(this.ExecuteMenuCommand(x)){return}if(y._websocket&&this.args_menu_id){console.log("execute method "+x.fExec+" for object "+this.args_menu_id);y.SendWebsocket("OBJEXEC:"+this.args_menu_id+":"+x.fExec)}}function s(B,w,A,x,C){if(!u._getmenu_callback){return}delete u._getmenu_callback;if(w!==C){console.error("missmatch between request "+w+" and reply "+C+" identifiers")}if(x&&x.length){B.add("separator");B.add("sub:Online");this.args_menu_items=x;this.args_menu_id=C;var y;for(var D=0;D<x.length;++D){var z=x[D];if(z.fClassName&&y&&(y!=z.fClassName)){B.add("separator")}y=z.fClassName;if((z.fChecked===undefined)||(z.fChecked<0)){B.add(z.fName,D,p)}else{B.addchk(z.fChecked,z.fName,D,p)}}B.add("endsub:")}b.CallBack(A)}var q=this.snapid;if(r){q+="#"+r}u._getmenu_callback=s.bind(this,v,q,t);u.SendWebsocket("GETMENU:"+q);setTimeout(u._getmenu_callback,2000)};e.prototype.DeleteAtt=function(){delete this.lineatt;delete this.fillatt;delete this.markeratt};e.prototype.FillAttContextMenu=function(u,t){if(!t){t=""}if(this.lineatt&&this.lineatt.used){u.add("sub:"+t+"Line att");this.AddSizeMenuEntry(u,"width",1,10,1,this.lineatt.width,function(x){this.lineatt.Change(undefined,parseInt(x));this.Redraw()}.bind(this));this.AddColorMenuEntry(u,"color",this.lineatt.color,function(x){this.lineatt.Change(x);this.Redraw()}.bind(this));u.add("sub:style",function(){var x=prompt("Enter line style id (1-solid)",1);if(x==null){return}x=parseInt(x);if(isNaN(x)||!b.Painter.root_line_styles[x]){return}this.lineatt.Change(undefined,undefined,x);this.Redraw()}.bind(this));for(var w=1;w<11;++w){var s=b.Painter.root_line_styles[w];var q="<svg width='100' height='18'><text x='1' y='12' style='font-size:12px'>"+w+"</text><line x1='30' y1='8' x2='100' y2='8' stroke='black' stroke-width='3' stroke-dasharray='"+s+"'></line></svg>";u.addchk((this.lineatt.style==w),q,w,function(x){this.lineatt.Change(undefined,undefined,parseInt(x));this.Redraw()}.bind(this))}u.add("endsub:");u.add("endsub:");if(("excl_side" in this.lineatt)&&(this.lineatt.excl_side!==0)){u.add("sub:Exclusion");u.add("sub:side");for(var r=-1;r<=1;++r){u.addchk((this.lineatt.excl_side==r),r,r,function(x){this.lineatt.ChangeExcl(parseInt(x));this.Redraw()}.bind(this))}u.add("endsub:");this.AddSizeMenuEntry(u,"width",10,100,10,this.lineatt.excl_width,function(x){this.lineatt.ChangeExcl(undefined,parseInt(x));this.Redraw()}.bind(this));u.add("endsub:")}}if(this.fillatt&&this.fillatt.used){u.add("sub:"+t+"Fill att");this.AddColorMenuEntry(u,"color",this.fillatt.colorindx,function(x){this.fillatt.Change(parseInt(x),undefined,this.svg_canvas());this.Redraw()}.bind(this),this.fillatt.kind);u.add("sub:style",function(){var x=prompt("Enter fill style id (1001-solid, 3000..3010)",this.fillatt.pattern);if(x==null){return}x=parseInt(x);if(isNaN(x)){return}this.fillatt.Change(undefined,x,this.svg_canvas());this.Redraw()}.bind(this));var p=[1,1001,3001,3002,3003,3004,3005,3006,3007,3010,3021,3022];var v=b.clone(this.fillatt);if(v.colorindx<=0){v.colorindx=1}for(var w=0;w<p.length;++w){v.Change(undefined,p[w],this.svg_canvas());var q="<svg width='100' height='18'><text x='1' y='12' style='font-size:12px'>"+p[w].toString()+"</text><rect x='40' y='0' width='60' height='18' stroke='none' fill='"+v.color+"'></rect></svg>";u.addchk(this.fillatt.pattern==p[w],q,p[w],function(x){this.fillatt.Change(undefined,parseInt(x),this.svg_canvas());this.Redraw()}.bind(this))}u.add("endsub:");u.add("endsub:")}if(this.markeratt&&this.markeratt.used){u.add("sub:"+t+"Marker att");this.AddColorMenuEntry(u,"color",this.markeratt.color,function(x){this.markeratt.Change(x);this.Redraw()}.bind(this));this.AddSizeMenuEntry(u,"size",0.5,6,0.5,this.markeratt.size,function(x){this.markeratt.Change(undefined,undefined,parseFloat(x));this.Redraw()}.bind(this));u.add("sub:style");var p=[1,2,3,4,5,6,7,8,21,22,23,24,25,26,27,28,29,30,31,32,33,34];var v=b.clone(this.markeratt);for(var w=0;w<p.length;++w){v.Change(undefined,p[w],1.7);v.reset_pos();var q="<svg width='60' height='18'><text x='1' y='12' style='font-size:12px'>"+p[w].toString()+"</text><path stroke='black' fill='"+(v.fill?"black":"none")+"' d='"+v.create(40,8)+"'></path></svg>";u.addchk(this.markeratt.style==p[w],q,p[w],function(x){this.markeratt.Change(undefined,parseInt(x));this.Redraw()}.bind(this))}u.add("endsub:");u.add("endsub:")}};e.prototype.TextAttContextMenu=function(t,r){var s=this.GetObject();if(!s||!("fTextColor" in s)){return}t.add("sub:"+(r?r:"Text"));this.AddColorMenuEntry(t,"color",s.fTextColor,function(w){this.GetObject().fTextColor=parseInt(w);this.Redraw()}.bind(this));var v=[11,12,13,21,22,23,31,32,33],q=["left","centered","right"],p=["bottom","centered","top"];t.add("sub:align");for(var u=0;u<v.length;++u){t.addchk(v[u]==s.fTextAlign,v[u],v[u],function(w){this.GetObject().fTextAlign=parseInt(w);this.Redraw()}.bind(this))}t.add("endsub:");t.add("sub:font");for(var u=1;u<16;++u){t.addchk(u==Math.floor(s.fTextFont/10),u,u,function(w){this.GetObject().fTextFont=parseInt(w)*10+2;this.Redraw()}.bind(this))}t.add("endsub:");t.add("endsub:")};e.prototype.ShowInpsector=function(){b.draw(this.divid,this.GetObject(),"inspect")};e.prototype.FillContextMenu=function(q){var p=this.GetTipName();if(this.GetObject()&&("_typename" in this.GetObject())){p=this.GetObject()._typename+"::"+p}q.add("header:"+p);this.FillAttContextMenu(q);if(q.size()>0){q.add("Inspect",this.ShowInpsector)}return q.size()>0};e.prototype.GetShowStatusFunc=function(){var p=this.pad_painter(),q=b.Painter.ShowStatus;if(p&&(typeof p.ShowStatus==="function")){q=p.ShowStatus}if(q&&(this.enlarge_main("state")==="on")){q=null}return q};e.prototype.ShowObjectStatus=function(){var q=this.GetObject(),p=this.GetShowStatusFunc();if(q&&p){p(this.GetItemName()||q.fName,q.fTitle||q._typename,q._typename)}};e.prototype.FindInPrimitives=function(s){var q=this.pad_painter(true);if((q===null)||(q.pad===null)){return null}if(q.pad.fPrimitives!==null){for(var r=0;r<q.pad.fPrimitives.arr.length;++r){var p=q.pad.fPrimitives.arr[r];if(("fName" in p)&&(p.fName===s)){return p}}}return null};e.prototype.FindPainterFor=function(q,t,u){var p=this.pad_painter(true);var s=(p===null)?null:p.painters;if(s===null){return null}for(var v=0;v<s.length;++v){var r=s[v].GetObject();if(!r){continue}if(q&&(r===q)){return s[v]}if(!t&&!u){continue}if(t&&(r.fName!==t)){continue}if(u&&(r._typename!==u)){continue}return s[v]}return null};e.prototype.ConfigureUserTooltipCallback=function(q,p){if((q===undefined)||(typeof q!=="function")){delete this.UserTooltipCallback;return}if(p===undefined){p=500}this.UserTooltipCallback=q;this.UserTooltipTimeout=p};e.prototype.IsUserTooltipCallback=function(){return typeof this.UserTooltipCallback=="function"};e.prototype.ProvideUserTooltip=function(p){if(!this.IsUserTooltipCallback()){return}if(this.UserTooltipTimeout<=0){return this.UserTooltipCallback(p)}if(typeof this.UserTooltipTHandle!="undefined"){clearTimeout(this.UserTooltipTHandle);delete this.UserTooltipTHandle}if(p==null){return this.UserTooltipCallback(p)}this.UserTooltipTHandle=setTimeout(function(q){delete this.UserTooltipTHandle;this.UserTooltipCallback(q)}.bind(this,p),this.UserTooltipTimeout)};e.prototype.Redraw=function(){};e.prototype.StartTextDrawing=function(r,p,t,s){if(!t){t=this.draw_g}var q=(p==="font")?r:b.Painter.getFontDetails(r,p);t.call(q.func);t.property("draw_text_completed",false).property("text_font",q).property("mathjax_use",false).property("text_factor",0).property("max_text_width",0).property("max_font_size",s)};e.prototype.TextScaleFactor=function(q,p){if(!p){p=this.draw_g}if(q&&(q>p.property("text_factor"))){p.property("text_factor",q)}};e.prototype.GetBoundarySizes=function(r){if(r===null){console.warn("empty node in GetBoundarySizes");return{width:0,height:0}}var q=r.getBoundingClientRect();if(parseFloat(q.width)>0){q=r.getBBox()}var p={width:parseInt(q.width),height:parseInt(q.height)};if("left" in q){p.x=parseInt(q.left);p.y=parseInt(q.right)}else{if("x" in q){p.x=parseInt(q.x);p.y=parseInt(q.y)}}return p};e.prototype.FinishTextDrawing=function(x,u){if(!x){x=this.draw_g}if(x.property("draw_text_completed")){b.CallBack(u);return x.property("max_text_width")}if(u){x.node().text_callback=u}var w=null;if(x.property("mathjax_use")){var s=0;w=x.selectAll(".math_svg");w.each(function(){var y=o.select(this);if(y.node().parentNode!==x.node()){return}if(y.select("svg").empty()){s++}});if(s){return}}var v=this,p=0,t=x.property("text_factor"),q=x.property("text_font"),r=q.size;if((t>0)&&((t<0.9)||(t>1))){q.size=Math.floor(q.size/t);if(x.property("max_font_size")&&(q.size>x.property("max_font_size"))){q.size=x.property("max_font_size")}x.call(q.func);r=q.size}if(w){w.each(function(){var E=o.select(this);if(E.node().parentNode!==x.node()){return}var F=E.select("svg");if(F.empty()){console.log("MathJax SVG ouptut error");return}function A(G){if(!G||(typeof G!=="string")){return null}if(G.indexOf("ex")!==G.length-2){return null}G=parseFloat(G.substr(0,G.length-2));return isNaN(G)?null:G*r*0.5}var C=A(F.attr("width")),z=A(F.attr("height")),B=F.attr("style");if(B&&B.indexOf("vertical-align:")==0&&B.indexOf("ex;")==B.length-3){B=A(B.substr(16,B.length-17))}else{B=null}C=(!C||(C<=0.5))?1:Math.round(C);z=(!z||(z<=0.5))?1:Math.round(z);F.attr("width",C).attr("height",z).attr("style",null);if(!b.nodejs){var D=v.GetBoundarySizes(E.node());C=1.05*D.width;z=1.05*D.height}var y=E.property("_arg");y.valign=B;if(y.scale){p=Math.max(p,C/y.width,z/y.height)}})}if(w){w.each(function(){var H=o.select(this);if(H.node().parentNode!==x.node()){return}var F=H.property("_arg"),z=H.select("svg"),E=parseInt(z.attr("width")),D=parseInt(z.attr("height"));if(!isNaN(D)&&!isNaN(E)){if(p>0){E=E/p;D=D/p;z.attr("width",Math.round(E)).attr("height",Math.round(D))}}else{var B=v.GetBoundarySizes(H.node());E=B.width||E||100;D=B.height||D||10}if((p>0)&&F.valign){F.valign=F.valign/p}if(F.valign===null){F.valign=(r-D)/2}var y={x:1,y:1},C="x",A="y";if(F.rotate==180){y.x=y.y=-1}else{if((F.rotate==270)||(F.rotate==90)){y.x=(F.rotate==270)?-1:1;y.y=-y.x;C="y";A="x"}}if(F.align[0]=="middle"){F[C]+=y.x*(F.width-E)/2}else{if(F.align[0]=="end"){F[C]+=y.x*(F.width-E)}}if(F.align[1]=="middle"){F[A]+=y.y*(F.height-D)/2}else{if(F.align[1]=="bottom"){F[A]+=y.y*(F.height-D)}else{if(F.align[1]=="bottom-base"){F[A]+=y.y*(F.height-D-F.valign)}}}var G="translate("+F.x+","+F.y+")";if(F.rotate){G+=" rotate("+F.rotate+")"}H.attr("transform",G).attr("visibility",null).property("_arg",null)})}x.selectAll(".hidden_text").attr("visibility",null).attr("class",null).each(function(){var z=o.select(this),y=z.property("_arg");z.property("_arg",null);if(!y){return}if(b.nodejs){if(y.scale&&(t>0)){y.box.width=y.box.width/t;y.box.height=y.box.height/t}}else{if(!y.plain){y.box=v.GetBoundarySizes(z.node())}}if(y.width){if(y.align[0]=="middle"){y.x+=y.width/2}else{if(y.align[0]=="end"){y.x+=y.width}}}y.dx=y.dy=0;if(y.plain){z.attr("text-anchor",y.align[0])}else{z.attr("text-anchor","start");y.dx=((y.align[0]=="middle")?-0.5:((y.align[0]=="end")?-1:0))*y.box.width}if(y.height){if(y.align[1].indexOf("bottom")===0){y.y+=y.height}else{if(y.align[1]=="middle"){y.y+=y.height/2}}}if(y.plain){if(y.align[1]=="top"){z.attr("dy",".8em")}else{if(y.align[1]=="middle"){if(b.browser.isIE||b.nodejs){z.attr("dy",".4em")}else{z.attr("dominant-baseline","middle")}}}}else{y.dy=((y.align[1]=="top")?(y.top_shift||1):(y.align[1]=="middle")?(y.mid_shift||0.5):0)*y.box.height}if(!y.rotate){y.x+=y.dx;y.y+=y.dy;y.dx=y.dy=0}var B=(y.x||y.y)?"translate("+Math.round(y.x)+","+Math.round(y.y)+")":"";if(y.rotate){B+=" rotate("+Math.round(y.rotate)+")"}if(y.dx||y.dy){B+=" translate("+Math.round(y.dx)+","+Math.round(y.dy)+")"}if(B){z.attr("transform",B)}if(b.browser.isWebKit&&x.node().insertAdjacentHTML&&y.large_latex){var A=z.node().outerHTML;z.remove();x.node().insertAdjacentHTML("beforeend",A)}});if(!u){u=x.node().text_callback}x.node().text_callback=null;x.property("draw_text_completed",true);b.CallBack(u);return x.property("max_text_width")};e.prototype.produceLatex=function(S,ac,O,U){if(!U){U={lvl:0,x:0,y:0,dx:0,dy:-0.1,fsize:O.font_size,parent:null};O.mainnode=S.node()}function L(ak,ao){var ap,an,aj,w;if(typeof ao=="string"){if(!ak.rect){ak.rect={x:ak.x,y:ak.y,height:0,width:0}}ap=-ak.x;ak.x+=ao.length*O.font.aver_width*ak.fsize;an=ak.x;aj=-(ak.y-ak.fsize*1.1);w=ak.y+ak.fsize*0.1}else{if(!ak.rect){ak.rect=b.extend({},ao)}ap=-ao.x;an=ao.x+ao.width;aj=-ao.y;w=ao.y+ao.height}var al=ak.rect;ap+=al.x;an-=(al.x+al.width);aj+=al.y;w-=(al.y+al.height);if(ap>0){al.x-=ap;al.width+=ap}if(an>0){al.width+=an}if(aj>0){al.y-=aj;al.height+=aj}if(w>0){al.height+=w}if(ak.parent){return L(ak.parent,al)}O.text_rect=al;var s=al.height,am=al.y+al.height/2;if(s>0){O.mid_shift=-am/s||0.001;O.top_shift=-al.y/s||0.001}}function ad(w){if(Math.abs(w)<0.01){return null}if(w==Math.round(w)){return Math.round(w)+"em"}var s=w.toFixed(2);if(s.indexOf("0.")==0){s=s.substr(1)}else{if(s.indexOf("-0.")==0){s="-."+s.substr(3)}}if(s[s.length-1]=="0"){s=s.substr(0,s.length-1)}return s+"em"}function X(aj,am,w){if(b.nodejs||!am||am.empty()){return w||{height:0,width:0}}var ak=[],al=am.node();while(al&&(al!=O.mainnode)){ak.push(al);al=al.parentNode}am.selectAll("tspan").each(function(){ak.push(this)});var s=o.select(O.mainnode).selectAll("tspan");if(s.size()>3){O.large_latex=true}s.each(function(){if(ak.indexOf(this)<0){o.select(this).attr("display","none")}});var an=aj.GetBoundarySizes(O.mainnode);s.each(function(){if(ak.indexOf(this)<0){o.select(this).attr("display",null)}});return an}var B=[{name:"#it{"},{name:"#bf{"},{name:"kern[",arg:"float"},{name:"lower[",arg:"float"},{name:"scale[",arg:"float"},{name:"#color[",arg:"int"},{name:"#font[",arg:"int"},{name:"_{"},{name:"^{"},{name:"#bar{",accent:"\u02C9"},{name:"#hat{",accent:"\u02C6"},{name:"#check{",accent:"\u02C7"},{name:"#acute{",accent:"\u02CA"},{name:"#grave{",accent:"\u02CB"},{name:"#dot{",accent:"\u02D9"},{name:"#ddot{",accent:"\u02BA"},{name:"#tilde{",accent:"\u02DC"},{name:"#slash{",accent:"\u2215"},{name:"#vec{",accent:"\u02ED"},{name:"#frac{"},{name:"#splitline{"},{name:"#sqrt[",arg:"int"},{name:"#sqrt{"},{name:"#sum",special:"\u2211",w:0.8,h:0.9},{name:"#int",special:"\u222B",w:0.3,h:1},{name:"#left[",right:"#right]",braces:"[]"},{name:"#left(",right:"#right)",braces:"()"},{name:"#left{",right:"#right}",braces:"{}"},{name:"#left|",right:"#right|",braces:"||"},{name:"#[]{",braces:"[]"},{name:"#(){",braces:"()"},{name:"#{}{",braces:"{}"},{name:"#||{",braces:"||"}];var t=false,Z,y,u,R,ae,N,H,z=null,A=null;while(ac){Z=ac.length;y=null;u=null;for(ae=0;ae<B.length;++ae){R=ac.indexOf(B[ae].name);if((R>=0)&&(R<Z)){Z=R;y=B[ae]}}if(!y&&!t){var Y=b.Painter.translateLaTeX(ac);if(!U.lvl&&(Y==ac)){return 0}L(U,Y);if(U.accent&&(Y.length==1)){var af=S.append("svg:tspan").text(Y),Q=X(this,af,{width:10000}),W=Math.min(Q.width/U.fsize,0.5);S.append("svg:tspan").attr("dx",ad(U.dx-W)).attr("dy",ad(U.dy-0.2)).text(U.accent);U.dy=0.2;U.dx=Math.max(0.2,W-0.2);U.accent=false}else{S.text(Y)}return true}if(Z>0){var Y=b.Painter.translateLaTeX(ac.substr(0,Z));if(Y.length>0){L(U,Y);S.append("svg:tspan").attr("dx",ad(U.dx)).attr("dy",ad(U.dy)).text(Y);U.dx=U.dy=0}z=null;delete U.special;delete U.next_super_dy}if(!y){return true}ac=ac.substr(Z+y.name.length);H=N=S.append("svg:tspan");A=z;z={lvl:U.lvl+1,x:U.x,y:U.y,fsize:U.fsize,dx:0,dy:0,parent:U};t=true;if(y.arg){R=ac.indexOf("]{");if(R<0){console.log("missing argument for ",y.name);return false}u=ac.substr(0,R);if(y.arg=="int"){u=parseInt(u);if(isNaN(u)){console.log("wrong int argument",ac.substr(0,R));return false}}else{if(y.arg=="float"){u=parseFloat(u);if(isNaN(u)){console.log("wrong float argument",ac.substr(0,R));return false}}}ac=ac.substr(R+2)}var p=U.dy,q=U.dx,P=null,T=1,x="{",G="}";U.dy=U.dx=0;if(y.special){N.attr("dx",ad(q)).attr("dy",ad(p)).text(y.special);q=p=0;U.special=y;var Q=X(this,N);if(Q.width&&Q.height){y.w=Q.width/U.fsize;y.h=Q.height/U.fsize-0.1}continue}if(y.braces){z.left_cont=N.append("svg:tspan");z.left=z.left_cont.append("svg:tspan").text(y.braces[0]);H=N.append("svg:tspan");z.left_rect={y:U.y-U.fsize*1.1,height:U.fsize*1.2,x:U.x,width:U.fsize*0.6};L(U,z.left_rect);z.braces=y;if(y.right){x=y.name;G=y.right}}else{if(y.accent){z.accent=y.accent}else{switch(y.name){case"#color[":if(this.get_color(u)){N.attr("fill",this.get_color(u))}break;case"#kern[":q+=u;break;case"#lower[":U.dy-=u;p+=u;break;case"scale[":T=u;break;case"#font[":b.Painter.getFontDetails(u).setFont(N,"without-size");break;case"#it{":U.italic=true;P=U;while(P=P.parent){if(P.italic!==undefined){U.italic=!P.italic;break}}N.attr("font-style",U.italic?"italic":"normal");break;case"#bf{":U.bold=true;P=U;while(P=P.parent){if(P.bold!==undefined){U.bold=!P.bold;break}}N.attr("font-weight",U.bold?"bold":"normal");break;case"_{":T=0.6;z.script="sub";if(U.special){U.dx=U.special.w;U.dy=-0.7;q-=U.dx;p-=U.dy}else{q+=0.1*T;p+=0.4*T;z.y+=0.4*z.fsize;U.dy=-0.4*T;if(A&&(A.script==="super")){var Q=X(this,A.node,A.rect);z.width_limit=Q.width;q-=(Q.width/z.fsize+0.1)*T}}break;case"^{":T=0.6;z.script="super";if(U.special){U.dx=U.special.w;U.dy=U.special.h;q-=U.dx;p-=U.dy}else{U.dy=0.6*T;if(U.next_super_dy){U.dy-=U.next_super_dy}q+=0.1*T;p-=U.dy;z.y-=0.4*z.fsize;if(A&&(A.script==="sub")){var Q=X(this,A.node,A.rect);z.width_limit=Q.width;q-=(Q.width/z.fsize+0.1)*T}}break;case"#frac{":case"#splitline{":z.first=N;z.two_lines=true;z.need_middle=(y.name=="#frac{");z.x0=z.x;p-=0.6;U.dy=-0.6;break;case"#sqrt{":u=2;case"#sqrt[":z.square_root=N.append("svg:tspan");z.square_root.append("svg:tspan").text((u==3)?"\u221B":((u==4)?"\u221C":"\u221A"));H=N.append("svg:tspan");z.sqrt_rect={y:U.y-U.fsize*1.1,height:U.fsize*1.2,x:0,width:U.fsize*0.7};L(U,z.sqrt_rect);break}}}if(T!==1){N.attr("font-size",Math.round(T*100)+"%");z.fsize*=T;q=q/T;p=p/T}if(U.special&&!z.script){delete U.special}delete U.next_super_dy;z.node=N;while(true){z.x+=q*z.fsize;z.y+=p*z.fsize;N.attr("dx",ad(q)).attr("dy",ad(p));q=p=0;R=-1;ae=1;while((ae!=0)&&(++R<ac.length)){if(ac.indexOf(x,R)===R){ae++}else{if(ac.indexOf(G,R)===R){ae--}}}if(ae!=0){console.log("mismatch with open "+x+" and close "+G+" braces in Latex",ac);return false}var V=ac.substr(0,R);if(!this.produceLatex(H,V,O,z)){return false}U.x=z.x;U.y=z.y;U.dx+=z.dx*z.fsize/U.fsize;U.dy+=z.dy*z.fsize/U.fsize;ac=ac.substr(R+G.length);if(z.width_limit){var Q=X(this,H,z.rect);if(Q.width<z.width_limit){U.dx+=(z.width_limit-Q.width)/U.fsize}delete z.width_limit}if(U.special){var Q=X(this,H,z.rect);U.dx-=Q.width/U.fsize}if(z.square_root){var I=2,T=1,v=0,r=1,aa=X(this,z.square_root,z.sqrt_rect),ah=X(this,H,z.rect);if((ah.height>aa.height)&&(aa.height>0)){r=ah.height/aa.height*1.2;v=((ah.y+ah.height)-(aa.y+aa.height))/U.fsize/r;z.square_root.style("font-size",Math.round(100*r)+"%").attr("dy",ad(v))}I=ah.width/z.fsize/r;var ai="",ag=Math.round(Math.max(I*3,2));while(ag--){ai+="\u203E"}z.square_root.append("svg:tspan").attr("dy",ad(-0.25)).text(ai);z.square_root.append("svg:tspan").attr("dy",ad(0.25-v)).attr("dx",ad(-ai.length/3-0.2)).text("\u2009");break}if(z.braces){var aa=X(this,z.left_cont,z.left_rect),ah=X(this,H,z.rect),r=1,M=0;if(1.2*aa.height<ah.height){r=ah.height/aa.height;M=0;z.left.style("font-size",Math.round(100*r)+"%").attr("dy",ad(M));z.left_cont.append("svg:tspan").attr("dx",ad(-0.2)).attr("dy",ad(-M*r)).text("\u2009");U.next_super_dy=-0.3*r}z.left_rect.y=U.y;z.left_rect.height*=r;L(U,z.left_rect);var F=N.append("svg:tspan").attr("dx",ad(U.dx)).attr("dy",ad(U.dy));U.dx=U.dy=0;if(r!=1){F.append("svg:tspan").attr("dx",ad(-0.2)).text("\u2009")}var ab=F.append("svg:tspan").text(z.braces.braces[1]);if(r!=1){ab.style("font-size",Math.round(100*r)+"%").attr("dy",ad(M));U.dy=-M*r}break}if(z.first&&z.second){var K=X(this,z.first,z.rect1),J=X(this,z.second,z.rect),E=K.width/z.fsize,D=J.width/z.fsize,C=Math.max(D,E);if(z.need_middle){C=Math.round(Math.max(C,1)+0.3);var ai="";while(ai.length<C){ai+="\u2014"}S.append("svg:tspan").attr("dx",ad(-0.5*(C+D))).attr("dy",ad(U.dy-0.2)).text(ai);U.dy=0.2;U.dx=0.2}else{U.dx=0.2;if(D<E){U.dx+=0.5*(E-D)}}if(z.need_middle||O.align[0]=="middle"){z.first.attr("dx",ad(0.5*(C-E)));z.second.attr("dx",ad(-0.5*(D+E)))}else{if(O.align[0]=="end"){if(E<D){z.first.attr("dx",ad(D-E))}z.second.attr("dx",ad(-D))}else{z.second.attr("dx",ad(-E))}}delete z.first;delete z.second}if(!z.two_lines){break}if(ac[0]!="{"){console.log("missing { for second line",ac);return false}ac=ac.substr(1);N=H=S.append("svg:tspan");z.two_lines=false;z.rect1=z.rect;delete z.rect;z.x=z.x0;z.second=N;p=U.dy+1.6;U.dy=-0.4}}return true};e.prototype.DrawText=function(y){var x=y.text||"",v=["start","middle"];if(typeof y.align=="string"){v=y.align.split(";");if(v.length==1){v.push("middle")}}else{if(typeof y.align=="number"){if((y.align/10)>=3){v[0]="end"}else{if((y.align/10)>=2){v[0]="middle"}}if((y.align%10)==0){v[1]="bottom"}else{if((y.align%10)==1){v[1]="bottom-base"}else{if((y.align%10)==3){v[1]="top"}}}}}y.draw_g=y.draw_g||this.draw_g;if(y.latex===undefined){y.latex=1}y.align=v;y.x=y.x||0;y.y=y.y||0;y.scale=y.width&&y.height&&!y.font_size;y.width=y.width||0;y.height=y.height||0;if(b.gStyle.MathJax!==undefined){switch(b.gStyle.MathJax){case 0:b.gStyle.Latex=2;break;case 2:b.gStyle.Latex=4;break;default:b.gStyle.Latex=3}delete b.gStyle.MathJax}if(typeof b.gStyle.Latex=="string"){switch(b.gStyle.Latex){case"off":b.gStyle.Latex=0;break;case"symbols":b.gStyle.Latex=1;break;case"MathJax":case"mathjax":case"math":b.gStyle.Latex=3;break;case"AlwaysMathJax":case"alwaysmath":case"alwaysmathjax":b.gStyle.Latex=4;break;default:var q=parseInt(b.gStyle.Latex);b.gStyle.Latex=(!isNaN(q)&&(q>=0)&&(q<=4))?q:2}}var r=y.draw_g.property("text_font"),p=(y.latex==2);if(y.latex===1){p=(b.gStyle.Latex>3)||((b.gStyle.Latex==3)&&b.Painter.isAnyLatex(x))}if(!p||y.nomathjax){var u=y.draw_g.append("svg:text");if(y.color){u.attr("fill",y.color)}if(y.font_size){u.attr("font-size",y.font_size)}else{y.font_size=r.size}y.font=r;y.plain=!y.latex||(b.gStyle.Latex<2)||(this.produceLatex(u,x,y)===0);if(y.plain){if(y.latex&&(b.gStyle.Latex==1)){x=f.translateLaTeX(x)}u.text(x)}y.box=b.nodejs?(y.text_rect||{height:y.font_size*1.2,width:b.Painter.approxTextWidth(r,x)}):this.GetBoundarySizes(u.node());u.attr("class","hidden_text").attr("visibility","hidden").property("_arg",y);if(y.box.width>y.draw_g.property("max_text_width")){y.draw_g.property("max_text_width",y.box.width)}if(y.scale){this.TextScaleFactor(1.05*y.box.width/y.width,y.draw_g)}if(y.scale){this.TextScaleFactor(1*y.box.height/y.height,y.draw_g)}return y.box.width}var t=b.Painter.translateMath(x,y.latex,y.color,this),z=y.draw_g.append("svg:g").attr("class","math_svg").attr("visibility","hidden").property("_arg",y);y.draw_g.property("mathjax_use",true);if(b.nodejs){if(!b.nodejs_mathjax){b.nodejs_mathjax=require("mathjax-node");b.nodejs_mathjax.config({TeX:{extensions:["color.js"]},SVG:{mtextFontInherit:true,minScaleAdjust:100,matchFontHeight:true,useFontCache:false}});b.nodejs_mathjax.start()}if((t.indexOf("\\(")==0)&&(t.lastIndexOf("\\)")==t.length-2)){t=t.substr(2,t.length-4)}b.nodejs_mathjax.typeset({jsroot_painter:this,jsroot_drawg:y.draw_g,jsroot_fog:z,ex:r.size,math:t,useFontCache:false,useGlobalCache:false,format:"TeX",svg:true},function(B,A){if(!B.errors){A.jsroot_fog.html(B.svg)}else{console.log("MathJax error",A.math);A.jsroot_fog.html("<svg></svg>")}A.jsroot_painter.FinishTextDrawing(A.jsroot_drawg)});return 0}var s=document.createElement("p");o.select(s).style("visibility","hidden").style("overflow","hidden").style("position","absolute").style("font-size",r.size+"px").style("font-family",r.name).html("<mtext>"+t+"</mtext>");document.body.appendChild(s);z.property("_element",s);var w=this;b.AssertPrerequisites("mathjax",function(){MathJax.Hub.Typeset(s,["FinishMathjax",w,y.draw_g,z]);MathJax.Hub.Queue(["FinishMathjax",w,y.draw_g,z])});return 0};e.prototype.FinishMathjax=function(q,s,v){if(s.node().parentNode!==q.node()){return}var r=s.property("_element");if(!r){return}var t=o.select(r).select("svg");if(t.empty()){var u=o.select(r).select("merror");if(u.empty()){return}console.warn("MathJax error",u.text());var p=s.property("_arg");if(p&&p.latex!=2){p.nomathjax=true;s.remove();this.DrawText(p)}else{s.append("svg").attr("width",Math.min(20,u.text().length+5)+"ex").attr("height","3ex").style("vertical-align","0ex").append("text").style("font-size","12px").style("fill","red").attr("x","0").attr("y","2ex").text("Err: "+u.text())}}else{t.remove();s.append(function(){return t.node()})}s.property("_element",null);document.body.removeChild(r);this.FinishTextDrawing(q)};function k(p){e.call(this,p);this.tooltip_enabled=true;this.tooltip_allowed=(b.gStyle.Tooltip>0)}k.prototype=Object.create(e.prototype);k.prototype.GetTipName=function(p){var q=e.prototype.GetTipName.call(this)||"TFrame";if(p){q+=p}return q};k.prototype.Shrink=function(q,p){this.fX1NDC+=q;this.fX2NDC-=p};k.prototype.SetLastEventPos=function(p){this.fLastEventPnt=p};k.prototype.GetLastEventPos=function(){return this.fLastEventPnt};k.prototype.UpdateAttributes=function(q){var r=this.root_pad(),p=this.GetObject();if((this.fX1NDC===undefined)||(q&&!this.modified_NDC)){if(!r){b.extend(this,b.gStyle.FrameNDC)}else{b.extend(this,{fX1NDC:r.fLeftMargin,fX2NDC:1-r.fRightMargin,fY1NDC:r.fBottomMargin,fY2NDC:1-r.fTopMargin})}}if(this.fillatt===undefined){if(p){this.fillatt=this.createAttFill(p)}else{if(r){this.fillatt=r.fFrameFillColor?this.createAttFill(null,r.fFrameFillStyle,r.fFrameFillColor):this.createAttFill(r)}else{this.fillatt=this.createAttFill(null,1001,0)}}if(!p&&(this.fillatt.color=="none")&&this.pad_painter(true)&&this.pad_painter(true).iscan){this.fillatt.color="white"}}if(this.lineatt===undefined){if(r){this.lineatt=new c({fLineColor:r.fFrameLineColor,fLineWidth:r.fFrameLineWidth,fLineStyle:r.fFrameLineStyle})}else{this.lineatt=new c(p?p:"black")}}};k.prototype.SizeChanged=function(){var q=this.root_pad(),p=this.main_painter();if(q){q.fLeftMargin=this.fX1NDC;q.fRightMargin=1-this.fX2NDC;q.fBottomMargin=this.fY1NDC;q.fTopMargin=1-this.fY2NDC;if(p){p.SetRootPadRange(q)}}this.RedrawPad()};k.prototype.Cleanup=function(){if(this.draw_g){this.draw_g.selectAll("*").remove();this.draw_g.on("mousedown",null).on("dblclick",null).on("wheel",null).on("contextmenu",null).property("interactive_set",null)}this.draw_g=null;e.prototype.Cleanup.call(this)};k.prototype.Redraw=function(){this.UpdateAttributes();var C=this.pad_width(),A=this.pad_height(),y=Math.round(C*this.fX1NDC),z=Math.round(C*(this.fX2NDC-this.fX1NDC)),r=Math.round(A*(1-this.fY2NDC)),G=Math.round(A*(this.fY2NDC-this.fY1NDC)),F=false,x=false,E=this.pad_painter();if(E&&E.options){if(E.options.RotateFrame){F=true}if(E.options.FixFrame){x=true}}this.draw_g=this.svg_layer("primitives_layer").select(".root_frame");var u,s;if(this.draw_g.empty()){var K=this.svg_layer("primitives_layer");this.draw_g=K.append("svg:g").attr("class","root_frame");this.draw_g.append("svg:title").text("");u=this.draw_g.append("svg:rect");this.draw_g.append("svg:g").attr("class","grid_layer");s=this.draw_g.append("svg:svg").attr("class","main_layer").attr("x",0).attr("y",0).attr("overflow","hidden");this.draw_g.append("svg:g").attr("class","axis_layer");this.draw_g.append("svg:g").attr("class","upper_layer")}else{u=this.draw_g.select("rect");s=this.draw_g.select(".main_layer")}var t="translate("+y+","+r+")";if(F){t+=" rotate(-90) translate("+-G+",0)";var H=z;z=G;G=H}this.draw_g.property("frame_painter",this).property("draw_x",y).property("draw_y",r).property("draw_width",z).property("draw_height",G).attr("transform",t);u.attr("x",0).attr("y",0).attr("width",z).attr("height",G).call(this.fillatt.func).call(this.lineatt.func);s.attr("width",z).attr("height",G).attr("viewBox","0 0 "+z+" "+G);var B=this.draw_g.select(".interactive_rect");if(b.BatchMode){return B.remove()}this.draw_g.attr("x",y).attr("y",r).attr("width",z).attr("height",G);if(!F&&!x){this.AddDrag({obj:this,only_resize:true,minwidth:20,minheight:20,redraw:this.SizeChanged.bind(this)})}var I=this;function J(){var w=o.mouse(B.node());I.ProcessTooltipEvent({x:w[0],y:w[1],touch:false})}function v(){I.ProcessTooltipEvent(null)}function D(){var w=o.touches(B.node());if(!w||w.length!==1){return I.ProcessTooltipEvent(null)}I.ProcessTooltipEvent({x:w[0][0],y:w[0][1],touch:true})}function q(){I.ProcessTooltipEvent(null)}if(B.empty()){B=this.draw_g.append("rect").attr("class","interactive_rect").style("opacity",0).style("fill","none").style("pointer-events","visibleFill").on("mouseenter",J).on("mousemove",J).on("mouseleave",v);if(b.touches){B.on("touchstart",D).on("touchmove",D).on("touchend",q).on("touchcancel",q)}}B.attr("x",0).attr("y",0).attr("width",z).attr("height",G);var p=this.hints_layer().select(".objects_hints");if(!p.empty()&&this.tooltip_allowed){setTimeout(this.ProcessTooltipEvent.bind(this,p.property("last_point")),10)}};k.prototype.FillContextMenu=function(s){var p=this.main_painter(),r=s.size()==0,q=this.root_pad();if(r){s.add("header:Frame")}else{s.add("separator")}if(p){if(p.zoom_xmin!==p.zoom_xmax){s.add("Unzoom X",p.Unzoom.bind(p,"x"))}if(p.zoom_ymin!==p.zoom_ymax){s.add("Unzoom Y",p.Unzoom.bind(p,"y"))}if(p.zoom_zmin!==p.zoom_zmax){s.add("Unzoom Z",p.Unzoom.bind(p,"z"))}s.add("Unzoom all",p.Unzoom.bind(p,"xyz"));if(q){s.addchk(q.fLogx,"SetLogx",p.ToggleLog.bind(p,"x"));s.addchk(q.fLogy,"SetLogy",p.ToggleLog.bind(p,"y"));if(p.Dimension()==2){s.addchk(q.fLogz,"SetLogz",p.ToggleLog.bind(p,"z"))}}s.add("separator")}s.addchk(this.tooltip_allowed,"Show tooltips",function(){var t=this.frame_painter();if(t){t.tooltip_allowed=!t.tooltip_allowed}});this.FillAttContextMenu(s,r?"":"Frame ");s.add("separator");s.add("Save as frame.png",function(t){var u=this.svg_frame();if(!u.empty()){b.saveSvgAsPng(u.node(),{name:"frame.png"})}});return true};b.saveSvgAsPng=function(q,p,r){b.AssertPrerequisites("savepng",function(){b.saveSvgAsPng(q,p,r)})};k.prototype.hints_layer=function(){var p=this.pad_painter();return p?p.svg_layer("info_layer"):o.select(null)};k.prototype.IsTooltipShown=function(){if(!this.tooltip_allowed||!this.tooltip_enabled){return false}return !(this.hints_layer().select(".objects_hints").empty())};k.prototype.ProcessTooltipEvent=function(ar,D){if(D!==undefined){this.tooltip_enabled=D}var ak=[],aa=0,O=0,V=0,Y=false,an=11,S=3,T=3,B=1.2,u=this.frame_height(),p=this.frame_width(),Z=this.pad_width(),L=this.frame_x(),I=this.pad_painter(true),aq=b.Painter.getFontDetails(160,an),ai=this.GetShowStatusFunc(),au=!this.tooltip_allowed||!this.tooltip_enabled;if((ar===undefined)||(au&&!ai)){ar=null}if(ar&&au){ar.disabled=true}if(I){ak=I.GetTooltips(ar)}if(ar&&ar.touch){an=15}for(var al=0;al<ak.length;++al){var R=ak[al];if(!R){continue}if(!R.lines||(R.lines.length===0)){ak[al]=null;continue}for(var ao=0;ao<al;++ao){var y=ak[ao],W=false;if(!y||(y.lines.length!==R.lines.length)){continue}for(var am=0;am<R.lines.length&&!W;++am){if(y.lines[am]!==R.lines[am]){W=true}}if(!W){ak[al]=null;break}}if(!ak[al]){continue}aa++;for(var am=0;am<R.lines.length;++am){O=Math.max(O,R.lines[am].length)}R.height=Math.round(R.lines.length*an*B+2*S-an*(B-1));if((R.color1!==undefined)&&(R.color1!=="none")){if((V!==0)&&(V!==R.color1)){Y=true}V=R.color1}}var x=this.hints_layer(),v=x.select(".objects_hints");if(ai){var ac="",J="",t="",at="";if(ar){t=Math.round(ar.x)+","+Math.round(ar.y)}var R=null,ag=10000000000,F=null;if(ak&&ak.length>0){for(var ao=0;ao<ak.length;++ao){if(!ak[ao]){continue}if(!R){R=ak[ao]}if(ak[ao].exact&&(!R||!R.exact)){R=ak[ao];break}if(!ar||(ak[ao].x===undefined)||(ak[ao].y===undefined)){continue}var s=(ar.x-ak[ao].x)*(ar.x-ak[ao].x)+(ar.y-ak[ao].y)*(ar.y-ak[ao].y);if(s<ag){ag=s;F=ak[ao]}}}if((!R||!R.exact)&&(ag<400)){R=F}if(R){J=(R.lines&&R.lines.length>1)?R.lines[0]:R.name;ac=R.title||"";at=R.line;if(!at&&R.lines){at=R.lines.slice(1).join(" ")}}ai(J,ac,at,t)}if(!ar||au||(ak.length===0)||(O===0)||(aa>15)){v.remove();return}if(v.empty()){v=x.append("svg:g").attr("class","objects_hints").style("pointer-events","none")}var av={x:0,y:0},ae=this.draw_g.attr("transform");if(!I.iscan){I.CalcAbsolutePosition(this.svg_pad(),av);ae="translate("+av.x+","+av.y+") "+ae}v.attr("transform",ae);v.property("last_point",ar);var G=v.property("viewmode");if(G===undefined){G=""}var ap=0,M=ar.x+15;if(aa>1){var K=0.5,Q=0.5;if(G=="left"){Q=0.7}else{if(G=="right"){K=0.3}}if(ar.x<=K*p){G="left";M=20}else{if(ar.x>=Q*p){G="right";M=p-60}else{M=v.property("startx")}}}else{G="single"}if(G!==v.property("viewmode")){v.property("viewmode",G);v.selectAll("*").remove()}var H=10,E=10,w=-1111,ah=-1111,N=-av.y,U=this.pad_height("")-this.draw_g.property("draw_y")-av.y;function q(ax){for(var aw=0;(aw<ak.length)&&(ax<U);++aw){var r=ak[aw];if(!r){continue}if((r.y>=ax-5)&&(r.y<=ax+r.height+5)){ax=r.y+10;aw=-1}}return ax}for(var al=0;al<ak.length;++al){var R=ak[al],P=v.select(".painter_hint_"+al);if(R===null){P.remove();continue}var ab=P.empty();if(ab){P=v.append("svg:svg").attr("class","painter_hint_"+al).attr("opacity",0).style("overflow","hidden").style("pointer-events","none")}if(G=="single"){H=ar.touch?(ar.y-R.height-5):Math.min(ar.y+15,U-R.height-3)}else{E=q(E);if((w===-1111)&&(ah===-1111)){w=ah=R.x}w=Math.min(w,R.x);ah=Math.min(ah,R.x)}P.attr("x",M).attr("y",H).property("curry",H).property("gapy",E);H+=R.height+5;E+=R.height+5;if(!ab){P.selectAll("*").remove()}P.attr("width",60).attr("height",R.height);var aj=P.append("rect").attr("x",0).attr("y",0).attr("width",60).attr("height",R.height).attr("fill","lightgrey").style("pointer-events","none");if(aa>1){var A=Y?R.color1:R.color2;if((A!==undefined)&&(A!=="none")){aj.attr("stroke",A).attr("stroke-width",R.exact?3:1)}}if(R.lines!=null){for(var am=0;am<R.lines.length;am++){if(R.lines[am]!==null){var C=P.append("svg:text").attr("text-anchor","start").attr("x",T).attr("y",S+am*an*B).attr("dy",".8em").attr("fill","black").style("pointer-events","none").call(aq.func).text(R.lines[am]);var z=this.GetBoundarySizes(C.node());ap=Math.max(ap,z.width)}}}function ad(){return function(ax,aw,r){return function(ay){return ay<0.8?"0":(ay-0.8)*5}}}if(ab){if(b.gStyle.TooltipAnimation>0){P.transition().duration(b.gStyle.TooltipAnimation).attrTween("opacity",ad())}else{P.attr("opacity",1)}}}ap+=2*T;var af=v.selectAll("svg");if((G=="right")&&(M+ap>p-20)){M=p-ap-20;af.attr("x",M)}if((G=="single")&&(M+ap>Z-L)&&(M>ap+20)){M-=(ap+20);af.attr("x",M)}if((G!=="single")&&(E<U)&&(E!==H)){if((w<=M+ap+5)&&(ah>=M-5)){af.attr("y",function(){return o.select(this).property("gapy")})}}else{if((G!=="single")&&(H>U)){var X=Math.max((U-H-10),N);if(X<0){af.attr("y",function(){return o.select(this).property("curry")+X})}}}if(ap>10){af.attr("width",ap).select("rect").attr("width",ap)}v.property("startx",M)};k.prototype.ProcessFrameClick=function(t){var p=this.pad_painter(true);if(!p){return}t.painters=true;t.disabled=true;var s=p.GetTooltips(t),r=null;for(var q=0;(q<s.length)&&!r;++q){if(s[q]&&s[q].exact){r=s[q]}}p.SelectObjectPainter(r?r.painter:this,t)};f.drawFrame=function(s,r){var q=new k(r);q.SetDivId(s,2);q.Redraw();return q.DrawingReady()};function d(r,p){e.call(this,r);this.pad=r;this.iscan=p;this.this_pad_name="";if(!this.iscan&&(r!==null)&&("fName" in r)){this.this_pad_name=r.fName.replace(" ","_");var q=new RegExp("^[A-Za-z][A-Za-z0-9_]*$");if(!q.test(this.this_pad_name)){this.this_pad_name="jsroot_pad_"+b.id_counter++}}this.painters=[];this.has_canvas=true}d.prototype=Object.create(e.prototype);d.prototype.Cleanup=function(){for(var q=0;q<this.painters.length;++q){this.painters[q].Cleanup()}var p=this.svg_pad(this.this_pad_name);if(!p.empty()){p.property("pad_painter",null);p.property("mainpainter",null);if(!this.iscan){p.remove()}}this.painters=[];this.pad=null;this.this_pad_name="";this.has_canvas=false;e.prototype.Cleanup.call(this)};d.prototype.CleanPrimitives=function(q){if(!q||(typeof q!=="function")){return}for(var r=this.painters.length-1;r>=0;--r){var s=this.painters[r];if(q(s)){s.Cleanup();this.painters.splice(r--,1)}}};d.prototype.GetCurrentPrimitiveIndx=function(){return this._current_primitive_indx||0};d.prototype.GetNumPrimitives=function(){return this._num_primitives||1};d.prototype.ForEachPainterInPad=function(q,s){q(this);for(var p=0;p<this.painters.length;++p){var r=this.painters[p];if(typeof r.ForEachPainterInPad==="function"){r.ForEachPainterInPad(q,s)}else{if(!s){q(r)}}}};d.prototype.ButtonSize=function(p){return Math.round((!p?1:p)*(this.iscan||!this.has_canvas?16:12))};d.prototype.IsTooltipAllowed=function(){var p=undefined;this.ForEachPainterInPad(function(q){if((p===undefined)&&(q.tooltip_allowed!==undefined)){p=q.tooltip_allowed}});return p!==undefined?p:false};d.prototype.SetTooltipAllowed=function(p){this.ForEachPainterInPad(function(q){if(q.tooltip_allowed!==undefined){q.tooltip_allowed=p}})};d.prototype.SelectObjectPainter=function(p){};d.prototype.CreateCanvasSvg=function(p,v){var t=null,s=null,w=5,u=null;if(p>0){if(this._fixed_size){return(p>1)}s=this.svg_canvas();if(s.empty()){return false}t=s.property("height_factor");u=this.check_main_resize(p,null,t);if(!u.changed){return false}}else{var q=this.select_main();if(q.style("position")=="static"){q.style("position","relative")}s=q.append("svg").attr("class","jsroot root_canvas").property("pad_painter",this).property("mainpainter",null).property("current_pad","").property("redraw_by_resize",false);s.append("svg:title").text("ROOT canvas");var r=s.append("svg:rect").attr("class","canvas_fillrect").attr("x",0).attr("y",0);if(!b.BatchMode){r.style("pointer-events","visibleFill").on("dblclick",this.EnlargePad.bind(this)).on("click",this.SelectObjectPainter.bind(this,this)).on("mouseenter",this.ShowObjectStatus.bind(this))}s.append("svg:g").attr("class","primitives_layer");s.append("svg:g").attr("class","info_layer");s.append("svg:g").attr("class","btns_layer");if(b.gStyle.ContextMenu){s.select(".canvas_fillrect").on("contextmenu",this.ShowContextMenu.bind(this))}t=0.66;if(this.pad&&this.pad.fCw&&this.pad.fCh&&(this.pad.fCw>0)){t=this.pad.fCh/this.pad.fCw;if((t<0.1)||(t>10)){t=0.66}}if(this._fixed_size){q.style("overflow","auto");u={width:this.pad.fCw,height:this.pad.fCh}}else{u=this.check_main_resize(2,v,t)}}if(!this.fillatt||!this.fillatt.changed){this.fillatt=this.createAttFill(this.pad)}if((u.width<=w)||(u.height<=w)){s.style("display","none");console.warn("Hide canvas while geometry too small w=",u.width," h=",u.height);u.width=200;u.height=100}else{s.style("display",null)}if(this._fixed_size){s.attr("x",0).attr("y",0).attr("width",u.width).attr("height",u.height).style("position","absolute")}else{s.attr("x",0).attr("y",0).style("width","100%").style("height","100%").style("position","absolute").style("left",0).style("top",0).style("right",0).style("bottom",0)}s.attr("viewBox","0 0 "+u.width+" "+u.height).attr("preserveAspectRatio","none").property("height_factor",t).property("draw_x",0).property("draw_y",0).property("draw_width",u.width).property("draw_height",u.height);s.select(".canvas_fillrect").attr("width",u.width).attr("height",u.height).call(this.fillatt.func);this.svg_layer("btns_layer").attr("transform","translate(2,"+(u.height-this.ButtonSize(1.25))+")").attr("display",s.property("pad_enlarged")?"none":null);return true};d.prototype.EnlargePad=function(){if(o.event){o.event.preventDefault();o.event.stopPropagation()}var q=this.svg_canvas(),p=q.property("pad_enlarged");if(this.iscan||!this.has_canvas||(!p&&!this.HasObjectsToDraw()&&!this.painters)){if(this._fixed_size){return}if(!this.enlarge_main("toggle")){return}if(this.enlarge_main("state")=="off"){q.property("pad_enlarged",null)}}else{if(!p){this.enlarge_main(true);q.property("pad_enlarged",this.pad)}else{if(p===this.pad){this.enlarge_main(false);q.property("pad_enlarged",null)}else{console.error("missmatch with pad double click events")}}}this.CheckResize({force:true})};d.prototype.CreatePadSvg=function(E){if(!this.has_canvas){this.CreateCanvasSvg(E?2:0);return true}var D=this.svg_canvas(),p=D.property("draw_width"),C=D.property("draw_height"),s=D.property("pad_enlarged"),B=!s||(s===this.pad),A=Math.round(this.pad.fAbsWNDC*p),u=Math.round(this.pad.fAbsHNDC*C),z=Math.round(this.pad.fAbsXlowNDC*p),v=Math.round(C*(1-this.pad.fAbsYlowNDC))-u,q=null,t=null,r=null;if(s===this.pad){A=p;u=C;z=v=0}if(E){q=this.svg_pad(this.this_pad_name);t=q.select(".root_pad_border");r=this.svg_layer("btns_layer",this.this_pad_name)}else{q=D.select(".primitives_layer").append("g").attr("class","root_pad").attr("pad",this.this_pad_name).property("pad_painter",this).property("mainpainter",null);t=q.append("svg:rect").attr("class","root_pad_border");q.append("svg:g").attr("class","primitives_layer");r=q.append("svg:g").attr("class","btns_layer");if(b.gStyle.ContextMenu){t.on("contextmenu",this.ShowContextMenu.bind(this))}if(!b.BatchMode){t.attr("pointer-events","visibleFill").on("dblclick",this.EnlargePad.bind(this)).on("click",this.SelectObjectPainter.bind(this,this)).on("mouseenter",this.ShowObjectStatus.bind(this))}}if(!this.fillatt||!this.fillatt.changed){this.fillatt=this.createAttFill(this.pad)}if(!this.lineatt||!this.lineatt.changed){this.lineatt=new c(this.pad);if(this.pad.fBorderMode==0){this.lineatt.color="none"}}q.attr("transform","translate("+z+","+v+")").attr("display",B?null:"none").property("draw_x",z).property("draw_y",v).property("draw_width",A).property("draw_height",u);t.attr("x",0).attr("y",0).attr("width",A).attr("height",u).call(this.fillatt.func).call(this.lineatt.func);if(q.property("can3d")===1){this.select_main().select(".draw3d_"+this.this_pad_name).style("display",B?"":"none")}r.attr("transform","translate("+(A-(r.property("nextx")||0)-this.ButtonSize(1.25))+","+(u-this.ButtonSize(1.25))+")");return B};d.prototype.CheckSpecial=function(s){if(!s||(s._typename!=="TObjArray")){return false}if(s.name=="ListOfColors"){if(!this.options||this.options.GlobalColors){f.adoptRootColors(s)}if(this.options&&this.options.LocalColors){this.root_colors=[];for(var t=0;t<b.Painter.root_colors.length;++t){this.root_colors[t]=b.Painter.root_colors[t]}f.extendRootColors(this.root_colors,s)}return true}if(s.name=="CurrentColorPalette"){var p=[],r=false;for(var t=0;t<s.arr.length;++t){var q=s.arr[t];if(q&&(q._typename=="TColor")){p[t]=f.MakeColorRGB(q)}else{console.log("Missing color with index "+t);r=true}}if(!this.options||(!r&&!this.options.IgnorePalette)){this.CanvasPalette=new n(p)}return true}return false};d.prototype.CheckSpecialsInPrimitives=function(r){var p=r?r.fPrimitives:null;if(!p){return}for(var q=0;q<p.arr.length;++q){if(this.CheckSpecial(p.arr[q])){p.arr.splice(q,1);p.opt.splice(q,1);q--}}};d.prototype.RemovePrimitive=function(q){if(!this.pad||!this.pad.fPrimitives){return}var p=this.pad.fPrimitives.arr.indexOf(q);if(p>=0){this.pad.fPrimitives.RemoveAt(p)}};d.prototype.FindPrimitive=function(t,s,p){if(!this.pad||!this.pad.fPrimitives){return null}for(var q=0;q<this.pad.fPrimitives.arr.length;q++){var r=this.pad.fPrimitives.arr[q];if((t!==null)&&(r!==t)){continue}if((s!==undefined)&&(s!==null)){if(r._typename!==s){continue}}if((p!==undefined)&&(p!==null)){if(r.fName!==p){continue}}return r}return null};d.prototype.HasObjectsToDraw=function(){if(!this.pad||!this.pad.fPrimitives){return false}for(var p=0;p<this.pad.fPrimitives.arr.length;++p){if(this.pad.fPrimitives.arr[p]&&this.pad.fPrimitives.arr[p]._typename!="TPad"){return true}}return false};d.prototype.DrawPrimitives=function(q,s,p){if(q===0){this._doing_pad_draw=true;this._num_primitives=this.pad&&this.pad.fPrimitives?this.pad.fPrimitives.arr.length:0}while(true){if(p){p._primitive=true}if(!this.pad||(q>=this.pad.fPrimitives.arr.length)){delete this._doing_pad_draw;return b.CallBack(s)}var r={func:this.DrawPrimitives.bind(this,q+1,s)};this._current_primitive_indx=q;p=b.draw(this.divid,this.pad.fPrimitives.arr[q],this.pad.fPrimitives.opt[q],r);if(!r.completed){return}q++}};d.prototype.GetTooltips=function(r){var p=[],q=[];if(this.painters!==null){this.painters.forEach(function(s){if("ProcessTooltip" in s){p.push(s)}})}if(r){r.nproc=p.length}p.forEach(function(s){var t=s.ProcessTooltip(r);q.push(t);if(t&&r&&r.painters){t.painter=s}});return q};d.prototype.FillContextMenu=function(s){if(this.pad){s.add("header: "+this.pad._typename+"::"+this.pad.fName)}else{s.add("header: Canvas")}var r=this.IsTooltipAllowed();s.addchk(r,"Show tooltips",this.SetTooltipAllowed.bind(this,!r));if(!this._websocket){function p(v){this.pad[v]=this.pad[v]?0:1;var u=this.svg_pad(this.this_pad_name).property("mainpainter");if(u&&(typeof u.DrawGrids=="function")){u.DrawGrids()}}function q(v){this.pad[v.substr(1)]=parseInt(v[0]);var u=this.svg_pad(this.this_pad_name).property("mainpainter");if(u&&(typeof u.DrawAxes=="function")){u.DrawAxes()}}s.addchk(this.pad.fGridx,"Grid x","fGridx",p);s.addchk(this.pad.fGridy,"Grid y","fGridy",p);s.add("sub:Ticks x");s.addchk(this.pad.fTickx==0,"normal","0fTickx",q);s.addchk(this.pad.fTickx==1,"ticks on both sides","1fTickx",q);s.addchk(this.pad.fTickx==2,"labels up","2fTickx",q);s.add("endsub:");s.add("sub:Ticks y");s.addchk(this.pad.fTicky==0,"normal","0fTicky",q);s.addchk(this.pad.fTicky==1,"ticks on both side","1fTicky",q);s.addchk(this.pad.fTicky==2,"labels right","2fTicky",q);s.add("endsub:");this.FillAttContextMenu(s)}s.add("separator");if(this.ToggleEventStatus){s.addchk(this.HasEventStatus(),"Event status",this.ToggleEventStatus.bind(this))}if(this.enlarge_main()||(this.has_canvas&&this.HasObjectsToDraw())){s.addchk((this.enlarge_main("state")=="on"),"Enlarge "+(this.iscan?"canvas":"pad"),this.EnlargePad.bind(this))}var t=this.this_pad_name;if(t.length===0){t=this.iscan?"canvas":"pad"}t+=".png";s.add("Save as "+t,t,this.SaveAsPng.bind(this,false));return true};d.prototype.ShowContextMenu=function(r){if(!r){var q=o.mouse(this.svg_pad(this.this_pad_name).node());if(q&&(q.length==2)&&(q[0]>0)&&(q[0]<10)&&(q[1]>0)&&q[1]<10){return}o.event.stopPropagation();o.event.preventDefault();r=o.event;var p=this.frame_painter();if(p){p.SetLastEventPos()}}b.Painter.createMenu(this,function(s){s.painter.FillContextMenu(s);s.painter.FillObjectExecMenu(s,"",function(){s.show(r)})})};d.prototype.Redraw=function(p){if(this._doing_pad_draw){return console.log("Prevent redrawing",this.pad.fName)}var s=true;if(this.iscan){this.CreateCanvasSvg(2)}else{s=this.CreatePadSvg(true)}for(var q=0;q<this.painters.length;++q){var r=this.painters[q];if(s||r.this_pad_name){r.Redraw(p)}}};d.prototype.NumDrawnSubpads=function(){if(this.painters===undefined){return 0}var p=0;for(var q=0;q<this.painters.length;++q){var r=this.painters[q].GetObject();if(r&&(r._typename==="TPad")){p++}}return p};d.prototype.RedrawByResize=function(){if(this.access_3d_kind()===1){return true}for(var p=0;p<this.painters.length;++p){if(typeof this.painters[p].RedrawByResize==="function"){if(this.painters[p].RedrawByResize()){return true}}}return false};d.prototype.CheckCanvasResize=function(q,r){if(!this.iscan&&this.has_canvas){return false}if(q&&(typeof q==="object")&&q.force){r=true}if(!r){r=this.RedrawByResize()}var s=this.CreateCanvasSvg(r?2:1,q);if(s){for(var p=0;p<this.painters.length;++p){this.painters[p].Redraw(r?false:true)}}return s};d.prototype.UpdateObject=function(u){if(!u){return false}this.pad.fBits=u.fBits;this.pad.fTitle=u.fTitle;this.pad.fGridx=u.fGridx;this.pad.fGridy=u.fGridy;this.pad.fTickx=u.fTickx;this.pad.fTicky=u.fTicky;this.pad.fLogx=u.fLogx;this.pad.fLogy=u.fLogy;this.pad.fLogz=u.fLogz;this.pad.fUxmin=u.fUxmin;this.pad.fUxmax=u.fUxmax;this.pad.fUymin=u.fUymin;this.pad.fUymax=u.fUymax;this.pad.fLeftMargin=u.fLeftMargin;this.pad.fRightMargin=u.fRightMargin;this.pad.fBottomMargin=u.fBottomMargin;this.pad.fTopMargin=u.fTopMargin;this.pad.fFillColor=u.fFillColor;this.pad.fFillStyle=u.fFillStyle;this.pad.fLineColor=u.fLineColor;this.pad.fLineStyle=u.fLineStyle;this.pad.fLineWidth=u.fLineWidth;if(this.iscan){this.CheckSpecialsInPrimitives(u)}var r=this.frame_painter();if(r){r.UpdateAttributes(!r.modified_NDC)}if(!u.fPrimitives){return false}var s=false,t=0;for(var v=0;v<u.fPrimitives.arr.length;++v){while(t<this.painters.length){var q=this.painters[t++];if(!q._primitive){continue}if(q.UpdateObject(u.fPrimitives.arr[v])){s=true}break}}return s};d.prototype.DrawNextSnap=function(t,u,q,B){if(u===0){this._doing_pad_draw=true;this._snaps_map={};this._num_primitives=t?t.length:0}while(true){if(B&&t&&t[u]&&B.snapid===undefined){if(this.painters.indexOf(B)<0){this.painters.push(B)}B.snapid=t[u].fObjectID}B=null;++u;if(!t||u>=t.length){delete this._doing_pad_draw;delete this._snaps_map;return b.CallBack(q,this)}var r=t[u],z=r.fObjectID,p=this._snaps_map[z];if(p){p++}else{p=1}this._snaps_map[z]=p;this._current_primitive_indx=u;for(var s=0;s<this.painters.length;++s){if(this.painters[s].snapid===z){if(--p===0){B=this.painters[s];break}}}var A=this.DrawNextSnap.bind(this,t,u,q);if(B){if(r.fKind===1){if(B.UpdateObject(r.fSnapshot,r.fOption)){B.Redraw()}continue}if(r.fKind===2){if(B.UpdateObject(r.fSnapshot)){B.Redraw()}continue}if(r.fKind===3){return B.RedrawPadSnap(r,A)}continue}if(r.fKind===4){this.CheckSpecial(r.fSnapshot);continue}if(r.fKind===3){if(r.fPrimitives._typename){alert("Problem in JSON I/O with primitves for sub-pad");r.fPrimitives=[r.fPrimitives]}var y=r.fPrimitives[0].fSnapshot;y.fPrimitives=null;var w=new d(y,false);w.DecodeOptions(r.fPrimitives[0].fOption);w.SetDivId(this.divid);w.snapid=r.fObjectID;w.CreatePadSvg();if(w.MatchObjectType("TPad")&&r.fPrimitives.length>1){w.AddButton(b.ToolbarIcons.camera,"Create PNG","PadSnapShot");w.AddButton(b.ToolbarIcons.circle,"Enlarge pad","EnlargePad");if(b.gStyle.ContextMenu){w.AddButton(b.ToolbarIcons.question,"Access context menus","PadContextMenus")}}var x=w.CurrentPadName(w.this_pad_name);w.DrawNextSnap(r.fPrimitives,0,function(){w.CurrentPadName(x);A(w)});return}var v={func:A};if(r.fKind===1){B=b.draw(this.divid,r.fSnapshot,r.fOption,v)}if(r.fKind===2){B=b.draw(this.divid,r.fSnapshot,r.fOption,v)}if(!v.completed){return}}};d.prototype.FindSnap=function(r){if(this.snapid===r){return this}if(!this.painters){return null}for(var p=0;p<this.painters.length;++p){var q=this.painters[p];if(typeof q.FindSnap==="function"){q=q.FindSnap(r)}else{if(q.snapid!==r){q=null}}if(q){return q}}return null};d.prototype.RedrawPadSnap=function(s,q){if(!s||!s.fPrimitives){return}var v=s.fPrimitives[0].fSnapshot;v.fPrimitives=null;if(this.snapid===undefined){this.snapid=s.fPrimitives[0].fObjectID;this.draw_object=v;this.pad=v;if(this.batch_mode&&(!v.fCw||!v.fCh)){v.fCw=900;v.fCh=700}if(!v.fCw||!v.fCh){this._fixed_size=false}this.CreateCanvasSvg(0);this.SetDivId(this.divid);this.AddButton(b.ToolbarIcons.camera,"Create PNG","CanvasSnapShot","Ctrl PrintScreen");if(b.gStyle.ContextMenu){this.AddButton(b.ToolbarIcons.question,"Access context menus","PadContextMenus")}if(this.enlarge_main("verify")){this.AddButton(b.ToolbarIcons.circle,"Enlarge canvas","EnlargePad")}this.DrawNextSnap(s.fPrimitives,0,q);return}this.UpdateObject(v);if(this.iscan){this.CreateCanvasSvg(2)}else{this.CreatePadSvg(true)}var r=false;for(var t=0;t<this.painters.length;++t){var p=this.painters[t];if(p.snapid===undefined){continue}for(var u=1;u<s.fPrimitives.length;++u){if(s.fPrimitives[u].fObjectID===p.snapid){p=null;r=true;break}}if(p){this.painters.splice(t--,1);p.Cleanup()}}if(!r){var w=this.svg_pad(this.this_pad_name);if(w&&!w.empty()){w.property("mainpainter",null)}for(var t=0;t<this.painters.length;++t){this.painters[t].Cleanup()}this.painters=[]}var x=this,y=x.CurrentPadName(x.this_pad_name);x.DrawNextSnap(s.fPrimitives,0,function(){x.CurrentPadName(y);q(x)})};d.prototype.CreateImage=function(q,p){if(q=="svg"){b.CallBack(p,btoa(this.CreateSvg()))}else{if((q=="png")||(q=="jpeg")){this.ProduceImage(true,"any."+q,function(s){var r=s.toDataURL("image/"+q),t=r.indexOf("base64,");b.CallBack(p,(t>0)?r.substr(t+7):"")})}else{b.CallBack(p,"")}}};d.prototype.GetAllRanges=function(){var q="";if(this.snapid){q=this.GetPadRanges();if(q){q="id="+this.snapid+":"+q+";"}}for(var p=0;p<this.painters.length;++p){if(typeof this.painters[p].GetAllRanges=="function"){q+=this.painters[p].GetAllRanges()}}return q};d.prototype.GetPadRanges=function(){var y=this.main_painter(true,this.this_pad_name),u=this.svg_pad(this.this_pad_name),z=this.svg_frame(this.this_pad_name);if(!y){return""}var s=y.scale_xmin+":"+y.scale_xmax+":"+y.scale_ymin+":"+y.scale_ymax;if(z.empty()||u.empty()){return s+":"+s}var q="";var C=function(p){return p},v=function(p){return Math.pow(10,p)};var w=y.logx?b.log10:C,D=y.logx?v:C;var x=(w(y.scale_xmax)-w(y.scale_xmin))/z.property("draw_width");var t=w(y.scale_xmin)-x*z.property("draw_x");var r=t+x*u.property("draw_width");q+=D(t)+":"+D(r);w=y.logy?b.log10:C;D=y.logy?v:C;var x=(w(y.scale_ymax)-w(y.scale_ymin))/z.property("draw_height");var A=w(y.scale_ymax)+x*z.property("draw_y");var B=A-x*u.property("draw_height");q+=":"+D(B)+":"+D(A);return s+":"+q};d.prototype.ItemContextMenu=function(q){var t=this.svg_pad(this.this_pad_name).node().getBoundingClientRect();var u={clientX:t.left+10,clientY:t.top+10};if(q=="pad"){return setTimeout(this.ShowContextMenu.bind(this,u),50)}var p=null,s;switch(q){case"xaxis":case"yaxis":case"zaxis":p=this.main_painter();s=q[0];break;case"frame":p=this.frame_painter();break;default:var r=parseInt(q);if(!isNaN(r)){p=this.painters[r]}}if(!p||(typeof p.FillContextMenu!=="function")){return}b.Painter.createMenu(p,function(v){if(p.FillContextMenu(v,s)){setTimeout(v.show.bind(v,u),50)}})};d.prototype.CreateSvg=function(){var p=this.svg_canvas(),q=p.html();q=q.replace(/url\(\&quot\;\#(\w+)\&quot\;\)/g,"url(#$1)").replace(/ class=\"\w*\"/g,"").replace(/<g transform=\"translate\(\d+\,\d+\)\"><\/g>/g,"").replace(/<g><\/g>/g,"");q='<svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none" viewBox="0 0 '+p.property("draw_width")+" "+p.property("draw_height")+'" width="'+p.property("draw_width")+'" height="'+p.property("draw_height")+'">'+q+"</svg>";return q};d.prototype.SaveAsPng=function(q,p){if(!p){p=this.this_pad_name;if(p.length===0){p=this.iscan?"canvas":"pad"}p+=".png"}this.ProduceImage(q,p)};d.prototype.ProduceImage=function(u,q,t){var s=u?this.svg_canvas():this.svg_pad(this.this_pad_name);if(s.empty()){return}var p=u?this.pad_painter():this;document.body.style.cursor="wait";p.ForEachPainterInPad(function(w){var v=w.main_painter(true,w.this_pad_name);if(!v||(typeof v.Render3D!=="function")){return}var y=v.access_3d_kind();if((y!==1)&&(y!==2)){return}var z=v.size_for_3d(3);var x=v.Render3D(-1111);v.insert("g",".primitives_layer").attr("class","temp_saveaspng").attr("transform","translate("+z.x+","+z.y+")").node().appendChild(x)},true);var r={name:q,removeClass:"btns_layer"};if(t){r.result="canvas"}b.saveSvgAsPng(s.node(),r,function(v){if(v===null){console.warn("problem when produce image")}s.selectAll(".temp_saveaspng").remove();document.body.style.cursor="auto";if(t){b.CallBack(t,v)}})};d.prototype.PadButtonClick=function(p){if(p=="CanvasSnapShot"){return this.SaveAsPng(true)}if(p=="EnlargePad"){return this.EnlargePad()}if(p=="PadSnapShot"){return this.SaveAsPng(false)}if(p=="PadContextMenus"){o.event.preventDefault();o.event.stopPropagation();if(b.Painter.closeMenu()){return}var s=this,u=o.event;b.Painter.createMenu(s,function(A){A.add("header:Menus");if(s.iscan){A.add("Canvas","pad",s.ItemContextMenu)}else{A.add("Pad","pad",s.ItemContextMenu)}if(s.frame_painter()){A.add("Frame","frame",s.ItemContextMenu)}var v=s.main_painter();if(v){A.add("X axis","xaxis",s.ItemContextMenu);A.add("Y axis","yaxis",s.ItemContextMenu);if((typeof v.Dimension==="function")&&(v.Dimension()>1)){A.add("Z axis","zaxis",s.ItemContextMenu)}}if(s.painters&&(s.painters.length>0)){A.add("separator");var y=[];for(var B=0;B<s.painters.length;++B){var w=s.painters[B];var z=w?w.GetObject():null;if(!z||(y.indexOf(z)>=0)){continue}var x=("_typename" in z)?(z._typename+"::"):"";if("fName" in z){x+=z.fName}if(x.length==0){x="item"+B}A.add(x,B,s.ItemContextMenu)}}A.show(u)});return}var r=false;for(var t=0;t<this.painters.length;++t){var q=this.painters[t];if(typeof q.PadButtonClick=="function"){q.PadButtonClick(p)}if(!r&&(typeof q.ButtonClick=="function")){r=q.ButtonClick(p)}}};d.prototype.FindButton=function(r){var q=this.svg_layer("btns_layer",this.this_pad_name);if(q.empty()){return}var p="";q.selectAll("svg").each(function(){if(o.select(this).attr("key")===r){p=o.select(this).attr("name")}});return p};d.prototype.toggleButtonsVisibility=function(s){var t=this.svg_layer("btns_layer",this.this_pad_name),q=t.select("[name='Toggle']");if(q.empty()){return}var r=q.property("buttons_state");if(q.property("timout_handler")){if(s!=="timeout"){clearTimeout(q.property("timout_handler"))}q.property("timout_handler",null)}var p=false;switch(s){case"enable":p=true;break;case"enterbtn":return;case"timeout":p=false;break;case"toggle":r=!r;q.property("buttons_state",r);p=r;break;case"disable":case"leavebtn":if(!r){q.property("timout_handler",setTimeout(this.toggleButtonsVisibility.bind(this,"timeout"),500))}return}t.selectAll("svg").each(function(){if(this===q.node()){return}o.select(this).style("display",p?"":"none")})};d.prototype.AddButton=function(q,y,r,t){if(!b.gStyle.ToolBar){return}var v=this.svg_layer("btns_layer",this.this_pad_name);if(v.empty()){return}if(!v.select("[name='"+r+"']").empty()){return}var w=this.iscan||!this.has_canvas,p;var u=v.property("nextx");if(!u){p=b.ToolbarIcons.CreateSVG(v,b.ToolbarIcons.rect,this.ButtonSize(),"Toggle tool buttons");p.attr("name","Toggle").attr("x",0).attr("y",0).attr("normalx",0).property("buttons_state",(b.gStyle.ToolBar!=="popup")).on("click",this.toggleButtonsVisibility.bind(this,"toggle")).on("mouseenter",this.toggleButtonsVisibility.bind(this,"enable")).on("mouseleave",this.toggleButtonsVisibility.bind(this,"disable"));u=w?this.ButtonSize(1.25):0}else{p=v.select("[name='Toggle']")}var s=b.ToolbarIcons.CreateSVG(v,q,this.ButtonSize(),y+(w?"":(" on pad "+this.this_pad_name))+(t?" (keyshortcut "+t+")":""));s.attr("name",r).attr("x",u).attr("y",0).attr("normalx",u).style("display",(p.property("buttons_state")?"":"none")).on("mouseenter",this.toggleButtonsVisibility.bind(this,"enterbtn")).on("mouseleave",this.toggleButtonsVisibility.bind(this,"leavebtn"));if(t){s.attr("key",t)}s.on("click",this.PadButtonClick.bind(this,r));v.property("nextx",u+this.ButtonSize(1.25));if(!w){v.attr("transform","translate("+(this.pad_width(this.this_pad_name)-v.property("nextx")-this.ButtonSize(1.25))+","+(this.pad_height(this.this_pad_name)-this.ButtonSize(1.25))+")");p.attr("x",v.property("nextx"))}if(!w&&(r.indexOf("Pad")!=0)&&(this.pad_painter()!==this)&&(r!=="EnlargePad")){this.pad_painter().AddButton(q,y,r)}};d.prototype.DrawingReady=function(q){var p=this.main_painter();if(p&&p.mode3d&&typeof p.Render3D=="function"){p.Render3D(-2222)}m.prototype.DrawingReady.call(this,q)};d.prototype.DecodeOptions=function(p){var q=this.GetObject();if(!q){return}var r=new b.DrawOptions(p);if(r.check("WEBSOCKET")){this.OpenWebsocket()}this.options={GlobalColors:true,LocalColors:false,IgnorePalette:false,RotateFrame:false,FixFrame:false};if(r.check("NOCOLORS")||r.check("NOCOL")){this.options.GlobalColors=this.options.LocalColors=false}if(r.check("LCOLORS")||r.check("LCOL")){this.options.GlobalColors=false;this.options.LocalColors=true}if(r.check("NOPALETTE")||r.check("NOPAL")){this.options.IgnorePalette=true}if(r.check("ROTATE")){this.options.RotateFrame=true}if(r.check("FIXFRAME")){this.options.FixFrame=true}if(r.check("WHITE")){q.fFillColor=0}if(r.check("LOGX")){q.fLogx=1}if(r.check("LOGY")){q.fLogy=1}if(r.check("LOGZ")){q.fLogz=1}if(r.check("LOG")){q.fLogx=q.fLogy=q.fLogz=1}if(r.check("GRIDX")){q.fGridx=1}if(r.check("GRIDY")){q.fGridy=1}if(r.check("GRID")){q.fGridx=q.fGridy=1}if(r.check("TICKX")){q.fTickx=1}if(r.check("TICKY")){q.fTicky=1}if(r.check("TICK")){q.fTickx=q.fTicky=1}};f.drawPad=function(t,s,q){var p=new d(s,false);p.DecodeOptions(q);p.SetDivId(t);if(p.svg_canvas().empty()){p.has_canvas=false;p.this_pad_name=""}p.CreatePadSvg();if(p.MatchObjectType("TPad")&&(!p.has_canvas||p.HasObjectsToDraw())){p.AddButton(b.ToolbarIcons.camera,"Create PNG","PadSnapShot");if((p.has_canvas&&p.HasObjectsToDraw())||p.enlarge_main("verify")){p.AddButton(b.ToolbarIcons.circle,"Enlarge pad","EnlargePad")}if(b.gStyle.ContextMenu){p.AddButton(b.ToolbarIcons.question,"Access context menus","PadContextMenus")}}var r=p.has_canvas?p.CurrentPadName(p.this_pad_name):undefined;p.DrawPrimitives(0,function(){p.CurrentPadName(r);p.DrawingReady()});return p};function j(p){d.call(this,p,true)}j.prototype=Object.create(d.prototype);j.prototype.ChangeLayout=function(x,r){var v=this.get_layout_kind();if(v==x){return b.CallBack(r,true)}var w=this.select_main("origin"),p=w.select(".side_panel"),t=this.select_main(),u=[];while(t.node().firstChild){u.push(t.node().removeChild(t.node().firstChild))}if(!p.empty()){b.cleanup(p.node())}this.set_layout_kind("simple");w.html("");if(x=="simple"){t=w;for(var s=0;s<u.length;++s){t.node().appendChild(u[s])}this.set_layout_kind(x);return b.CallBack(r,true)}var q=this;b.AssertPrerequisites("jq2d",function(){var z=new b.GridDisplay(w.node(),x);if(x.indexOf("vert")==0){t=o.select(z.GetFrame(0));p=o.select(z.GetFrame(1))}else{t=o.select(z.GetFrame(1));p=o.select(z.GetFrame(0))}t.classed("central_panel",true).style("position","relative");p.classed("side_panel",true).style("position","relative");for(var y=0;y<u.length;++y){t.node().appendChild(u[y])}q.set_layout_kind(x,".central_panel");b.CallBack(r,true)})};j.prototype.ToggleProjection=function(p,r){delete this.proj_painter;if(p){this.proj_painter=1}if(this.use_openui&&this.ShowUI5ProjectionArea){return this.ShowUI5ProjectionArea(p,r)}var q="simple";if(p=="X"){q="vert2_31"}else{if(p=="Y"){q="horiz2_13"}}this.ChangeLayout(q,r)};j.prototype.DrawProjection=function(s,v){if(!this.proj_painter){return}if(this.proj_painter===1){var w=b.Create("TCanvas"),q=this,u=this.root_pad(),p=this.main_painter(),r;if(s=="X"){w.fLeftMargin=u.fLeftMargin;w.fRightMargin=u.fRightMargin;w.fLogx=p.logx?1:0;w.fUxmin=p.logx?b.log10(p.scale_xmin):p.scale_xmin;w.fUxmax=p.logx?b.log10(p.scale_xmax):p.scale_xmax;r="fixframe"}else{w.fBottomMargin=u.fBottomMargin;w.fTopMargin=u.fTopMargin;w.fLogx=p.logy?1:0;w.fUxmin=p.logy?b.log10(p.scale_ymin):p.scale_ymin;w.fUxmax=p.logy?b.log10(p.scale_ymax):p.scale_ymax;r="rotate"}w.fPrimitives.Add(v,"hist");if(this.use_openui&&this.DrawInUI5ProjectionArea){this.DrawInUI5ProjectionArea(w,r,function(x){q.proj_painter=x})}else{this.DrawInSidePanel(w,r,function(x){q.proj_painter=x})}}else{var t=this.proj_painter.main_painter();if(t){t.UpdateObject(v,"hist")}this.proj_painter.RedrawPad()}};j.prototype.DrawInSidePanel=function(s,q,r){var p=this.select_main("origin").select(".side_panel");if(p.empty()){return b.CallBack(r,null)}b.draw(p.node(),s,q,r)};j.prototype.ShowMessage=function(p){b.progress(p,7000)};j.prototype.SaveCanvasAsFile=function(r){var p=this,q=r.indexOf(".");this.CreateImage(r.substr(q+1),function(s){p.SendWebsocket("SAVE:"+r+":"+s)})};j.prototype.WindowBeforeUnloadHanlder=function(){this.CloseWebsocket(true)};j.prototype.OnWebsocketOpened=function(p){this.SendWebsocket("READY")};j.prototype.OnWebsocketClosed=function(){if(window){window.close()}};j.prototype.OnWebsocketMsg=function(t,q){if(q=="CLOSE"){this.OnWebsocketClosed();this.CloseWebsocket(true)}else{if(q.substr(0,5)=="SNAP:"){q=q.substr(5);var E=q.indexOf(":"),D=q.substr(0,E),v=b.parse(q.substr(E+1)),p=this;this.RedrawPadSnap(v,function(){t.send("SNAPDONE:"+D)})}else{if(q.substr(0,6)=="SNAP6:"){this.root6_canvas=true;q=q.substr(6);var E=q.indexOf(":"),D=q.substr(0,E),v=b.parse(q.substr(E+1)),p=this;this.RedrawPadSnap(v,function(){p.CompeteCanvasSnapDrawing();var F=p.GetAllRanges();if(F){F=":"+F}t.send("RREADY:"+D+F)})}else{if(q.substr(0,4)=="JSON"){var x=b.parse(q.substr(4));this.RedrawObject(x);t.send("READY")}else{if(q.substr(0,5)=="MENU:"){q=q.substr(5);var E=q.indexOf(":"),y=q.substr(0,E),w=b.parse(q.substr(E+1));t.send("READY");if(typeof this._getmenu_callback=="function"){this._getmenu_callback(w,y)}}else{if(q.substr(0,4)=="CMD:"){q=q.substr(4);var E=q.indexOf(":"),C=q.substr(0,E),s=q.substr(E+1),r="REPLY:"+C+":";if((s=="SVG")||(s=="PNG")||(s=="JPEG")){this.CreateImage(s.toLowerCase(),function(F){t.send(r+F)})}else{console.log("Unrecognized command "+s);t.send(r)}}else{if((q.substr(0,7)=="DXPROJ:")||(q.substr(0,7)=="DYPROJ:")){var u=q[1],B=b.parse(q.substr(7));t.send("READY");this.DrawProjection(u,B)}else{if(q.substr(0,5)=="SHOW:"){t.send("READY");var z=q.substr(5),A=z[z.length-1]=="1";this.ShowSection(z.substr(0,z.length-2),A)}else{console.log("unrecognized msg "+q)}}}}}}}}};j.prototype.ShowSection=function(q,p){switch(q){case"Menu":break;case"StatusBar":break;case"Editor":break;case"ToolBar":break;case"ToolTips":this.SetTooltipAllowed(p);break}};b.TCanvasStatusBits={kShowEventStatus:b.BIT(15),kAutoExec:b.BIT(16),kMenuBar:b.BIT(17),kShowToolBar:b.BIT(18),kShowEditor:b.BIT(19),kMoveOpaque:b.BIT(20),kResizeOpaque:b.BIT(21),kIsGrayscale:b.BIT(22),kShowToolTips:b.BIT(23)};j.prototype.CompeteCanvasSnapDrawing=function(){if(!this.pad){return}if(document){document.title=this.pad.fTitle}if(this._all_sections_showed){return}this._all_sections_showed=true;this.ShowSection("Menu",this.pad.TestBit(b.TCanvasStatusBits.kMenuBar));this.ShowSection("StatusBar",this.pad.TestBit(b.TCanvasStatusBits.kShowEventStatus));this.ShowSection("ToolBar",this.pad.TestBit(b.TCanvasStatusBits.kShowToolBar));this.ShowSection("Editor",this.pad.TestBit(b.TCanvasStatusBits.kShowEditor));this.ShowSection("ToolTips",this.pad.TestBit(b.TCanvasStatusBits.kShowToolTips))};j.prototype.HasEventStatus=function(){return this.has_event_status};f.drawCanvas=function(t,s,r){var p=(s===null);if(p){s=b.Create("TCanvas")}var q=new j(s);q.DecodeOptions(r);q.normal_canvas=!p;q.SetDivId(t,-1);q.CheckSpecialsInPrimitives(s);q.CreateCanvasSvg(0);q.SetDivId(t);q.AddButton(b.ToolbarIcons.camera,"Create PNG","CanvasSnapShot","Ctrl PrintScreen");if(b.gStyle.ContextMenu){q.AddButton(b.ToolbarIcons.question,"Access context menus","PadContextMenus")}if(q.enlarge_main("verify")){q.AddButton(b.ToolbarIcons.circle,"Enlarge canvas","EnlargePad")}if(p&&r.indexOf("noframe")<0){b.Painter.drawFrame(t,null)}q.DrawPrimitives(0,function(){q.DrawingReady()});return q};f.drawPadSnapshot=function(t,p,r){var s=b.Create("TCanvas");var q=new j(s);q.normal_canvas=false;q.SetDivId(t,-1);q.AddButton(b.ToolbarIcons.camera,"Create PNG","CanvasSnapShot","Ctrl PrintScreen");if(b.gStyle.ContextMenu){q.AddButton(b.ToolbarIcons.question,"Access context menus","PadContextMenus")}if(q.enlarge_main("verify")){q.AddButton(b.ToolbarIcons.circle,"Enlarge canvas","EnlargePad")}q.RedrawPadSnap(p,function(){q.DrawingReady()});return q};f.drawRawText=function(s,p,r){var q=new m();q.txt=p;q.SetDivId(s);q.RedrawObject=function(t){this.txt=t;this.Draw();return true};q.Draw=function(){var v=this.txt.value;if(typeof v!="string"){v="<undefined>"}var x=this.txt.mathjax||(b.gStyle.Latex==4);if(!x&&!("as_is" in this.txt)){var u=v.split("\n");v="";for(var w=0;w<u.length;++w){v+="<pre>"+u[w]+"</pre>"}}var y=this.select_main(),t=y.select("div");if(t.empty()){t=y.append("div").style("max-width","100%").style("max-height","100%").style("overflow","auto")}t.html(v);this.SetDivId(this.divid);if(x){b.AssertPrerequisites("mathjax",function(){MathJax.Hub.Typeset(y.node())})}};q.Draw();return q.DrawingReady()};b.RegisterForResize=function(s,q){if(!s){return}var t=null,p=q?q:300;if(p<20){p=20}function r(){t=null;document.body.style.cursor="wait";if(typeof s=="function"){s()}else{if((typeof s=="object")&&(typeof s.CheckResize=="function")){s.CheckResize()}else{if(typeof s=="string"){var v=o.select("#"+s);if(!v.empty()){var w=v.property("mdi");if(w){w.CheckMDIResize()}else{b.resize(v.node())}}}}}document.body.style.cursor="auto"}function u(){if(t!==null){clearTimeout(t)}t=setTimeout(r,p)}window.addEventListener("resize",u)};b.addDrawFunc({name:"TCanvas",icon:"img_canvas",func:b.Painter.drawCanvas,opt:";grid;gridx;gridy;tick;tickx;ticky;log;logx;logy;logz",expand_item:"fPrimitives"});b.addDrawFunc({name:"TPad",icon:"img_canvas",func:b.Painter.drawPad,opt:";grid;gridx;gridy;tick;tickx;ticky;log;logx;logy;logz",expand_item:"fPrimitives"});b.addDrawFunc({name:"TSlider",icon:"img_canvas",func:b.Painter.drawPad});b.addDrawFunc({name:"TFrame",icon:"img_frame",func:b.Painter.drawFrame});b.addDrawFunc({name:"TPaveText",icon:"img_pavetext",prereq:"hist",func:"JSROOT.Painter.drawPave"});b.addDrawFunc({name:"TPaveStats",icon:"img_pavetext",prereq:"hist",func:"JSROOT.Painter.drawPave"});b.addDrawFunc({name:"TPaveLabel",icon:"img_pavelabel",prereq:"hist",func:"JSROOT.Painter.drawPave"});b.addDrawFunc({name:"TLatex",icon:"img_text",prereq:"more2d",func:"JSROOT.Painter.drawText",direct:true});b.addDrawFunc({name:"TMathText",icon:"img_text",prereq:"more2d",func:"JSROOT.Painter.drawText",direct:true});b.addDrawFunc({name:"TText",icon:"img_text",prereq:"more2d",func:"JSROOT.Painter.drawText",direct:true});b.addDrawFunc({name:/^TH1/,icon:"img_histo1d",prereq:"hist",func:"JSROOT.Painter.drawHistogram1D",opt:";hist;P;P0;E;E1;E2;E3;E4;E1X0;L;LF2;B;B1;A;TEXT;LEGO;same",ctrl:"l"});b.addDrawFunc({name:"TProfile",icon:"img_profile",prereq:"hist",func:"JSROOT.Painter.drawHistogram1D",opt:";E0;E1;E2;p;AH;hist"});b.addDrawFunc({name:"TH2Poly",icon:"img_histo2d",prereq:"hist",func:"JSROOT.Painter.drawHistogram2D",opt:";COL;COL0;COLZ;LCOL;LCOL0;LCOLZ;LEGO;same",expand_item:"fBins",theonly:true});b.addDrawFunc({name:"TH2PolyBin",icon:"img_histo2d",draw_field:"fPoly"});b.addDrawFunc({name:/^TH2/,icon:"img_histo2d",prereq:"hist",func:"JSROOT.Painter.drawHistogram2D",opt:";COL;COLZ;COL0;COL1;COL0Z;COL1Z;COLA;BOX;BOX1;SCAT;TEXT;CONT;CONT1;CONT2;CONT3;CONT4;ARR;SURF;SURF1;SURF2;SURF4;SURF6;E;A;LEGO;LEGO0;LEGO1;LEGO2;LEGO3;LEGO4;same",ctrl:"colz"});b.addDrawFunc({name:"TProfile2D",sameas:"TH2"});b.addDrawFunc({name:/^TH3/,icon:"img_histo3d",prereq:"hist3d",func:"JSROOT.Painter.drawHistogram3D",opt:";SCAT;BOX;BOX2;BOX3;GLBOX1;GLBOX2;GLCOL"});b.addDrawFunc({name:"THStack",icon:"img_histo1d",prereq:"hist",func:"JSROOT.Painter.drawHStack",expand_item:"fHists",opt:"PFC;PLC"});b.addDrawFunc({name:"TPolyMarker3D",icon:"img_histo3d",prereq:"hist3d",func:"JSROOT.Painter.drawPolyMarker3D"});b.addDrawFunc({name:"TPolyLine3D",icon:"img_graph",prereq:"3d",func:"JSROOT.Painter.drawPolyLine3D",direct:true});b.addDrawFunc({name:"TGraphStruct"});b.addDrawFunc({name:"TGraphNode"});b.addDrawFunc({name:"TGraphEdge"});b.addDrawFunc({name:"TGraphTime",icon:"img_graph",prereq:"more2d",func:"JSROOT.Painter.drawGraphTime",opt:"once;repeat;first",theonly:true});b.addDrawFunc({name:"TGraph2D",icon:"img_graph",prereq:"hist3d",func:"JSROOT.Painter.drawGraph2D",opt:";P;PCOL",theonly:true});b.addDrawFunc({name:"TGraph2DErrors",icon:"img_graph",prereq:"hist3d",func:"JSROOT.Painter.drawGraph2D",opt:";P;PCOL;ERR",theonly:true});b.addDrawFunc({name:"TGraphPolargram",icon:"img_graph",prereq:"more2d",func:"JSROOT.Painter.drawGraphPolargram",theonly:true});b.addDrawFunc({name:"TGraphPolar",icon:"img_graph",prereq:"more2d",func:"JSROOT.Painter.drawGraphPolar",opt:";F;L;P;PE",theonly:true});b.addDrawFunc({name:/^TGraph/,icon:"img_graph",prereq:"more2d",func:"JSROOT.Painter.drawGraph",opt:";L;P"});b.addDrawFunc({name:"TEfficiency",icon:"img_graph",prereq:"more2d",func:"JSROOT.Painter.drawEfficiency",opt:";AP"});b.addDrawFunc({name:"TCutG",sameas:"TGraph"});b.addDrawFunc({name:/^RooHist/,sameas:"TGraph"});b.addDrawFunc({name:/^RooCurve/,sameas:"TGraph"});b.addDrawFunc({name:"RooPlot",icon:"img_canvas",prereq:"more2d",func:"JSROOT.Painter.drawRooPlot"});b.addDrawFunc({name:"TMultiGraph",icon:"img_mgraph",prereq:"more2d",func:"JSROOT.Painter.drawMultiGraph",expand_item:"fGraphs"});b.addDrawFunc({name:"TStreamerInfoList",icon:"img_question",prereq:"hierarchy",func:"JSROOT.Painter.drawStreamerInfo"});b.addDrawFunc({name:"TPaletteAxis",icon:"img_colz",prereq:"hist",func:"JSROOT.Painter.drawPaletteAxis"});b.addDrawFunc({name:"TWebPainting",icon:"img_graph",prereq:"more2d",func:"JSROOT.Painter.drawWebPainting"});b.addDrawFunc({name:"TPadWebSnapshot",icon:"img_canvas",func:b.Painter.drawPadSnapshot});b.addDrawFunc({name:"kind:Text",icon:"img_text",func:b.Painter.drawRawText});b.addDrawFunc({name:"TF1",icon:"img_tf1",prereq:"math;more2d",func:"JSROOT.Painter.drawFunction"});b.addDrawFunc({name:"TF2",icon:"img_tf2",prereq:"math;hist",func:"JSROOT.Painter.drawTF2"});b.addDrawFunc({name:"TSpline3",icon:"img_tf1",prereq:"more2d",func:"JSROOT.Painter.drawSpline"});b.addDrawFunc({name:"TSpline5",icon:"img_tf1",prereq:"more2d",func:"JSROOT.Painter.drawSpline"});b.addDrawFunc({name:"TEllipse",icon:"img_graph",prereq:"more2d",func:"JSROOT.Painter.drawEllipse",direct:true});b.addDrawFunc({name:"TLine",icon:"img_graph",prereq:"more2d",func:"JSROOT.Painter.drawLine",direct:true});b.addDrawFunc({name:"TArrow",icon:"img_graph",prereq:"more2d",func:"JSROOT.Painter.drawArrow",direct:true});b.addDrawFunc({name:"TPolyLine",icon:"img_graph",prereq:"more2d",func:"JSROOT.Painter.drawPolyLine",direct:true});b.addDrawFunc({name:"TGaxis",icon:"img_graph",prereq:"hist",func:"JSROOT.Painter.drawGaxis"});b.addDrawFunc({name:"TLegend",icon:"img_pavelabel",prereq:"hist",func:"JSROOT.Painter.drawPave"});b.addDrawFunc({name:"TBox",icon:"img_graph",prereq:"more2d",func:"JSROOT.Painter.drawBox",direct:true});b.addDrawFunc({name:"TWbox",icon:"img_graph",prereq:"more2d",func:"JSROOT.Painter.drawBox",direct:true});b.addDrawFunc({name:"TSliderBox",icon:"img_graph",prereq:"more2d",func:"JSROOT.Painter.drawBox",direct:true});b.addDrawFunc({name:"TAxis3D",prereq:"hist3d",func:"JSROOT.Painter.drawAxis3D"});b.addDrawFunc({name:"TMarker",icon:"img_graph",prereq:"more2d",func:"JSROOT.Painter.drawMarker",direct:true});b.addDrawFunc({name:"TPolyMarker",icon:"img_graph",prereq:"more2d",func:"JSROOT.Painter.drawPolyMarker",direct:true});b.addDrawFunc({name:"TGeoVolume",icon:"img_histo3d",prereq:"geom",func:"JSROOT.Painter.drawGeoObject",expand:"JSROOT.GEO.expandObject",opt:";more;all;count;projx;projz;dflt",ctrl:"dflt"});b.addDrawFunc({name:"TEveGeoShapeExtract",icon:"img_histo3d",prereq:"geom",func:"JSROOT.Painter.drawGeoObject",expand:"JSROOT.GEO.expandObject",opt:";more;all;count;projx;projz;dflt",ctrl:"dflt"});b.addDrawFunc({name:"TGeoManager",icon:"img_histo3d",prereq:"geom",expand:"JSROOT.GEO.expandObject",func:"JSROOT.Painter.drawGeoObject",opt:";more;all;count;projx;projz;dflt",dflt:"expand",ctrl:"dflt"});b.addDrawFunc({name:/^TGeo/,icon:"img_histo3d",prereq:"geom",func:"JSROOT.Painter.drawGeoObject",opt:";more;all;axis;compa;count;projx;projz;dflt",ctrl:"dflt"});b.addDrawFunc({name:"kind:Command",icon:"img_execute",execute:true});b.addDrawFunc({name:"TFolder",icon:"img_folder",icon2:"img_folderopen",noinspect:true,prereq:"hierarchy",expand:"JSROOT.Painter.FolderHierarchy"});b.addDrawFunc({name:"TTask",icon:"img_task",prereq:"hierarchy",expand:"JSROOT.Painter.TaskHierarchy",for_derived:true});b.addDrawFunc({name:"TTree",icon:"img_tree",prereq:"tree",expand:"JSROOT.Painter.TreeHierarchy",func:"JSROOT.Painter.drawTree",dflt:"expand",opt:"player;testio",shift:"inspect"});b.addDrawFunc({name:"TNtuple",icon:"img_tree",prereq:"tree",expand:"JSROOT.Painter.TreeHierarchy",func:"JSROOT.Painter.drawTree",dflt:"expand",opt:"player;testio",shift:"inspect"});b.addDrawFunc({name:"TNtupleD",icon:"img_tree",prereq:"tree",expand:"JSROOT.Painter.TreeHierarchy",func:"JSROOT.Painter.drawTree",dflt:"expand",opt:"player;testio",shift:"inspect"});b.addDrawFunc({name:"TBranchFunc",icon:"img_leaf_method",prereq:"tree",func:"JSROOT.Painter.drawTree",opt:";dump",noinspect:true});b.addDrawFunc({name:/^TBranch/,icon:"img_branch",prereq:"tree",func:"JSROOT.Painter.drawTree",dflt:"expand",opt:";dump",ctrl:"dump",shift:"inspect",ignore_online:true});b.addDrawFunc({name:/^TLeaf/,icon:"img_leaf",prereq:"tree",noexpand:true,func:"JSROOT.Painter.drawTree",opt:";dump",ctrl:"dump",ignore_online:true});b.addDrawFunc({name:"TList",icon:"img_list",prereq:"hierarchy",expand:"JSROOT.Painter.ListHierarchy",dflt:"expand"});b.addDrawFunc({name:"THashList",sameas:"TList"});b.addDrawFunc({name:"TObjArray",sameas:"TList"});b.addDrawFunc({name:"TClonesArray",sameas:"TList"});b.addDrawFunc({name:"TMap",sameas:"TList"});b.addDrawFunc({name:"TColor",icon:"img_color"});b.addDrawFunc({name:"TFile",icon:"img_file",noinspect:true});b.addDrawFunc({name:"TMemFile",icon:"img_file",noinspect:true});b.addDrawFunc({name:"TStyle",icon:"img_question",noexpand:true});b.addDrawFunc({name:"Session",icon:"img_globe"});b.addDrawFunc({name:"kind:TopFolder",icon:"img_base"});b.addDrawFunc({name:"kind:Folder",icon:"img_folder",icon2:"img_folderopen",noinspect:true});b.getDrawHandle=function(r,s){if(typeof r!="string"){return null}if(s===""){s=null}var v=null;if((s===null)&&(r in b.DrawFuncs.cache)){return b.DrawFuncs.cache[r]}var x=(r.indexOf("ROOT.")==0)?r.substr(5):"kind:"+r;var q=0;for(var u=0;u<b.DrawFuncs.lst.length;++u){var w=b.DrawFuncs.lst[u];if(typeof w.name=="string"){if(w.name!=x){continue}}else{if(!x.match(w.name)){continue}}if(w.sameas!==undefined){return b.getDrawHandle("ROOT."+w.sameas,s)}if(s==null){if(!(r in b.DrawFuncs.cache)){b.DrawFuncs.cache[r]=w}return w}else{if(typeof s=="string"){if(!v){v=w}if(s=="::expand"){if(("expand" in w)||("expand_item" in w)){return w}}else{if("opt" in w){var p=w.opt.split(";");for(var t=0;t<p.length;++t){p[t]=p[t].toLowerCase()}if(p.indexOf(s.toLowerCase())>=0){return w}}}}else{if(s===q){return w}}}++q}return v};b.addStreamerInfos=function(q){if(q===null){return}function p(y,x){if(y.fElements==null){return null}if(x>10){return null}for(var w=0;w<y.fElements.arr.length;++w){var z=y.fElements.arr[w];if(z.fTypeName!=="BASE"){continue}var A=b.getDrawHandle("ROOT."+z.fName);if(A&&!A.for_derived){A=null}if(A===null){for(var v=0;v<q.arr.length;++v){if(q.arr[v].fName===z.fName){A=p(q.arr[v],x+1);break}}}if(A&&A.for_derived){return A}}return null}for(var u=0;u<q.arr.length;++u){var r=q.arr[u];if(b.getDrawHandle("ROOT."+r.fName)!==null){continue}var s=p(r,0);if(!s){continue}var t=b.extend({},s);t.name=r.fName;b.DrawFuncs.lst.push(t)}};b.getDrawSettings=function(r,s){var x={opts:null,inspect:false,expand:false,draw:false,handle:null};if(typeof r!="string"){return x}var t=null,v=false,y=false,z=false;if(typeof s!=="string"){s=""}for(var q=0;q<1000;++q){var w=b.getDrawHandle(r,q);if(!w){break}if(!x.handle){x.handle=w}if(w.noinspect){y=true}if(w.expand||w.expand_item||w.can_expand){z=true}if(!("func" in w)){break}v=true;if(!("opt" in w)){continue}var p=w.opt.split(";");for(var u=0;u<p.length;++u){p[u]=p[u].toLowerCase();if((s.indexOf("nosame")>=0)&&(p[u].indexOf("same")==0)){continue}if(x.opts===null){x.opts=[]}if(x.opts.indexOf(p[u])<0){x.opts.push(p[u])}}if(w.theonly){break}}if(s.indexOf("noinspect")>=0){y=true}if(v&&(x.opts===null)){x.opts=[""]}if(!v&&(r.indexOf("ROOT.")==0)&&!y){x.opts=[]}if(!y&&x.opts){x.opts.push("inspect")}x.inspect=!y;x.expand=z;x.draw=x.opts&&(x.opts.length>0);return x};b.getDrawOptions=function(q,p){return b.getDrawSettings(q).opts};b.canDraw=function(p){return b.getDrawSettings("ROOT."+p).opts!==null};b.draw=function(x,v,s,p){var A=true;function r(B){var C=null,D=false;if(typeof p=="function"){C=p}else{if(p&&(typeof p=="object")&&(typeof p.func=="function")){C=p.func;D=true}}if(D&&A){if(!B||B._ready_called_){p.completed=true;return B}}if(B&&p&&(typeof B.WhenReady=="function")){B.WhenReady(C)}else{b.CallBack(C,B)}return B}if((v===null)||(typeof v!=="object")){return r(null)}if(s=="inspect"){var t=b.findFunction("JSROOT.Painter.drawInspector");if(t){return r(t(x,v))}b.AssertPrerequisites("hierarchy",function(){r(b.Painter.drawInspector(x,v))});return null}var w=null,y=null;if("_typename" in v){w=b.getDrawHandle("ROOT."+v._typename,s)}else{if("_kind" in v){w=b.getDrawHandle(v._kind,s)}}if(!w){return r(null)}if(w.draw_field&&v[w.draw_field]){return b.draw(x,v[w.draw_field],s,p)}if(!w.func){return r(null)}function q(){if(w.direct){y=new e(v);y.SetDivId(x,2);y.Redraw=w.func;y._drawopt=s;y.Redraw();y.DrawingReady()}else{y=w.func(x,v,s)}return r(y)}if(typeof w.func=="function"){return q()}var u="",z="";if(typeof w.func=="object"){if("func" in w.func){u=w.func.func}if("script" in w.func){z="user:"+w.func.script}}else{if(typeof w.func=="string"){u=w.func;if(("prereq" in w)&&(typeof w.prereq=="string")){z=w.prereq}if(("script" in w)&&(typeof w.script=="string")){z+=";user:"+w.script}}}if(u.length===0){return r(null)}var t=b.findFunction(u);if(t){w.func=t;return q()}if(z.length===0){return r(null)}A=false;b.AssertPrerequisites(z,function(){var B=b.findFunction(u);if(!B){alert("Fail to find function "+u+" after loading "+z);return r(null)}w.func=B;q()});return y};b.redraw=function(v,s,p,x){if(!s){return b.CallBack(x,null)}var q=new e();q.SetDivId(v,-1);var r=q.pad_painter();var u=null;if(s._typename){u=b.getDrawHandle("ROOT."+s._typename)}if(u&&u.draw_field&&s[u.draw_field]){s=s[u.draw_field]}if(r){if(s._typename==="TCanvas"){r.RedrawObject(s);b.CallBack(x,r);return r}for(var t=0;t<r.painters.length;++t){var w=r.painters[t];if(w.MatchObjectType(s._typename)){if(w.UpdateObject(s)){r.RedrawPad();b.CallBack(x,w);return w}}}}if(r){b.console("Cannot find painter to update object of type "+s._typename)}b.cleanup(v);return b.draw(v,s,p,x)};b.MakeSVG=function(q,s){if(!q){q={}}if(!q.object){return b.CallBack(s,null)}if(!q.width){q.width=1200}if(!q.height){q.height=800}function r(t){t.attr("width",q.width).attr("height",q.height);t.style("width",q.width+"px").style("height",q.height+"px");b.svg_workaround=undefined;b.draw(t.node(),q.object,q.option||"",function(u){t.select("svg").attr("xmlns","http://www.w3.org/2000/svg").attr("width",q.width).attr("height",q.height).attr("style","").attr("style",null).attr("class",null).attr("x",null).attr("y",null);var w=t.html();if(b.svg_workaround){for(var v=0;v<b.svg_workaround.length;++v){w=w.replace('<path jsroot_svg_workaround="'+v+'"></path>',b.svg_workaround[v])}b.svg_workaround=undefined}w=w.replace(/url\(\&quot\;\#(\w+)\&quot\;\)/g,"url(#$1)").replace(/ class=\"\w*\"/g,"").replace(/<g transform=\"translate\(\d+\,\d+\)\"><\/g>/g,"").replace(/<g><\/g>/g,"");t.remove();b.CallBack(s,w)})}if(!b.nodejs){r(o.select(window.document).append("div").style("visible","hidden"))}else{if(b.nodejs_document){r(b.nodejs_window.d3.select("body").append("div"))}else{var p=require("jsdom");p.env({html:"",features:{QuerySelector:true},done:function(u,t){t.d3=o.select(t.document);b.nodejs_window=t;b.nodejs_document=t.document;r(t.d3.select("body").append("div"))}})}}};b.resize=function(s,p){if(p===true){p={force:true}}else{if(typeof p!=="object"){p=null}}var r=new e(),q=false;r.SetDivId(s,-1);r.ForEachPainter(function(t){if(!q&&typeof t.CheckResize=="function"){q=t.CheckResize(p)}});return q};b.CheckElementResize=b.resize;b.cleanup=function(s){var q=new e(),p=[];q.SetDivId(s,-1);q.ForEachPainter(function(t){if(p.indexOf(t)<0){p.push(t)}});for(var r=0;r<p.length;++r){p[r].Cleanup()}q.select_main().html("");return p};b.progress=function(r,q){if(b.BatchMode||!document){return}var s="jsroot_progressbox",p=o.select("#"+s);if(!b.gStyle.ProgressBox){return p.remove()}if((arguments.length==0)||!r){if((q!==-1)||(!p.empty()&&p.property("with_timeout"))){p.remove()}return}if(p.empty()){p=o.select(document.body).append("div").attr("id",s);p.append("p")}p.property("with_timeout",false);if(typeof r==="string"){p.select("p").html(r)}else{p.html("");p.node().appendChild(r)}if(!isNaN(q)&&(q>0)){p.property("with_timeout",true);setTimeout(b.progress.bind(b,"",-1),q)}};f.createRootColors();b.LongPollSocket=h;b.Cef3QuerySocket=l;b.DrawOptions=a;b.ColorPalette=n;b.TAttLineHandler=c;b.TAttFillHandler=i;b.TAttMarkerHandler=g;b.TBasePainter=m;b.TObjectPainter=e;b.TFramePainter=k;b.TPadPainter=d;b.TCanvasPainter=j;return b}));