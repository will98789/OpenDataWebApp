(function(a){if(typeof define==="function"&&define.amd){define(["jquery","jquery-ui","d3","JSRootPainter","JSRootPainter.hierarchy"],a)}else{if(typeof jQuery=="undefined"){throw new Error("jQuery not defined","JSRootPainter.jquery.js")}if(typeof jQuery.ui=="undefined"){throw new Error("jQuery-ui not defined","JSRootPainter.jquery.js")}if(typeof d3!="object"){throw new Error("This extension requires d3.v3.js","JSRootPainter.jquery.js")}if(typeof JSROOT=="undefined"){throw new Error("JSROOT is not defined","JSRootPainter.jquery.js")}if(typeof JSROOT.Painter!="object"){throw new Error("JSROOT.Painter not defined","JSRootPainter.jquery.js")}a(jQuery,jQuery.ui,d3,JSROOT)}}(function(f,h,d,c){c.sources.push("jq2d");if(typeof define==="function"&&define.amd){c.loadScript("$$$style/jquery-ui.css")}c.Painter.createMenu=function(i,j){var k="root_ctx_menu";if(!j&&typeof i==="function"){j=i;i=null}var l={painter:i,element:null,code:"",cnt:1,funcs:{},separ:false};l.add=function(n,m,r){if(n=="separator"){this.code+="<li>-</li>";this.separ=true;return}if(n.indexOf("header:")==0){this.code+="<li class='ui-widget-header' style='padding:3px; padding-left:5px;'>"+n.substr(7)+"</li>";return}if(n=="endsub:"){this.code+="</ul></li>";return}var q="</li>",o="";if(n.indexOf("sub:")==0){n=n.substr(4);q="<ul>"}if(typeof m=="function"){r=m;m=n}var p="";if(n.indexOf("chk:")==0){p="<span class='ui-icon ui-icon-check' style='margin:1px'></span>";n=n.substr(4)}else{if(n.indexOf("unk:")==0){p="<span class='ui-icon ui-icon-blank' style='margin:1px'></span>";n=n.substr(4)}}if((f.ui.version.indexOf("1.10")==0)||(f.ui.version.indexOf("1.9")==0)){p='<a href="#">'+p+n+"</a>"}else{if(f.ui.version.indexOf("1.11")==0){p+=n}else{p="<div>"+p+n+"</div>"}}this.code+="<li cnt='"+this.cnt+"' arg='"+m+"' style='"+o+"'>"+p+q;if(typeof r=="function"){this.funcs[this.cnt]=r}this.cnt++};l.addchk=function(n,o,m,p){return this.add((n?"chk:":"unk:")+o,m,p)};l.size=function(){return this.cnt-1};l.addDrawMenu=function(t,q,r){if(!q){q=[]}if(q.length==0){q.push("")}var m=false;if(t.indexOf("nosub:")==0){m=true;t=t.substr(6)}if(q.length===1){if(q[0]==="inspect"){t=t.replace("Draw","Inspect")}return this.add(t,q[0],r)}if(!m){this.add("sub:"+t,q[0],r)}for(var p=0;p<q.length;++p){var o=q[p];if(o==""){o="&lt;dflt&gt;"}var s=p+1;if((q.length>5)&&(o.length>0)){while((s<q.length)&&(q[s].indexOf(o)==0)){s++}}if(m){o=t+" "+o}if(s<p+2){this.add(o,q[p],r)}else{this.add("sub:"+o,q[p],r);for(var n=p+1;n<s;++n){this.add(q[n],q[n],r)}this.add("endsub:");p=s-1}}if(!m){this.add("endsub:")}};l.remove=function(){if(this.element!==null){this.element.remove();if(this.close_callback){this.close_callback()}document.body.removeEventListener("click",this.remove_bind)}this.element=null};l.remove_bind=l.remove.bind(l);l.show=function(o,q){this.remove();if(typeof q=="function"){this.close_callback=q}document.body.addEventListener("click",this.remove_bind);var n=document.getElementById(k);if(n){n.parentNode.removeChild(n)}f(document.body).append('<ul class="jsroot_ctxmenu">'+this.code+"</ul>");this.element=f(".jsroot_ctxmenu");var m=this;this.element.attr("id",k).css("left",o.clientX+window.pageXOffset).css("top",o.clientY+window.pageYOffset).css("position","absolute").menu({items:"> :not(.ui-widget-header)",select:function(v,w){var s=w.item.attr("arg"),t=w.item.attr("cnt"),u=t?m.funcs[t]:null;m.remove();if(typeof u=="function"){if("painter" in l){u.bind(m.painter)(s)}else{u(s)}}}});var r=null,p=null;if(o.clientX+this.element.width()>f(window).width()){r=f(window).width()-this.element.width()-20}if(o.clientY+this.element.height()>f(window).height()){p=f(window).height()-this.element.height()-20}if(r!==null){this.element.css("left",(r>0?r:0)+window.pageXOffset)}if(p!==null){this.element.css("top",(p>0?p:0)+window.pageYOffset)}};c.CallBack(j,l);return l};var g=c.HierarchyPainter;g.prototype.isLastSibling=function(j){if(!j||!j._parent||!j._parent._childs){return false}var i=j._parent._childs,k=i.indexOf(j);if(k<0){return false}while(++k<i.length){if(!("_hidden" in i[k])){return false}}return true};g.prototype.addItemHtml=function(j,q,n){if(!j||("_hidden" in j)){return true}var s=(j===this.h),m=("_childs" in j),G=c.getDrawHandle(j._kind),K="",J="",z=false,y=false,D,u=this.itemFullName(j);if(G!==null){if("icon" in G){K=G.icon}if("icon2" in G){J=G.icon2}if((K.length==0)&&(typeof G.icon_get=="function")){K=G.icon_get(j,this)}if(("func" in G)||("execute" in G)||("aslink" in G)||(("expand" in G)&&(j._more!==false))){z=true}}if("_icon" in j){K=j._icon}if("_icon2" in j){J=j._icon2}if((K.length==0)&&("_online" in j)){j._icon=K="img_globe"}if((K.length==0)&&s){j._icon=K="img_base"}if(j._more||("_expand" in j)||("_player" in j)){z=true}var F=z;if(!F&&(typeof j._kind=="string")&&(j._kind.indexOf("ROOT.")==0)){F=z=true}if(J.length==0){J=K}if(K.length==0){K=(m||j._more)?"img_folder":"img_page"}if(J.length==0){J=(m||j._more)?"img_folderopen":"img_page"}if(n==="update"){q.selectAll("*").remove();D=q}else{D=q.append("div");if(n&&(n>=(j._parent._show_limit||c.gStyle.HierarchyLimit))){y=true}}j._d3cont=D.node();D.attr("item",u);var l=D.append("div").attr("class","h_line");var A=s?null:j._parent;while(A&&(A!==this.h)){l.insert("div",":first-child").attr("class",this.isLastSibling(A)?"img_empty":"img_line");A=A._parent}var k="",r=false;if(s){}else{if(m&&!y){k=j._isopen?"img_minus":"img_plus";r=true}else{k="img_join"}}var C=this;if(k.length>0){if(y||this.isLastSibling(j)){k+="bottom"}var t=l.append("div").attr("class",k);if(r){t.style("cursor","pointer").on("click",function(){C.tree_click(this,"plusminus")})}}if(this.with_icons&&!y){var E=j._isopen?J:K;var p;if(E.indexOf("img_")==0){p=l.append("div").attr("class",E).attr("title",j._kind)}else{p=l.append("img").attr("src",E).attr("alt","").attr("title",j._kind).style("vertical-align","top").style("width","18px").style("height","18px")}if(("_icon_click" in j)||(G&&("icon_click" in G))){p.on("click",function(){C.tree_click(this,"icon")})}}var w=l.append("a");if(z||m||y){w.attr("class","h_item").on("click",function(){C.tree_click(this)})}if(y){j._break_point=true;w.attr("title","there are "+(j._parent._childs.length-n)+" more items").text("...more...");return false}if("disp_kind" in C){if(c.gStyle.DragAndDrop&&z){this.enable_dragging(w.node(),u)}if(c.gStyle.ContextMenu&&F){w.on("contextmenu",function(){C.tree_contextmenu(this)})}w.on("mouseover",function(){C.tree_mouseover(true,this)}).on("mouseleave",function(){C.tree_mouseover(false,this)})}else{if(j._direct_context&&c.gStyle.ContextMenu){w.on("contextmenu",function(){C.direct_contextmenu(this)})}}var v=j._name,x="";if("_realname" in j){v=j._realname}if("_title" in j){x=j._title}if("_fullname" in j){x+="  fullname: "+j._fullname}if(!x){x=v}w.attr("title",x).text(v+("_value" in j?":":"")).style("background",j._background?j._background:null);if("_value" in j){var o=l.append("p");if("_vclass" in j){o.attr("class",j._vclass)}if(!j._isopen){o.html(j._value)}}if(m&&(s||j._isopen)){var I=D.append("div").attr("class","h_childs");for(var B=0;B<j._childs.length;++B){var H=j._childs[B];H._parent=j;if(!this.addItemHtml(H,I,B)){break}}}return true};g.prototype.toggleOpenState=function(m,l){var j=l?l:this.h;if(!("_childs" in j)){if(!m||this.with_icons||(!j._expand&&(j._more!==true))){return false}this.expand(this.itemFullName(j));if(j._childs){j._isopen=true}return true}if((j!=this.h)&&m&&!j._isopen){j._isopen=true;return true}var n=false;for(var k=0;k<j._childs.length;++k){if(this.toggleOpenState(m,j._childs[k])){n=true}}if((j!=this.h)&&!m&&j._isopen&&!n){delete j._isopen;return true}if(!l){this.RefreshHtml()}return false};g.prototype.RefreshHtml=function(s){if(!this.divid){return c.CallBack(s)}var p=this.select_main();p.html("").style("overflow","hidden").style("display","flex").style("flex-direction","column");var o=this,r=[],i=null;this.ForEach(function(n){delete n._d3cont;if(("_fastcmd" in n)&&(n._kind=="Command")){r.push(n)}if(("_status" in n)&&(i==null)){i=n}});if((this.h==null)||p.empty()){return c.CallBack(s)}if(r.length){var t=p.append("div").attr("class","jsroot");for(var l=0;l<r.length;++l){var k=t.append("button").text("").attr("class","fast_command").attr("item",this.itemFullName(r[l])).attr("title",r[l]._title).on("click",function(){o.ExecuteCommand(d.select(this).attr("item"),this)});if("_icon" in r[l]){k.append("img").attr("src",r[l]._icon)}}}var q=p.append("p").attr("class","jsroot").style("margin-bottom","3px").style("margin-top",0);q.append("a").attr("class","h_button").text("open all").attr("title","open all items in the browser").on("click",o.toggleOpenState.bind(o,true));q.append("text").text(" | ");q.append("a").attr("class","h_button").text("close all").attr("title","close all items in the browser").on("click",o.toggleOpenState.bind(o,false));if("_online" in this.h){q.append("text").text(" | ");q.append("a").attr("class","h_button").text("reload").attr("title","reload object list from the server").on("click",o.reload.bind(o))}if("disp_kind" in this){q.append("text").text(" | ");q.append("a").attr("class","h_button").text("clear").attr("title","clear all drawn objects").on("click",o.clear.bind(o,false))}var j=p.append("div").attr("class","jsroot").style("font-size",this.with_icons?"12px":"15px").style("overflow","auto").style("flex","1");if(this.background){j.style("background-color",this.background).style("margin","2px").style("padding","2px")}this.addItemHtml(this.h,j.append("div").attr("class","h_tree"));if(i&&!this.status_disabled&&(c.GetUrlOption("nostatus")===null)){var m=c.findFunction(i._status);var u=(typeof m=="function")?this.CreateStatusLine("on"):null;if(u){m(u,this.itemFullName(i))}}c.CallBack(s)};g.prototype.UpdateTreeNode=function(j,k){if((k===undefined)||k.empty()){k=d.select(j._d3cont?j._d3cont:null);var i=this.itemFullName(j);if(k.empty()){k=this.select_main().select("[item='"+i+"']")}if(k.empty()&&("_cycle" in j)){k=this.select_main().select("[item='"+i+";"+j._cycle+"']")}if(k.empty()){return}}this.addItemHtml(j,k,"update");if(this.browser_kind==="float"){this.AdjustFloatBrowserSize(null,true)}};g.prototype.UpdateBackground=function(j,k){if(!j||!j._d3cont){return}var l=d.select(j._d3cont);if(l.empty()){return}var i=l.select(".h_item");i.style("background",j._background?j._background:null);if(k&&j._background){i.node().scrollIntoView(false)}};g.prototype.tree_click=function(t,o){if(!t){return}var w=d.select(t.parentNode.parentNode);var q=w.attr("item");if(!q){return}var j=this.Find(q);if(!j){return}if(j._break_point){delete j._break_point;this.addItemHtml(j,w,"update");var v=j._parent,B=v._childs.indexOf(j),z=d.select(w.node().parentNode);if(B<0){return console.error("internal error")}v._show_limit=(v._show_limit||c.gStyle.HierarchyLimit)*2;for(var s=B+1;s<v._childs.length;++s){var y=v._childs[s];y._parent=v;if(!this.addItemHtml(y,z,s)){break}}return}var v=j,r=undefined;while(v){if((r=v._click_action)!==undefined){break}v=v._parent}if(!o||(o=="")){o="item"}var i=c.getDrawSettings(j._kind),x=i.handle;if(o=="icon"){var l=null;if(typeof j._icon_click=="function"){l=j._icon_click}else{if(x&&typeof x.icon_click=="function"){l=x.icon_click}}if(l&&l(j,this)){this.UpdateTreeNode(j,w)}return}if((o=="item")&&("_expand" in j)&&!d.event.ctrlKey&&!d.event.shiftKey){o="plusminus"}if(((o=="plusminus")&&!("_childs" in j)&&j._more)||((o=="item")&&(r==="expand"))){return this.expand(q,null,w)}if(o=="item"){if("_player" in j){return this.player(q)}if(x&&x.aslink){return window.open(q+"/")}if(x&&x.execute){return this.ExecuteCommand(q,t.parentNode)}if(x&&x.ignore_online&&this.isOnlineItem(j)){return}var k=j._can_draw,p=j._more,m=(this.default_by_click==="expand"),u="";if(d.event.shiftKey){u=(x&&x.shift)?x.shift:"inspect";if((u==="inspect")&&x&&x.noinspect){u=""}}if(x&&x.ctrl&&d.event.ctrlKey){u=x.ctrl}if(!u){for(var A=j._parent;A;A=A._parent){if(A._painter){k=false;if(p===undefined){p=false}break}}}if(j._childs){p=false}if(k===undefined){k=i.draw}if(p===undefined){p=i.expand}if(k&&p&&!u){if(m||(x&&(x.dflt==="expand"))){k=false}else{if(this.isItemDisplayed(q)){k=false}}}if(k){return this.display(q,u)}if(p||m){return this.expand(q,null,w)}if((typeof j._kind==="string")&&(j._kind.indexOf("ROOT.")===0)&&i.inspect&&(k!==false)){return this.display(q,"inspect")}if(!j._childs||(j===this.h)){return}}if(j._isopen){delete j._isopen}else{j._isopen=true}this.UpdateTreeNode(j,w)};g.prototype.tree_mouseover=function(j,m){var n=d.select(m.parentNode.parentNode).attr("item");var k=this.Find(n);if(!k){return}var i,l=k;while(l&&!i){i=l._painter;l=l._parent}if(i&&typeof i.MouseOverHierarchy==="function"){i.MouseOverHierarchy(j,n,k)}};g.prototype.direct_contextmenu=function(j){d.event.preventDefault();var k=d.select(j.parentNode.parentNode).attr("item");var i=this.Find(k);if(!i){return}if(typeof this.fill_context!=="function"){return}c.Painter.createMenu(this,function(l){l.painter.fill_context(l,i);if(l.size()>0){l.tree_node=j.parentNode;l.show(d.event)}})};g.prototype.tree_contextmenu=function(k){d.event.preventDefault();var o=d.select(k.parentNode.parentNode).attr("item");var j=this.Find(o);if(!j){return}var i=this,n=i.GetOnlineProp(o),m=i.GetFileProp(o);function l(p){function r(t){return t.split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;")}var q=document.createElement("div");q.innerHTML='<a href="'+r(p)+'">x</a>';return q.firstChild.href}c.Painter.createMenu(i,function(r){if((o=="")&&!("_jsonfile" in j)){var w="",s=0;function t(){return s++>0?"&":"?"}var q=[];i.ForEachRootFile(function(y){q.push(y._file.fFullURL)});if(i.GetTopOnlineItem()==null){w=c.source_dir+"index.htm"}if(i.IsMonitoring()){w+=t()+"monitoring="+i.MonitoringInterval()}if(q.length==1){w+=t()+"file="+q[0]}else{if(q.length>1){w+=t()+"files="+JSON.stringify(q)}}if(i.disp_kind){w+=t()+"layout="+i.disp_kind.replace(/ /g,"")}var v=[];if(i.disp){i.disp.ForEachPainter(function(y){if(y.GetItemName()!=null){v.push(y.GetItemName())}})}if(v.length==1){w+=t()+"item="+v[0]}else{if(v.length>1){w+=t()+"items="+JSON.stringify(v)}}r.add("Direct link",function(){window.open(w)});r.add("Only items",function(){window.open(w+"&nobrowser")})}else{if(n!=null){i.FillOnlineMenu(r,n,o)}else{var u=c.getDrawSettings(j._kind,"nosame");if(j._can_draw){if(!u.opts){u.opts=[""]}if(u.opts.indexOf("")<0){u.opts.unshift("")}}if(u.opts){r.addDrawMenu("Draw",u.opts,function(y){this.display(o,y)})}if(m&&u.opts&&!m.localfile){var x=l(m.fileurl);if(x.indexOf(c.source_dir)==0){x=x.slice(c.source_dir.length)}x=m.kind+"="+x;if(m.itemname.length>0){var p=m.itemname;if(p.search(/\+| |\,/)>=0){p="'"+p+"'"}x+="&item="+p}r.addDrawMenu("Draw in new tab",u.opts,function(y){window.open(c.source_dir+"index.htm?nobrowser&"+x+"&opt="+y)})}if(u.expand&&!("_childs" in j)&&(j._more||!("_more" in j))){r.add("Expand",function(){i.expand(o)})}if(j._kind==="ROOT.TStyle"){r.add("Apply",function(){i.ApplyStyle(o)})}}}if(typeof j._menu=="function"){j._menu(r,j,i)}if(r.size()>0){r.tree_node=k.parentNode;if(r.separ){r.add("separator")}r.add("Close");r.show(d.event)}});return false};g.prototype.CreateDisplay=function(i){if("disp" in this){if(this.disp.NumDraw()>0){return c.CallBack(i,this.disp)}this.disp.Reset();delete this.disp}if(document.getElementById(this.disp_frameid)==null){return c.CallBack(i,null)}if(this.disp_kind=="tabs"){this.disp=new b(this.disp_frameid)}else{if(this.disp_kind.indexOf("flex")==0){this.disp=new e(this.disp_frameid)}else{if(this.disp_kind.indexOf("coll")==0){this.disp=new a(this.disp_frameid)}else{this.disp=new c.GridDisplay(this.disp_frameid,this.disp_kind)}}}if(this.disp){this.disp.CleanupFrame=this.CleanupFrame.bind(this)}c.CallBack(i,this.disp)};g.prototype.enable_dragging=function(i,j){f(i).draggable({revert:"invalid",appendTo:"body",helper:"clone"})};g.prototype.enable_dropping=function(j,k){var i=this;f(j).droppable({hoverClass:"ui-state-active",accept:function(n){var m=n.parent().parent().attr("item");if((m==k)||(m==null)){return false}var l=i.Find(m);if((l==null)||(!("_kind" in l))){return false}return l._kind.indexOf("ROOT.")==0},drop:function(m,n){var l=n.draggable.parent().parent().attr("item");if(l==null){return false}return i.dropitem(l,f(this).attr("id"))}})};g.prototype.SetButtonsPosition=function(){if(!this.gui_div){return}var n=f("#"+this.gui_div+" .jsroot_browser"),m=7,l=7;if(this.browser_visible){var i=n.find(".jsroot_browser_area"),k=n.offset(),j=i.offset();m=j.top-k.top+7;l=j.left-k.left+i.innerWidth()-27}n.find(".jsroot_browser_btns").css("left",l+"px").css("top",m+"px")};g.prototype.AdjustFloatBrowserSize=function(o,l){if(!o){if(!this.gui_div){return}o=f("#"+this.gui_div+" .jsroot_browser")}if(!o.length){return}var m=o.find(".jsroot_browser_area"),i=o.find(".jsroot_browser_hierarchy"),n=i.children(":first");if(l){if(m.parent().innerHeight()-10<m.innerHeight()){m.css("bottom","0px").css("top","0px")}return}if(!n.length){return}var k=i.innerHeight(),j=n.innerHeight();if((j!==undefined)&&(j<k*0.7)){m.css("bottom","")}};g.prototype.ToggleBrowserKind=function(k){if(!this.gui_div){return}if(!k){if(!this.browser_kind){return}k=(this.browser_kind==="float")?"fix":"float"}var i=d.select("#"+this.gui_div+" .jsroot_browser"),n=f(i.node()),l=n.find(".jsroot_browser_area"),m=this;if(this.browser_kind==="float"){l.css("bottom","0px").css("top","0px").css("width","").css("height","").toggleClass("jsroot_float_browser",false).resizable("destroy").draggable("destroy")}else{if(this.browser_kind==="fix"){i.select(".jsroot_v_separator").remove();l.css("left","0px");d.select("#"+this.gui_div+"_drawing").style("left","0px");i.select(".jsroot_h_separator").style("left","0px");d.select("#"+this.gui_div+"_status").style("left","0px");this.CheckResize()}}this.browser_kind=k;this.browser_visible=true;if(k==="float"){l.css("bottom","40px").toggleClass("jsroot_float_browser",true).resizable({containment:"parent",minWidth:100,resize:function(o,p){m.SetButtonsPosition()},stop:function(p,q){var o=f(this).parent().innerHeight()-q.position.top-q.size.height;if(o<7){f(this).css("height","").css("bottom",0)}}}).draggable({containment:"parent",handle:f("#"+this.gui_div).find(".jsroot_browser_title"),snap:true,snapMode:"inner",snapTolerance:10,drag:function(o,p){m.SetButtonsPosition()},stop:function(p,q){var o=f(this).parent().innerHeight()-f(this).offset().top-f(this).outerHeight();if(o<7){f(this).css("height","").css("bottom",0)}}});this.AdjustFloatBrowserSize(n)}else{l.css("left",0).css("top",0).css("bottom",0).css("height","");var j=i.append("div").classed("jsroot_separator",true).classed("jsroot_v_separator",true).style("position","absolute").style("top",0).style("bottom",0);f(j.node()).draggable({axis:"x",cursor:"ew-resize",containment:"parent",helper:function(){return f(this).clone().css("background-color","grey")},drag:function(o,p){m.SetButtonsPosition();m.AdjustSeparator(p.position.left,null)},stop:function(o,p){m.CheckResize()}});this.AdjustSeparator(250,null,true,true)}this.SetButtonsPosition()};g.prototype.ToggleBrowserVisisbility=function(){if(!this.gui_div||(typeof this.browser_visible==="string")){return}var m=d.select("#"+this.gui_div+" .jsroot_browser");var i=m.select(".jsroot_browser_area");if(i.empty()){return}var n=m.select(".jsroot_v_separator"),p=d.select("#"+this.gui_div+"_drawing"),l=i.property("last_left"),j=i.property("last_vsepar"),q=i.property("last_drawing");if(!this.browser_visible){i.property("last_left",null).property("last_vsepar",null).property("last_drawing",null)}else{i.property("last_left",i.style("left"));if(!n.empty()){i.property("last_vsepar",n.style("left"));i.property("last_drawing",p.style("left"))}l=(-f(i.node()).outerWidth(true)-10).toString()+"px";var o=f(m.node()).outerWidth(true);if(n.empty()&&(f(i.node()).offset().left>o/2)){l=(o+10)+"px"}j="-10px";q="0px"}var k=this,r=!this.browser_visible;this.browser_visible="changing";i.transition().style("left",l).duration(700).on("end",function(){k.browser_visible=r;if(r){k.SetButtonsPosition()}});if(!r){m.select(".jsroot_browser_btns").transition().style("left","7px").style("top","7px").duration(700)}if(!n.empty()){n.transition().style("left",j).duration(700);p.transition().style("left",q).duration(700).on("end",this.CheckResize.bind(this))}};g.prototype.CreateBrowser=function(m,u,t){if(!this.gui_div||this.exclude_browser){return false}var x=d.select("#"+this.gui_div+" .jsroot_browser"),p=f(x.node());if(x.empty()){return false}if((m==="float")&&this.float_browser_disabled){m="fix"}if(!x.select(".jsroot_browser_area").empty()){if(u&&(this.browser_visible!=="changing")){if(m===this.browser_kind){this.ToggleBrowserVisisbility()}else{this.ToggleBrowserKind(m)}}c.CallBack(t);return true}var q="<div style='overflow:hidden'><p class=\"jsroot_browser_title\"></p><p class='jsroot_browser_version'><a href='https://root.cern/js/'>JSROOT</a> version <span style='color:green'><b>"+c.version+"</b></span></p>";if(this.is_online){q+='<p> Hierarchy in <a href="h.json">json</a> and <a href="h.xml">xml</a> format</p><div style="display:flex;flex-direction:row;"><label style="margin-right:5px; vertical-align:middle;"><input style="vertical-align:middle;" type="checkbox" name="monitoring" class="gui_monitoring"/>Monitoring</label>'}else{if(!this.no_select){var n=d.select("#"+this.gui_div),l=n.attr("files")||"../files/hsimple.root",A=c.GetUrlOption("path")||n.attr("path")||"",s=l.split(";");q+='<input type="text" value="" style="width:95%; margin:5px;border:2px;" class="gui_urlToLoad" title="input file name"/><div style="display:flex;flex-direction:row;padding-top:5px"><select class="gui_selectFileName" style="flex:1;padding:2px;" title="select file name"<option value="" selected="selected"></option>';for(var z in s){q+='<option value = "'+A+s[z]+'">'+s[z]+"</option>"}q+='</select><input type="file" class="gui_localFile" accept=".root" style="display:none"/><output id="list" style="display:none"></output><input type="button" value="..." class="gui_fileBtn" style="min-width:3em;padding:3px;margin-left:5px;margin-right:5px;" title="select local file for reading"/><br/></div><p id="gui_fileCORS"><small><a href="https://github.com/root-project/jsroot/blob/master/docs/JSROOT.md#reading-root-files-from-other-servers">Read docu</a> how to open files from other servers.</small></p><div style="display:flex;flex-direction:row"><input style="padding:3px;margin-right:5px;"       class="gui_ReadFileBtn" type="button" title="Read the Selected File" value="Load"/><input style="padding:3px;margin-right:5px;"       class="gui_ResetUIBtn" type="button" title="Close all opened files and clear drawings" value="Reset"/>'}else{if(this.no_select=="file"){q+='<div style="display:flex;flex-direction:row">'}}}if(this.is_online||!this.no_select||this.no_select=="file"){q+='<select style="padding:2px;margin-right:5px;" title="layout kind" class="gui_layout"></select></div>'}q+="</div>";q+='<div id="'+this.gui_div+'_browser_hierarchy" class="jsroot_browser_hierarchy"></div>';x.insert("div",".jsroot_browser_btns").classed("jsroot_browser_area",true).style("position","absolute").style("left",0).style("top",0).style("bottom",0).style("width","250px").style("padding-left","5px").style("display","flex").style("flex-direction","column").html(q);x.select(".jsroot_browser_title").text(this.is_online?"ROOT online server":"Read a ROOT file");var r=this,w=null;if(!this.is_online&&!this.no_select){this.ReadSelectedFile=function(){var i=x.select(".gui_urlToLoad").property("value").trim();if(!i){return}if((i.toLowerCase().lastIndexOf(".json")==i.length-5)){this.OpenJsonFile(i)}else{this.OpenRootFile(i)}};p.find(".gui_selectFileName").val("").change(function(){p.find(".gui_urlToLoad").val(f(this).val())});p.find(".gui_fileBtn").button().click(function(){p.find(".gui_localFile").click()});p.find(".gui_ReadFileBtn").button().click(function(){r.ReadSelectedFile()});p.find(".gui_ResetUIBtn").button().click(function(){r.clear(true)});p.find(".gui_urlToLoad").keyup(function(i){if(i.keyCode==13){r.ReadSelectedFile()}});p.find(".gui_localFile").change(function(C){var i=C.target.files;for(var B=0;B<i.length;++B){var k=i[B];x.select(".gui_urlToLoad").property("value",k.name);if(r){r.OpenRootFile(k,w)}}w=null});this.SelectLocalFile=function(i){w=i;f("#"+this.gui_div+" .jsroot_browser").find(".gui_localFile").click()}}var j=p.find(".gui_layout");if(j.length){var y=["simple","vert2","vert3","vert231","horiz2","horiz32","flex","grid 2x2","grid 1x3","grid 2x3","grid 3x3","grid 4x4","collapsible","tabs"];for(var v=0;v<y.length;++v){var o=document.createElement("option");o.value=y[v];o.innerHTML=y[v];j.get(0).appendChild(o)}j.change(function(){r.SetDisplay(f(this).val()||"collapsible",r.gui_div+"_drawing")})}this.SetDivId(this.gui_div+"_browser_hierarchy");if(u){this.RefreshHtml();this.InitializeBrowser()}this.ToggleBrowserKind(m||"fix");c.CallBack(t);return true};g.prototype.InitializeBrowser=function(){var n=d.select("#"+this.gui_div+" .jsroot_browser");if(n.empty()){return}var j=f(n.node()),m=this;if(this.browser_kind==="float"){this.AdjustFloatBrowserSize(j)}var p=n.select(".gui_layout").node();if(p){var q=false;for(var o in p.options){var r=p.options[o].text;if(typeof r!=="string"){continue}if((r==this.GetLayout())||(r.replace(/ /g,"")==this.GetLayout())){p.selectedIndex=o;q=true;break}}if(!q){var k=document.createElement("option");k.innerHTML=k.value=this.GetLayout();p.appendChild(k);p.selectedIndex=p.options.length-1}}if(this.is_online){if(this.h&&this.h._toptitle){n.select(".jsroot_browser_title").text(this.h._toptitle)}j.find(".gui_monitoring").prop("checked",this.IsMonitoring()).click(function(){m.EnableMonitoring(this.checked);m.updateAll(!this.checked)})}else{if(!this.no_select){var l="";this.ForEachRootFile(function(i){if(!l){l=i._fullurl}});j.find(".gui_urlToLoad").val(l)}}};g.prototype.CreateStatusLine=function(s,r){if(this.status_disabled||!this.gui_div){return""}var o=d.select("#"+this.gui_div+" .jsroot_browser");if(o.empty()){return""}var i=this.gui_div+"_status",t=d.select("#"+i),j;if(!t.empty()){if(this.status_layout==="app"){return !r?i:false}j=o.select(".jsroot_h_separator");f(j.node()).draggable("destroy");j.remove();t.remove();delete this.status_layout;if(this.status_handler&&(c.Painter.ShowStatus===this.status_handler)){delete c.Painter.ShowStatus;delete this.status_handler}this.AdjustSeparator(null,0,true);return""}var q=d.select("#"+this.gui_div+"_drawing").style("left");t=o.insert("div",".jsroot_browser_area").attr("id",i).classed("jsroot_status_area",true).style("position","absolute").style("left",q).style("height","20px").style("bottom",0).style("right",0).style("margin",0).style("border",0);j=o.insert("div",".jsroot_browser_area").classed("jsroot_separator",true).classed("jsroot_h_separator",true).style("position","absolute").style("left",q).style("right",0).style("bottom","20px").style("height","5px");var l=this;f(j.node()).draggable({axis:"y",cursor:"ns-resize",containment:"parent",helper:function(){return f(this).clone().css("background-color","grey")},drag:function(k,u){l.AdjustSeparator(null,-u.position.top)},stop:function(k,u){l.CheckResize()}});if(!s||(typeof s==="string")){s=this.last_hsepar_height||20}var p=(r==="toggle")&&(s===this.last_hsepar_height);this.AdjustSeparator(null,s,true);if(!r){this.status_layout="app";return i}this.status_layout=new c.GridDisplay(i,"horizx4_1213");if(p){this.status_layout.first_check=true}var m=["object name","object title","mouse coordinates","object info"];for(var n=0;n<4;++n){d.select(this.status_layout.GetFrame(n)).attr("title",m[n]).style("overflow","hidden").append("label").attr("class","jsroot_status_label")}this.status_handler=this.ShowStatus.bind(this);c.Painter.ShowStatus=this.status_handler;return true};g.prototype.ShowStatus=function(j,m,k,l){if(!this.status_layout){return}f(this.status_layout.GetFrame(0)).children("label").text(j||"");f(this.status_layout.GetFrame(1)).children("label").text(m||"");f(this.status_layout.GetFrame(2)).children("label").text(l||"");f(this.status_layout.GetFrame(3)).children("label").text(k||"");if(!this.status_layout.first_check){this.status_layout.first_check=true;var i=0;for(var o=0;o<4;++o){i=Math.max(i,f(this.status_layout.GetFrame(o)).children("label").outerHeight())}if((i>5)&&((i>this.last_hsepar_height)||(i<this.last_hsepar_height+5))){this.AdjustSeparator(null,i,true)}}};g.prototype.AdjustSeparator=function(k,l,p,o){if(!this.gui_div){return}var i=d.select("#"+this.gui_div+" .jsroot_browser"),j=5;if((l===null)&&o&&!i.select(".jsroot_h_separator").empty()){l=i.select(".jsroot_h_separator").style("bottom");if((typeof l=="string")&&(l.indexOf("px")==l.length-2)){l=l.substr(0,l.length-2)}else{l=null}}if(l!==null){l=parseInt(l);var m=i.select(".jsroot_h_separator"),n=0;if(!m.empty()){if(l<0){l+=(f(i.node()).outerHeight(true)-j)}if(l<5){l=5}this.last_hsepar_height=l;m.style("bottom",l+"px").style("height",j+"px");d.select("#"+this.gui_div+"_status").style("height",l+"px");n=(l+j)+"px"}d.select("#"+this.gui_div+"_drawing").style("bottom",n)}if(k!==null){k=parseInt(k);if(k<50){k=50}i.select(".jsroot_browser_area").style("width",(k-5)+"px");d.select("#"+this.gui_div+"_drawing").style("left",(k+j)+"px");i.select(".jsroot_h_separator").style("left",(k+j)+"px");d.select("#"+this.gui_div+"_status").style("left",(k+j)+"px");i.select(".jsroot_v_separator").style("left",k+"px").style("width",j+"px")}if(p){this.CheckResize()}};c.BuildGUI=function(){var i=d.select("#simpleGUI"),j=false;if(i.empty()){i=d.select("#onlineGUI");if(i.empty()){return alert("no div for gui found")}j=true}if(i.attr("ignoreurl")==="true"){c.gStyle.IgnoreUrlOptions=true}if((c.GetUrlOption("nobrowser")!==null)||(i.attr("nobrowser")&&i.attr("nobrowser")!=="false")){return c.BuildNobrowserGUI()}c.Painter.readStyleFromURL();var k=new c.HierarchyPainter("root",null);k.is_online=j;k.StartGUI(i,k.InitializeBrowser.bind(k))};function a(i){c.MDIDisplay.call(this,i);this.cnt=0}a.prototype=Object.create(c.MDIDisplay.prototype);a.prototype.ForEachFrame=function(j,k){var i=this.frameid+"_collapsible";if(document.getElementById(i)==null){return}if(typeof j!="function"){return}f("#"+i+" .collapsible_draw").each(function(){if(k&&f(this).is(":hidden")){return}j(f(this).get(0))})};a.prototype.GetActiveFrame=function(){var i=c.MDIDisplay.prototype.GetActiveFrame.call(this);if(i&&!f(i).is(":hidden")){return i}i=null;this.ForEachFrame(function(j){if(!i){i=j}},true);return i};a.prototype.ActivateFrame=function(i){if(f(i).is(":hidden")){f(i).prev().toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").find("> .ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").end().next().toggleClass("ui-accordion-content-active").slideDown(0)}f(i).prev()[0].scrollIntoView();this.active_frame_title=d.select(i).attr("frame_title")};a.prototype.CreateFrame=function(m){this.BeforeCreateFrame(m);var k=this.frameid+"_collapsible";if(document.getElementById(k)==null){f("#"+this.frameid).append('<div id="'+k+'" class="jsroot ui-accordion ui-accordion-icons ui-widget ui-helper-reset" style="overflow:auto; overflow-y:scroll; height:100%; padding-left: 2px; padding-right: 2px"></div>')}var n=this,j=k+"_sub"+this.cnt++,l=j+"h",i='<h5 id="'+l+"\"><span class='ui-icon ui-icon-triangle-1-e'></span><a> "+m+"</a>&nbsp; <button type='button' class='jsroot_collaps_closebtn' style='float:right; width:1.4em' title='close canvas'/> </h5>\n<div class='collapsible_draw' id='"+j+"'></div>\n";f("#"+k).append(i);f("#"+l).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-top ui-corner-bottom").hover(function(){f(this).toggleClass("ui-state-hover")}).click(function(){f(this).toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").find("> .ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").end().next().toggleClass("ui-accordion-content-active").slideToggle(0);var p=f(this).next(),o=p.is(":hidden");p.attr("frame_active",o?"false":"true").css("display",o?"none":"");if(!o){c.resize(p.attr("id"))}}).next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").hide();f("#"+l).find(" .jsroot_collaps_closebtn").button({icons:{primary:"ui-icon-close"},text:false}).click(function(){n.CleanupFrame(f(this).parent().next().attr("id"));f(this).parent().next().remove();f(this).parent().remove()});f("#"+l).toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").find("> .ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").end().next().toggleClass("ui-accordion-content-active").slideToggle(0);return f("#"+j).attr("frame_title",m).css("overflow","hidden").attr("can_resize","height").css("position","relative").get(0)};function b(i){c.MDIDisplay.call(this,i);this.cnt=0}b.prototype=Object.create(c.MDIDisplay.prototype);b.prototype.ForEachFrame=function(j,m){var i=this.frameid+"_tabs";if(document.getElementById(i)==null){return}if(typeof j!="function"){return}var k=-1;var l=f("#"+i).tabs("option","active");f("#"+i+"> .tabs_draw").each(function(){k++;if(!m||(k==l)){j(f(this).get(0))}})};b.prototype.GetActiveFrame=function(){var i=null;this.ForEachFrame(function(j){if(!i){i=j}},true);return i};b.prototype.ActivateFrame=function(j){var i=0,k=-1;this.ForEachFrame(function(l){if(f(l).attr("id")==f(j).attr("id")){k=i}i++});f("#"+this.frameid+"_tabs").tabs("option","active",k);this.active_frame_title=d.select(j).attr("frame_title")};b.prototype.CreateFrame=function(n){this.BeforeCreateFrame(n);var o=this,l=this.frameid+"_tabs",k=l+"_sub"+this.cnt++,j='<li><a href="#'+k+'">'+n+'</a><span class="ui-icon ui-icon-close" style="float: left; margin: 0.4em 0.2em 0 0; cursor: pointer;" role="presentation">Remove Tab</span></li>',i='<div class="tabs_draw" id="'+k+'"></div>';if(document.getElementById(l)==null){f("#"+this.frameid).append('<div id="'+l+'" class="jsroot"> <ul>'+j+" </ul>"+i+"</div>");var m=f("#"+l).css("overflow","hidden").tabs({heightStyle:"fill",activate:function(p,q){console.log("tabs activate");f(q.oldPanel).attr("frame_active","false");f(q.newPanel).css("overflow","hidden").attr("frame_active","true");c.resize(f(q.newPanel).attr("id"))}});m.delegate("span.ui-icon-close","click",function(){var p=f(this).closest("li").remove().attr("aria-controls");o.CleanupFrame(p);f("#"+p).remove();m.tabs("refresh");if(f("#"+l+"> .tabs_draw").length==0){f("#"+l).remove()}})}else{f("#"+l).find("> .ui-tabs-nav").append(j);f("#"+l).append(i);f("#"+l).tabs("refresh");f("#"+l).tabs("option","active",-1)}f("#"+k).empty().css("overflow","hidden").attr("frame_active","true").attr("frame_title",n);return f("#"+k).get(0)};b.prototype.CheckMDIResize=function(j,i){f("#"+this.frameid+"_tabs").tabs("refresh");c.MDIDisplay.prototype.CheckMDIResize.call(this,j,i)};function e(i){c.MDIDisplay.call(this,i);this.cnt=0}e.prototype=Object.create(c.MDIDisplay.prototype);e.prototype.ForEachFrame=function(j,k){var i=this.frameid+"_flex";if(document.getElementById(i)==null){return}if(typeof j!="function"){return}f("#"+i+" .flex_draw").each(function(){if(k&&f(this).is(":hidden")){return}j(f(this).get(0))})};e.prototype.GetActiveFrame=function(){var i=c.MDIDisplay.prototype.GetActiveFrame.call(this);if(i&&!f(i).is(":hidden")){return i}i=null;this.ForEachFrame(function(j){if(!i){i=j}},true);return i};e.prototype.ActivateFrame=function(i){this.active_frame_title=d.select(i).attr("frame_title")};e.prototype.CreateFrame=function(m){this.BeforeCreateFrame(m);var j=this.frameid+"_flex";if(document.getElementById(j)==null){f("#"+this.frameid).append('<div id="'+j+'" class="jsroot" style="overflow:none; height:100%; width:100%"></div>')}var i=this,l=f("#"+j),p=l.width(),k=l.height(),q=j+"_frame"+this.cnt;var o='<div id="'+q+'" class="flex_frame" style="position:absolute"><div class="ui-widget-header flex_header"><p>'+m+'</p><button type="button" style="float:right; width:1.4em"/><button type="button" style="float:right; width:1.4em"/><button type="button" style="float:right; width:1.4em"/></div><div id="'+q+'_cont" class="flex_draw"></div></div>';l.append(o);function n(r,s){var t=r.prop("state");if(!t){t="normal"}r.prop("state",s);if(s==t){return}if(t=="normal"){r.prop("original_height",r.height());r.prop("original_width",r.width());r.prop("original_top",r.css("top"));r.prop("original_left",r.css("left"))}r.find(".jsroot_minbutton").find(".ui-icon").toggleClass("ui-icon-triangle-1-s",s!="minimal").toggleClass("ui-icon-triangle-2-n-s",s=="minimal");r.find(".jsroot_maxbutton").find(".ui-icon").toggleClass("ui-icon-triangle-1-n",s!="maximal").toggleClass("ui-icon-triangle-2-n-s",s=="maximal");switch(s){case"minimal":r.height(r.find(".flex_header").height()).width("auto");r.find(".flex_draw").css("display","none");r.find(".ui-resizable-handle").css("display","none");break;case"maximal":r.height("100%").width("100%").css("left","").css("top","");r.find(".flex_draw").css("display","");r.find(".ui-resizable-handle").css("display","none");break;default:r.find(".flex_draw").css("display","");r.find(".ui-resizable-handle").css("display","");r.height(r.prop("original_height")).width(r.prop("original_width"));if(t!="minimal"){r.css("left",r.prop("original_left")).css("top",r.prop("original_top"))}}r.find(".flex_draw").attr("frame_active",s!=="minimal"?"true":"false");if(s!=="minimal"){c.resize(r.find(".flex_draw").get(0))}}f("#"+q).css("left",parseInt(p*(this.cnt%5)/10)).css("top",parseInt(k*(this.cnt%5)/10)).width(Math.round(p*0.58)).height(Math.round(k*0.58)).resizable({helper:"jsroot-flex-resizable-helper",start:function(r,s){f(this).appendTo(f(this).parent())},stop:function(s,t){var r={width:t.size.width-1,height:t.size.height-f(this).find(".flex_header").height()-1};c.resize(f(this).find(".flex_draw").get(0),r)}}).draggable({containment:"parent",start:function(s,u){f(this).appendTo(f(this).parent());var t=f(this).find(".flex_draw");var v=document.elementFromPoint(s.clientX,s.clientY);var r=false;f(v).parents().map(function(){if(f(this).get(0)===t.get(0)){r=true}});if(r){return false}}}).find(".flex_header").click(function(){var r=f(this).parent();r.appendTo(r.parent())}).find("button").first().attr("title","close canvas").button({icons:{primary:"ui-icon-close"},text:false}).click(function(){var r=f(this).parent().parent();i.CleanupFrame(r.find(".flex_draw").get(0));r.remove()}).next().attr("title","maximize canvas").addClass("jsroot_maxbutton").button({icons:{primary:"ui-icon-triangle-1-n"},text:false}).click(function(){var r=f(this).parent().parent();var s=f(this).find(".ui-icon").hasClass("ui-icon-triangle-1-n");n(r,s?"maximal":"normal")}).next().attr("title","minimize canvas").addClass("jsroot_minbutton").button({icons:{primary:"ui-icon-triangle-1-s"},text:false}).click(function(){var r=f(this).parent().parent();var s=f(this).find(".ui-icon").hasClass("ui-icon-triangle-1-s");n(r,s?"minimal":"normal")});f("#"+q).find(".ui-resizable-handle").css("z-index","");this.cnt++;return f("#"+q+"_cont").attr("frame_title",m).get(0)};c.GridDisplay.prototype.CreateSeparator=function(k,i,l){var j=f(i.append("div").node());j.toggleClass("jsroot_separator",true).toggleClass(k.vertical?"jsroot_hline":"jsroot_vline",true).prop("handle",k).attr("separator-id",l.id).css("position","absolute").css(k.vertical?"top":"left","calc("+l.position+"% - 2px)").css(k.vertical?"width":"height",(k.size||100)+"%").css(k.vertical?"height":"width","5px").css("cursor",k.vertical?"ns-resize":"ew-resize");j.bind("changePosition",function(q,n){var o=f(this).prop("handle"),s=parseInt(f(this).attr("separator-id")),r=o.groups[s].position;if(n==="restore"){r=o.groups[s].position0}else{if(n&&n.offset){if(o.vertical){r=Math.round((n.offset.top+2-f(this).parent().offset().top)/f(this).parent().innerHeight()*100)}else{r=Math.round((n.offset.left+2-f(this).parent().offset().left)/f(this).parent().innerWidth()*100)}}}var p=o.groups[s].position-r;if(Math.abs(p)<0.3){return}if(Math.min(o.groups[s-1].size-p,o.groups[s].size+p)<5){return}o.groups[s-1].size-=p;o.groups[s].size+=p;o.groups[s].position=r;function m(w,v){var t=o.vertical?"height":"width",u=o.groups[v].size+"%";w.children("[groupid='"+v+"']").css(t,u).children(".jsroot_separator").css(t,u)}f(this).css(o.vertical?"top":"left","calc("+r+"% - 2px)");m(f(this).parent(),s-1);m(f(this).parent(),s);if(n==="restore"){f(this).trigger("resizeGroup",s-1);f(this).trigger("resizeGroup",s)}});j.bind("resizeGroup",function(o,m){var n=f(this).parent().children("[groupid='"+m+"']");if(!n.hasClass("jsroot_newgrid")){n=n.find(".jsroot_newgrid")}n.each(function(){c.resize(f(this).get(0))})});j.dblclick(function(){f(this).trigger("changePosition","restore")});j.draggable({axis:k.vertical?"y":"x",cursor:k.vertical?"ns-resize":"ew-resize",containment:"parent",helper:function(){return f(this).clone().css("background-color","grey")},start:function(m,o){var n=f(this).prop("handle"),p=parseInt(f(this).attr("separator-id"));n.groups[p].startpos=n.groups[p].position},drag:function(m,n){f(this).trigger("changePosition",n)},stop:function(m,o){var n=f(this).prop("handle"),p=parseInt(f(this).attr("separator-id"));if(Math.abs(n.groups[p].startpos-n.groups[p].position)<0.5){return}f(this).trigger("resizeGroup",p-1);f(this).trigger("resizeGroup",p)}})};c.CreateTreePlayer=function(i){i.draw_first=true;i.ConfigureOnline=function(m,k,l,j){this.SetItemName(m,"",this);this.url=k;this.root_version=j;this.askey=l};i.ConfigureTree=function(j){this.local_tree=j};i.KeyUp=function(j){if(j.keyCode==13){this.PerformDraw()}};i.ShowExtraButtons=function(l){var j=f("#"+this.divid);j.find(".treedraw_buttons").append(" Cut: <input class='treedraw_cut ui-corner-all ui-widget' style='width:8em;margin-left:5px' title='cut expression'></input> Opt: <input class='treedraw_opt ui-corner-all ui-widget' style='width:5em;margin-left:5px' title='histogram draw options'></input> Num: <input class='treedraw_number' style='width:7em;margin-left:5px' title='number of entries to process (default all)'></input> First: <input class='treedraw_first' style='width:7em;margin-left:5px' title='first entry to process (default first)'></input> <button class='treedraw_clear' title='Clear drawing'>Clear</button>");var m=1000,k=undefined,n=this;if(this.local_tree){k=this.local_tree.fEntries||0}j.find(".treedraw_cut").val(l&&l.parse_cut?l.parse_cut:"").keyup(this.keyup);j.find(".treedraw_opt").val(l&&l.drawopt?l.drawopt:"").keyup(this.keyup);j.find(".treedraw_number").val(l&&l.numentries?l.numentries:"").spinner({numberFormat:"n",min:0,page:1000,max:k}).keyup(this.keyup);j.find(".treedraw_first").val(l&&l.firstentry?l.firstentry:"").spinner({numberFormat:"n",min:0,page:1000,max:k}).keyup(this.keyup);j.find(".treedraw_clear").button().click(function(){c.cleanup(n.drawid)})};i.Show=function(n,k){this.drawid=n+"_draw";this.keyup=this.KeyUp.bind(this);var l=k&&(k.parse_cut||k.numentries||k.firstentry);var j=f("#"+n);j.html("<div class='treedraw_buttons' style='padding-left:0.5em'><button class='treedraw_exe' title='Execute draw expression'>Draw</button> Expr:<input class='treedraw_varexp ui-corner-all ui-widget' style='width:12em;margin-left:5px' title='draw expression'></input> "+(l?"":"<button class='treedraw_more'>More</button>")+"</div><hr/><div id='"+this.drawid+"' style='width:100%'></div>");this.SetDivId(n);var m=this;if(this.local_tree){j.find(".treedraw_buttons").attr("title","Tree draw player for: "+this.local_tree.fName)}j.find(".treedraw_exe").button().click(function(){m.PerformDraw()});j.find(".treedraw_varexp").val(k&&k.parse_expr?k.parse_expr:"px:py").keyup(this.keyup);if(l){this.ShowExtraButtons(k)}else{j.find(".treedraw_more").button().click(function(){f(this).remove();m.ShowExtraButtons()})}this.CheckResize()};i.PerformLocalDraw=function(){if(!this.local_tree){return}var l=f(this.select_main().node());var j={expr:l.find(".treedraw_varexp").val()};if(l.find(".treedraw_more").length==0){j.cut=l.find(".treedraw_cut").val();if(!j.cut){delete j.cut}j.drawopt=l.find(".treedraw_opt").val();if(j.drawopt==="dump"){j.dump=true;j.drawopt=""}if(!j.drawopt){delete j.drawopt}j.numentries=parseInt(l.find(".treedraw_number").val());if(isNaN(j.numentries)){delete j.numentries}j.firstentry=parseInt(l.find(".treedraw_first").val());if(isNaN(j.firstentry)){delete j.firstentry}}var k=this;if(j.drawopt){c.cleanup(k.drawid)}k.local_tree.Draw(j,function(n,m,o){c.redraw(k.drawid,n,m)})};i.PerformDraw=function(){if(this.local_tree){return this.PerformLocalDraw()}var l=f(this.select_main().node());var k=this.url+"/exe.json.gz?compact=3&method=Draw",t=l.find(".treedraw_varexp").val(),j="h_tree_draw",m="",q=t.indexOf(">>");if(q<0){t+=">>"+j}else{j=t.substr(q+2);if(j[0]=="+"){j=j.substr(1)}var r=j.indexOf("(");if(r>0){j=j.substr(0,r)}}if(l.find(".treedraw_more").length==0){var s=l.find(".treedraw_cut").val(),p=l.find(".treedraw_number").val(),o=l.find(".treedraw_first").val();m=l.find(".treedraw_opt").val();k+='&prototype="const char*,const char*,Option_t*,Long64_t,Long64_t"&varexp="'+t+'"&selection="'+s+'"';if(p==""){p=(this.root_version>=394499)?"TTree::kMaxEntries":"1000000000"}if(o==""){o="0"}k+='&option="'+m+'"&nentries='+p+"&firstentry="+o}else{k+='&prototype="Option_t*"&opt="'+t+'"'}k+="&_ret_object_="+j;var u=this;function n(){c.NewHttpRequest(k,"object",function(v){if(v==null){return}c.cleanup(u.drawid);c.draw(u.drawid,v,m)}).send()}if(this.askey){this.askey=false;c.NewHttpRequest(this.url+"/root.json","text",n).send()}else{n()}};i.CheckResize=function(k){var j=f(this.select_main().node());f("#"+this.drawid).width(j.width());var n=j.height(),m=j.find(".treedraw_buttons").outerHeight(true),l=j.find("hr").outerHeight(true);f("#"+this.drawid).height(n-m-l-2);c.resize(this.drawid)};return i};c.drawTreePlayer=function(l,o,n){var i=l.GetOnlineItemUrl(o);if(!i){return null}var q=l.GetTopOnlineItem(l.Find(o));if(!q){return null}var j=("_root_version" in q)?q._root_version:336417;var m=l.GetDisplay();if(m==null){return null}var k=m.FindFrame(o,true);if(k==null){return null}var p=d.select(k).attr("id");var r=new c.TBasePainter();c.CreateTreePlayer(r);r.ConfigureOnline(o,i,n,j);r.Show(p);return r};c.drawTreePlayerKey=function(i,j){return c.drawTreePlayer(i,j,true)};c.Painter.ConfigureVSeparator=function(i){};c.Painter.AdjustLayout=function(k,i,j){if(c.hpainter){c.hpainter.AdjustSeparator(k,i,true)}};c.Painter.ConfigureHSeparator=function(i){if(!c.hpainter){return""}return c.hpainter.CreateStatusLine(i)};return c}));